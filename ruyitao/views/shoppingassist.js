if(!exports)var exports={};
(function(ld,da,aa){var B=da;B||(B={});var rb=B;rb.browser||(rb.browser={});rb.browser.extension={sendRequest:function(a,b){"undefined"==typeof b&&(b=function(){});chrome.extension.sendRequest(a,b)},onRequest:{addListener:function(a){chrome.extension.onRequest.addListener(a)},removeListener:function(a){chrome.extension.onRequest.removeListener(a)}},getURL:function(a){return chrome.extension.getURL(a||"")}};da.console={debug:function(a){da.browser.extension.sendRequest({topic:"log_message",message:a})}};
var ua=jQuery;ua.color={};ua.color.make=function(a,b,c,d){var e={};e.r=a||0;e.g=b||0;e.b=c||0;e.a=null!=d?d:1;e.add=function(a,b){for(var c=0;c<a.length;++c)e[a.charAt(c)]+=b;return e.normalize()};e.scale=function(a,b){for(var c=0;c<a.length;++c)e[a.charAt(c)]*=b;return e.normalize()};e.toString=function(){return 1<=e.a?"rgb("+[e.r,e.g,e.b].join()+")":"rgba("+[e.r,e.g,e.b,e.a].join()+")"};e.normalize=function(){function a(b,c,d){return c<b?b:c>d?d:c}e.r=a(0,parseInt(e.r),255);e.g=a(0,parseInt(e.g),
255);e.b=a(0,parseInt(e.b),255);e.a=a(0,e.a,1);return e};e.clone=function(){return ua.color.make(e.r,e.b,e.g,e.a)};return e.normalize()};ua.color.extract=function(a,b){var c;do{c=a.css(b).toLowerCase();if(""!=c&&"transparent"!=c)break;a=a.parent()}while(!ua.nodeName(a.get(0),"body"));"rgba(0, 0, 0, 0)"==c&&(c="transparent");return ua.color.parse(c)};ua.color.parse=function(a){var b,c=ua.color.make;if(b=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(a))return c(parseInt(b[1],
10),parseInt(b[2],10),parseInt(b[3],10));if(b=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(a))return c(parseInt(b[1],10),parseInt(b[2],10),parseInt(b[3],10),parseFloat(b[4]));if(b=/rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(a))return c(2.55*parseFloat(b[1]),2.55*parseFloat(b[2]),2.55*parseFloat(b[3]));if(b=/rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(a))return c(2.55*
parseFloat(b[1]),2.55*parseFloat(b[2]),2.55*parseFloat(b[3]),parseFloat(b[4]));if(b=/#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(a))return c(parseInt(b[1],16),parseInt(b[2],16),parseInt(b[3],16));if(b=/#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(a))return c(parseInt(b[1]+b[1],16),parseInt(b[2]+b[2],16),parseInt(b[3]+b[3],16));a=ua.trim(a).toLowerCase();if("transparent"==a)return c(255,255,255,0);b=Cc[a]||[0,0,0];return c(b[0],b[1],b[2])};var Cc={aqua:[0,255,255],azure:[240,255,255],
beige:[245,245,220],black:[0,0,0],blue:[0,0,255],brown:[165,42,42],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgrey:[169,169,169],darkgreen:[0,100,0],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkviolet:[148,0,211],fuchsia:[255,0,255],gold:[255,215,0],green:[0,128,0],indigo:[75,0,130],khaki:[240,230,140],lightblue:[173,216,230],lightcyan:[224,255,255],lightgreen:[144,
238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightyellow:[255,255,224],lime:[0,255,0],magenta:[255,0,255],maroon:[128,0,0],navy:[0,0,128],olive:[128,128,0],orange:[255,165,0],pink:[255,192,203],purple:[128,0,128],violet:[128,0,128],red:[255,0,0],silver:[192,192,192],white:[255,255,255],yellow:[255,255,0]},y=jQuery,Ec=function(a,b,c,d){function e(a,b){for(var b=[T].concat(b),c=0;c<a.length;++c)a[c].apply(this,b)}function f(a){for(var b=[],c=0;c<a.length;++c){var d=y.extend(!0,{},q.series);
null!=a[c].data?(d.data=a[c].data,delete a[c].data,y.extend(!0,d,a[c]),a[c].data=d.data):d.data=a[c];b.push(d)}Q=b;b=Q.length;c=[];d=[];for(a=0;a<Q.length;++a){var k=Q[a].color;null!=k&&(--b,"number"==typeof k?d.push(k):c.push(y.color.parse(Q[a].color)))}for(a=0;a<d.length;++a)b=Math.max(b,d[a]+1);c=[];for(a=d=0;c.length<b;)k=q.colors.length==a?y.color.make(100,100,100):y.color.parse(q.colors[a]),k.scale("rgb",1+0.2*(1==d%2?-1:1)*Math.ceil(d/2)),c.push(k),++a,a>=q.colors.length&&(a=0,++d);for(a=b=
0;a<Q.length;++a){d=Q[a];null==d.color?(d.color=c[b].toString(),++b):"number"==typeof d.color&&(d.color=c[d.color].toString());if(null==d.lines.show){var f,k=!0;for(f in d)if(d[f]&&d[f].show){k=!1;break}k&&(d.lines.show=!0)}d.xaxis=l(G,h(d,"x"));d.yaxis=l(J,h(d,"y"))}f=function(a,b,c){b<a.datamin&&b!=-n&&(a.datamin=b);c>a.datamax&&c!=n&&(a.datamax=c)};var g=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY,n=Number.MAX_VALUE,v,m,w,z,Y;y.each(j(),function(a,b){b.datamin=g;b.datamax=r;b.used=!1});
for(a=0;a<Q.length;++a)b=Q[a],b.datapoints={points:[]},e(N.processRawData,[b,b.data,b.datapoints]);for(a=0;a<Q.length;++a){var b=Q[a],ha=b.data,C=b.datapoints.format;if(!C){C=[];C.push({x:!0,number:!0,required:!0});C.push({y:!0,number:!0,required:!0});if(b.bars.show||b.lines.show&&b.lines.fill)C.push({y:!0,number:!0,required:!1,defaultValue:0}),b.bars.horizontal&&(delete C[C.length-1].y,C[C.length-1].x=!0);b.datapoints.format=C}if(null==b.datapoints.pointsize){b.datapoints.pointsize=C.length;m=b.datapoints.pointsize;
k=b.datapoints.points;insertSteps=b.lines.show&&b.lines.steps;b.xaxis.used=b.yaxis.used=!0;for(c=v=0;c<ha.length;++c,v+=m){Y=ha[c];var ma=null==Y;if(!ma)for(d=0;d<m;++d){w=Y[d];if(z=C[d])z.number&&null!=w&&(w=+w,isNaN(w)?w=null:Infinity==w?w=n:-Infinity==w&&(w=-n)),null==w&&(z.required&&(ma=!0),null!=z.defaultValue&&(w=z.defaultValue));k[v+d]=w}if(ma)for(d=0;d<m;++d)w=k[v+d],null!=w&&(z=C[d],z.x&&f(b.xaxis,w,w),z.y&&f(b.yaxis,w,w)),k[v+d]=null;else if(insertSteps&&0<v&&null!=k[v-m]&&k[v-m]!=k[v]&&
k[v-m+1]!=k[v+1]){for(d=0;d<m;++d)k[v+m+d]=k[v+d];k[v+1]=k[v-m+1];v+=m}}}}for(a=0;a<Q.length;++a)b=Q[a],e(N.processDatapoints,[b,b.datapoints]);for(a=0;a<Q.length;++a){b=Q[a];k=b.datapoints.points;m=b.datapoints.pointsize;Y=v=g;ma=ha=r;for(c=0;c<k.length;c+=m)if(null!=k[c])for(d=0;d<m;++d)if(w=k[c+d],(z=C[d])&&!(w==n||w==-n))z.x&&(w<v&&(v=w),w>ha&&(ha=w)),z.y&&(w<Y&&(Y=w),w>ma&&(ma=w));b.bars.show&&(c="left"==b.bars.align?0:-b.bars.barWidth/2,b.bars.horizontal?(Y+=c,ma+=c+b.bars.barWidth):(v+=c,ha+=
c+b.bars.barWidth));f(b.xaxis,v,ha);f(b.yaxis,Y,ma)}y.each(j(),function(a,b){b.datamin==g&&(b.datamin=null);b.datamax==r&&(b.datamax=null)})}function h(a,b){var c=a[b+"axis"];"object"==typeof c&&(c=c.n);"number"!=typeof c&&(c=1);return c}function j(){return y.grep(G.concat(J),function(a){return a})}function xa(a){var b={},c,d;for(c=0;c<G.length;++c)(d=G[c])&&d.used&&(b["x"+d.n]=d.c2p(a.left));for(c=0;c<J.length;++c)(d=J[c])&&d.used&&(b["y"+d.n]=d.c2p(a.top));b.x1!==aa&&(b.x=b.x1);b.y1!==aa&&(b.y=
b.y1);return b}function l(a,b){a[b-1]||(a[b-1]={n:b,direction:a==G?"x":"y",options:y.extend(!0,{},a==G?q.xaxis:q.yaxis)});return a[b-1]}function t(b,c){var d=document.createElement("canvas");d.className=c;d.width=L;d.height=M;b||y(d).css({position:"absolute",left:0,top:0});y(d).appendTo(a);d.getContext||(d=window.G_vmlCanvasManager.initElement(d));d.getContext("2d").save();return d}function U(){L=a.width();M=a.height();if(0>=L||0>=M)throw"Invalid dimensions for plot, width = "+L+", height = "+M;}
function g(a){a.width!=L&&(a.width=L);a.height!=M&&(a.height=M);a=a.getContext("2d");a.restore();a.save()}function p(a){var b=a.labelWidth,c=a.labelHeight,d=a.options.position,e=a.options.tickLength,k=q.grid.axisMargin,f=q.grid.labelMargin,g="x"==a.direction?G:J,r=y.grep(g,function(a){return a&&a.options.position==d&&a.reserveSpace});y.inArray(a,r)==r.length-1&&(k=0);null==e&&(e="full");g=y.grep(g,function(a){return a&&a.reserveSpace});g=0==y.inArray(a,g);!g&&"full"==e&&(e=5);isNaN(+e)||(f+=+e);"x"==
a.direction?(c+=f,"bottom"==d?(D.bottom+=c+k,a.box={top:M-D.bottom,height:c}):(a.box={top:D.top+k,height:c},D.top+=c+k)):(b+=f,"left"==d?(a.box={left:D.left+k,width:b},D.left+=b+k):(D.right+=b+k,a.box={left:L-D.right,width:b}));a.position=d;a.tickLength=e;a.box.padding=f;a.innermost=g}function K(){var b,c=j();y.each(c,function(a,b){b.show=b.options.show;null==b.show&&(b.show=b.used);b.reserveSpace=b.show||b.options.reserveSpace;var c=b.options,d=+(null!=c.min?c.min:b.datamin),e=+(null!=c.max?c.max:
b.datamax),k=e-d;if(0==k){if(k=0==e?1:0.01,null==c.min&&(d-=k),null==c.max||null!=c.min)e+=k}else{var f=c.autoscaleMargin;null!=f&&(null==c.min&&(d-=k*f,0>d&&(null!=b.datamin&&0<=b.datamin)&&(d=0)),null==c.max&&(e+=k*f,0<e&&(null!=b.datamax&&0>=b.datamax)&&(e=0)))}b.min=d;b.max=e});allocatedAxes=y.grep(c,function(a){return a.reserveSpace});D.left=D.right=D.top=D.bottom=0;if(q.grid.show){y.each(allocatedAxes,function(b,c){var d=c.options,e;e="number"==typeof d.ticks&&0<d.ticks?d.ticks:0.3*Math.sqrt("x"==
c.direction?L:M);e=(c.max-c.min)/e;var k,f,g,r;if("time"==d.mode){var h={second:1E3,minute:6E4,hour:36E5,day:864E5,month:2592E6,year:525949.2*6E4};r=[[1,"second"],[2,"second"],[5,"second"],[10,"second"],[30,"second"],[1,"minute"],[2,"minute"],[5,"minute"],[10,"minute"],[30,"minute"],[1,"hour"],[2,"hour"],[4,"hour"],[8,"hour"],[12,"hour"],[1,"day"],[2,"day"],[3,"day"],[0.25,"month"],[0.5,"month"],[1,"month"],[2,"month"],[3,"month"],[6,"month"],[1,"year"]];k=0;null!=d.minTickSize&&(k="number"==typeof d.tickSize?
d.tickSize:d.minTickSize[0]*h[d.minTickSize[1]]);for(f=0;f<r.length-1&&!(e<(r[f][0]*h[r[f][1]]+r[f+1][0]*h[r[f+1][1]])/2&&r[f][0]*h[r[f][1]]>=k);++f);k=r[f][0];g=r[f][1];"year"==g&&(f=Math.pow(10,Math.floor(Math.log(e/h.year)/Math.LN10)),r=e/h.year/f,k=(1.5>r?1:3>r?2:7.5>r?5:10)*f);c.tickSize=d.tickSize||[k,g];f=function(a){var b=[],c=a.tickSize[0],d=a.tickSize[1],e=new Date(a.min),k=c*h[d];"second"==d&&e.setUTCSeconds(Ea(e.getUTCSeconds(),c));"minute"==d&&e.setUTCMinutes(Ea(e.getUTCMinutes(),c));
"hour"==d&&e.setUTCHours(Ea(e.getUTCHours(),c));"month"==d&&e.setUTCMonth(Ea(e.getUTCMonth(),c));"year"==d&&e.setUTCFullYear(Ea(e.getUTCFullYear(),c));e.setUTCMilliseconds(0);k>=h.minute&&e.setUTCSeconds(0);k>=h.hour&&e.setUTCMinutes(0);k>=h.day&&e.setUTCHours(0);k>=4*h.day&&e.setUTCDate(1);k>=h.year&&e.setUTCMonth(0);var f=0,g=Number.NaN,r;do if(r=g,g=e.getTime(),b.push(g),"month"==d)if(1>c){e.setUTCDate(1);var n=e.getTime();e.setUTCMonth(e.getUTCMonth()+1);var w=e.getTime();e.setTime(g+f*h.hour+
(w-n)*c);f=e.getUTCHours();e.setUTCHours(0)}else e.setUTCMonth(e.getUTCMonth()+c);else"year"==d?e.setUTCFullYear(e.getUTCFullYear()+c):e.setTime(g+k);while(g<a.max&&g!=r);return b};k=function(a,b){var c=new Date(a);if(null!=d.timeformat)return y.plot.formatDate(c,d.timeformat,d.monthNames);var e=b.tickSize[0]*h[b.tickSize[1]],k=b.max-b.min,f=d.twelveHourClock?" %p":"";fmt=e<h.minute?"%h:%M:%S"+f:e<h.day?k<2*h.day?"%h:%M"+f:"%b %d %h:%M"+f:e<h.month?"%b %d":e<h.year?k<h.year?"%b":"%b %y":"%y";return y.plot.formatDate(c,
fmt,d.monthNames)}}else{g=d.tickDecimals;var n=-Math.floor(Math.log(e)/Math.LN10);null!=g&&n>g&&(n=g);f=Math.pow(10,-n);r=e/f;if(1.5>r)k=1;else if(3>r){if(k=2,2.25<r&&(null==g||n+1<=g))k=2.5,++n}else k=7.5>r?5:10;k*=f;null!=d.minTickSize&&k<d.minTickSize&&(k=d.minTickSize);c.tickDecimals=Math.max(0,null!=g?g:n);c.tickSize=d.tickSize||k;f=function(a){var b=[],c=Ea(a.min,a.tickSize),d=0,e=Number.NaN,k;do k=e,e=c+d*a.tickSize,b.push(e),++d;while(e<a.max&&e!=k);return b};k=function(a,b){return a.toFixed(b.tickDecimals)}}if(null!=
d.alignTicksWithAxis){var w=("x"==c.direction?G:J)[d.alignTicksWithAxis-1];w&&(w.used&&w!=c)&&(f=f(c),0<f.length&&(null==d.min&&(c.min=Math.min(c.min,f[0])),null==d.max&&1<f.length&&(c.max=Math.max(c.max,f[f.length-1]))),f=function(a){var b=[],c,d;for(d=0;d<w.ticks.length;++d)c=(w.ticks[d].v-w.min)/(w.max-w.min),c=a.min+c*(a.max-a.min),b.push(c);return b},"time"!=c.mode&&null==d.tickDecimals&&(e=Math.max(0,-Math.floor(Math.log(e)/Math.LN10)+1),r=f(c),1<r.length&&/\..*0$/.test((r[1]-r[0]).toFixed(e))||
(c.tickDecimals=e)))}c.tickGenerator=f;c.tickFormatter=y.isFunction(d.tickFormatter)?function(a,b){return""+d.tickFormatter(a,b)}:k;k=c.options.ticks;e=[];null==k||"number"==typeof k&&0<k?e=c.tickGenerator(c):k&&(e=y.isFunction(k)?k({min:c.min,max:c.max}):k);c.ticks=[];for(k=0;k<e.length;++k)r=null,g=e[k],"object"==typeof g?(f=+g[0],1<g.length&&(r=g[1])):f=+g,null==r&&(r=c.tickFormatter(f,c)),isNaN(f)||c.ticks.push({v:f,label:r});e=c.ticks;c.options.autoscaleMargin&&0<e.length&&(null==c.options.min&&
(c.min=Math.min(c.min,e[0].v)),null==c.options.max&&1<e.length&&(c.max=Math.max(c.max,e[e.length-1].v)));k=function(b,d){return y('<div style="position:absolute;top:-10000px;'+d+'font-size:smaller"><div class="'+c.direction+"Axis "+c.direction+c.n+'Axis">'+b.join("")+"</div></div>").appendTo(a)};g=c.options;f=c.ticks||[];r=[];var v;e=g.labelWidth;g=g.labelHeight;if("x"==c.direction){if(null==e&&(e=Math.floor(L/(0<f.length?f.length:1))),null==g){r=[];for(n=0;n<f.length;++n)(v=f[n].label)&&r.push('<div class="tickLabel" style="float:left;width:'+
e+'px">'+v+"</div>");0<r.length&&(r.push('<div style="clear:left"></div>'),k=k(r,"width:10000px;"),g=k.height(),k.remove())}}else if(null==e||null==g){for(n=0;n<f.length;++n)(v=f[n].label)&&r.push('<div class="tickLabel">'+v+"</div>");0<r.length&&(k=k(r,""),null==e&&(e=k.children().width()),null==g&&(g=k.find("div.tickLabel").height()),k.remove())}null==e&&(e=0);null==g&&(g=0);c.labelWidth=e;c.labelHeight=g});for(b=allocatedAxes.length-1;0<=b;--b)p(allocatedAxes[b]);var d=q.grid.minBorderMargin;if(null==
d)for(b=d=0;b<Q.length;++b)d=Math.max(d,Q[b].points.radius+Q[b].points.lineWidth/2);for(var e in D)D[e]+=q.grid.borderWidth,D[e]=Math.max(d,D[e])}P=L-D.left-D.right;O=M-D.bottom-D.top;y.each(c,function(a,b){var c=function(a){return a},d,e,k=b.options.transform||c,f=b.options.inverseTransform;"x"==b.direction?(d=b.scale=P/Math.abs(k(b.max)-k(b.min)),e=Math.min(k(b.max),k(b.min))):(d=b.scale=O/Math.abs(k(b.max)-k(b.min)),d=-d,e=Math.max(k(b.max),k(b.min)));b.p2c=k==c?function(a){return(a-e)*d}:function(a){return(k(a)-
e)*d};b.c2p=f?function(a){return f(e+a/d)}:function(a){return e+a/d}});if(q.grid.show){y.each(allocatedAxes,function(a,b){"x"==b.direction?(b.box.left=D.left,b.box.width=P):(b.box.top=D.top,b.box.height=O)});a.find(".tickLabels").remove();b=['<div class="tickLabels" style="font-size:smaller">'];c=j();for(d=0;d<c.length;++d){e=c[d];var k=e.box;if(e.show){b.push('<div class="'+e.direction+"Axis "+e.direction+e.n+'Axis" style="color:'+e.options.color+'">');for(var f=0;f<e.ticks.length;++f){var g=e.ticks[f];
if(g.label&&!(g.v<e.min||g.v>e.max)){var r={},h;"x"==e.direction?(h="center",r.left=Math.round(D.left+e.p2c(g.v)-e.labelWidth/2),"bottom"==e.position?r.top=k.top+k.padding:r.bottom=M-(k.top+k.height-k.padding)):(r.top=Math.round(D.top+e.p2c(g.v)-e.labelHeight/2),"left"==e.position?(r.right=L-(k.left+k.width-k.padding),h="right"):(r.left=k.left+k.padding,h="left"));r.width=e.labelWidth;h=["position:absolute","text-align:"+h];for(var n in r)h.push(n+":"+r[n]+"px");b.push('<div class="tickLabel" style="'+
h.join(";")+'">'+g.label+"</div>")}}b.push("</div>")}}b.push("</div>");a.append(b.join(""))}a.find(".legend").remove();if(q.legend.show){n=[];b=!1;c=q.legend.labelFormatter;for(k=0;k<Q.length;++k)if(d=Q[k],e=d.label)0==k%q.legend.noColumns&&(b&&n.push("</tr>"),n.push("<tr>"),b=!0),c&&(e=c(e,d)),n.push('<td class="legendColorBox"><div style="border:1px solid '+q.legend.labelBoxBorderColor+';padding:1px"><div style="width:4px;height:0;border:5px solid '+d.color+';overflow:hidden"></div></div></td><td class="legendLabel">'+
e+"</td>");b&&n.push("</tr>");0!=n.length&&(b='<table style="font-size:smaller;color:'+q.grid.color+'">'+n.join("")+"</table>",null!=q.legend.container?y(q.legend.container).html(b):(n="",c=q.legend.position,d=q.legend.margin,null==d[0]&&(d=[d,d]),"n"==c.charAt(0)?n+="top:"+(d[1]+D.top)+"px;":"s"==c.charAt(0)&&(n+="bottom:"+(d[1]+D.bottom)+"px;"),"e"==c.charAt(1)?n+="right:"+(d[0]+D.right)+"px;":"w"==c.charAt(1)&&(n+="left:"+(d[0]+D.left)+"px;"),b=y('<div class="legend">'+b.replace('style="','style="position:absolute;'+
n+";")+"</div>").appendTo(a),0!=q.legend.backgroundOpacity&&(c=q.legend.backgroundColor,null==c&&(c=(c=q.grid.backgroundColor)&&"string"==typeof c?y.color.parse(c):y.color.extract(b,"background-color"),c.a=1,c=c.toString()),d=b.children(),y('<div style="position:absolute;width:'+d.width()+"px;height:"+d.height()+"px;"+n+"background-color:"+c+';"> </div>').prependTo(b).css("opacity",q.legend.backgroundOpacity))))}}function s(){x.clearRect(0,0,L,M);var a=q.grid;a.show&&a.backgroundColor&&(x.save(),
x.translate(D.left,D.top),x.fillStyle=E(q.grid.backgroundColor,O,0,"rgba(255, 255, 255, 0)"),x.fillRect(0,0,P,O),x.restore());a.show&&!a.aboveData&&m();for(var b=0;b<Q.length;++b){e(N.drawSeries,[x,Q[b]]);var c=Q[b];c.lines.show&&z(c);c.bars.show&&la(c);c.points.show&&C(c)}e(N.draw,[x]);a.show&&a.aboveData&&m()}function v(a,b){var c,d,e,k,f=j();for(i=0;i<f.length;++i)if(c=f[i],c.direction==b&&(k=b+c.n+"axis",!a[k]&&1==c.n&&(k=b+"axis"),a[k])){d=a[k].from;e=a[k].to;break}a[k]||(c="x"==b?G[0]:J[0],
d=a[b+"1"],e=a[b+"2"]);null!=d&&(null!=e&&d>e)&&(k=d,d=e,e=k);return{from:d,to:e,axis:c}}function m(){var a;x.save();x.translate(D.left,D.top);var b=q.grid.markings;if(b){if(y.isFunction(b)){var c=T.getAxes();c.xmin=c.xaxis.min;c.xmax=c.xaxis.max;c.ymin=c.yaxis.min;c.ymax=c.yaxis.max;b=b(c)}for(a=0;a<b.length;++a){var c=b[a],d=v(c,"x"),e=v(c,"y");null==d.from&&(d.from=d.axis.min);null==d.to&&(d.to=d.axis.max);null==e.from&&(e.from=e.axis.min);null==e.to&&(e.to=e.axis.max);d.to<d.axis.min||(d.from>
d.axis.max||e.to<e.axis.min||e.from>e.axis.max)||(d.from=Math.max(d.from,d.axis.min),d.to=Math.min(d.to,d.axis.max),e.from=Math.max(e.from,e.axis.min),e.to=Math.min(e.to,e.axis.max),d.from==d.to&&e.from==e.to||(d.from=d.axis.p2c(d.from),d.to=d.axis.p2c(d.to),e.from=e.axis.p2c(e.from),e.to=e.axis.p2c(e.to),d.from==d.to||e.from==e.to?(x.beginPath(),x.strokeStyle=c.color||q.grid.markingsColor,x.lineWidth=c.lineWidth||q.grid.markingsLineWidth,x.moveTo(d.from,e.from),x.lineTo(d.to,e.to),x.stroke()):(x.fillStyle=
c.color||q.grid.markingsColor,x.fillRect(d.from,e.to,d.to-d.from,e.from-e.to))))}}c=j();b=q.grid.borderWidth;for(d=0;d<c.length;++d){e=c[d];a=e.box;var k=e.tickLength,f,g,r,h;if(e.show&&0!=e.ticks.length){x.strokeStyle=e.options.tickColor||y.color.parse(e.options.color).scale("a",0.22).toString();x.lineWidth=1;"x"==e.direction?(f=0,g="full"==k?"top"==e.position?0:O:a.top-D.top+("top"==e.position?a.height:0)):(g=0,f="full"==k?"left"==e.position?0:P:a.left-D.left+("left"==e.position?a.width:0));e.innermost||
(x.beginPath(),r=h=0,"x"==e.direction?r=P:h=O,1==x.lineWidth&&(f=Math.floor(f)+0.5,g=Math.floor(g)+0.5),x.moveTo(f,g),x.lineTo(f+r,g+h),x.stroke());x.beginPath();for(a=0;a<e.ticks.length;++a){var n=e.ticks[a].v;r=h=0;n<e.min||(n>e.max||"full"==k&&0<b&&(n==e.min||n==e.max))||("x"==e.direction?(f=e.p2c(n),h="full"==k?-O:k,"top"==e.position&&(h=-h)):(g=e.p2c(n),r="full"==k?-P:k,"left"==e.position&&(r=-r)),1==x.lineWidth&&("x"==e.direction?f=Math.floor(f)+0.5:g=Math.floor(g)+0.5),x.moveTo(f,g),x.lineTo(f+
r,g+h))}x.stroke()}}b&&(x.lineWidth=b,x.strokeStyle=q.grid.borderColor,x.strokeRect(-b/2,-b/2,P+b,O+b));x.restore()}function z(a){function b(a,c,d,e,k){var f=a.points,a=a.pointsize,g=null,r=null;x.beginPath();for(var h=a;h<f.length;h+=a){var n=f[h-a],j=f[h-a+1],m=f[h],w=f[h+1];if(!(null==n||null==m)){if(j<=w&&j<k.min){if(w<k.min)continue;n=(k.min-j)/(w-j)*(m-n)+n;j=k.min}else if(w<=j&&w<k.min){if(j<k.min)continue;m=(k.min-j)/(w-j)*(m-n)+n;w=k.min}if(j>=w&&j>k.max){if(w>k.max)continue;n=(k.max-j)/
(w-j)*(m-n)+n;j=k.max}else if(w>=j&&w>k.max){if(j>k.max)continue;m=(k.max-j)/(w-j)*(m-n)+n;w=k.max}if(n<=m&&n<e.min){if(m<e.min)continue;j=(e.min-n)/(m-n)*(w-j)+j;n=e.min}else if(m<=n&&m<e.min){if(n<e.min)continue;w=(e.min-n)/(m-n)*(w-j)+j;m=e.min}if(n>=m&&n>e.max){if(m>e.max)continue;j=(e.max-n)/(m-n)*(w-j)+j;n=e.max}else if(m>=n&&m>e.max){if(n>e.max)continue;w=(e.max-n)/(m-n)*(w-j)+j;m=e.max}(n!=g||j!=r)&&x.moveTo(e.p2c(n)+c,k.p2c(j)+d);g=m;r=w;x.lineTo(e.p2c(m)+c,k.p2c(w)+d)}}x.stroke()}x.save();
x.translate(D.left,D.top);x.lineJoin="round";var c=a.lines.lineWidth,d=a.shadowSize;if(0<c&&0<d){x.lineWidth=d;x.strokeStyle="rgba(0,0,0,0.1)";var e=Math.PI/18;b(a.datapoints,Math.sin(e)*(c/2+d/2),Math.cos(e)*(c/2+d/2),a.xaxis,a.yaxis);x.lineWidth=d/2;b(a.datapoints,Math.sin(e)*(c/2+d/4),Math.cos(e)*(c/2+d/4),a.xaxis,a.yaxis)}x.lineWidth=c;x.strokeStyle=a.color;if(d=Z(a.lines,a.color,0,O)){x.fillStyle=d;for(var k=a.datapoints,d=a.xaxis,e=a.yaxis,f=k.points,k=k.pointsize,g=Math.min(Math.max(0,e.min),
e.max),r=0,h=!1,n=1,w=0,v=0;!(0<k&&r>f.length+k);){var r=r+k,j=f[r-k],m=f[r-k+n],z=f[r],C=f[r+n];if(h){if(0<k&&null!=j&&null==z){v=r;k=-k;n=2;continue}if(0>k&&r==w+k){x.fill();h=!1;k=-k;n=1;r=w=v+k;continue}}if(!(null==j||null==z)){if(j<=z&&j<d.min){if(z<d.min)continue;m=(d.min-j)/(z-j)*(C-m)+m;j=d.min}else if(z<=j&&z<d.min){if(j<d.min)continue;C=(d.min-j)/(z-j)*(C-m)+m;z=d.min}if(j>=z&&j>d.max){if(z>d.max)continue;m=(d.max-j)/(z-j)*(C-m)+m;j=d.max}else if(z>=j&&z>d.max){if(j>d.max)continue;C=(d.max-
j)/(z-j)*(C-m)+m;z=d.max}h||(x.beginPath(),x.moveTo(d.p2c(j),e.p2c(g)),h=!0);if(m>=e.max&&C>=e.max)x.lineTo(d.p2c(j),e.p2c(e.max)),x.lineTo(d.p2c(z),e.p2c(e.max));else if(m<=e.min&&C<=e.min)x.lineTo(d.p2c(j),e.p2c(e.min)),x.lineTo(d.p2c(z),e.p2c(e.min));else{var Y=j,ha=z;m<=C&&m<e.min&&C>=e.min?(j=(e.min-m)/(C-m)*(z-j)+j,m=e.min):C<=m&&(C<e.min&&m>=e.min)&&(z=(e.min-m)/(C-m)*(z-j)+j,C=e.min);m>=C&&m>e.max&&C<=e.max?(j=(e.max-m)/(C-m)*(z-j)+j,m=e.max):C>=m&&(C>e.max&&m<=e.max)&&(z=(e.max-m)/(C-m)*
(z-j)+j,C=e.max);j!=Y&&x.lineTo(d.p2c(Y),e.p2c(m));x.lineTo(d.p2c(j),e.p2c(m));x.lineTo(d.p2c(z),e.p2c(C));z!=ha&&(x.lineTo(d.p2c(z),e.p2c(C)),x.lineTo(d.p2c(ha),e.p2c(C)))}}}}0<c&&b(a.datapoints,0,0,a.xaxis,a.yaxis);x.restore()}function C(a){function b(a,c,d,e,k,f,g,r){for(var n=a.points,a=a.pointsize,h=0;h<n.length;h+=a){var j=n[h],m=n[h+1];null==j||(j<f.min||j>f.max||m<g.min||m>g.max)||(x.beginPath(),j=f.p2c(j),m=g.p2c(m)+e,"circle"==r?x.arc(j,m,c,0,k?Math.PI:2*Math.PI,!1):r(x,j,m,c,k),x.closePath(),
d&&(x.fillStyle=d,x.fill()),x.stroke())}}x.save();x.translate(D.left,D.top);var c=a.points.lineWidth,d=a.shadowSize,e=a.points.radius,k=a.points.symbol;0<c&&0<d&&(d/=2,x.lineWidth=d,x.strokeStyle="rgba(0,0,0,0.1)",b(a.datapoints,e,null,d+d/2,!0,a.xaxis,a.yaxis,k),x.strokeStyle="rgba(0,0,0,0.2)",b(a.datapoints,e,null,d/2,!0,a.xaxis,a.yaxis,k));x.lineWidth=c;x.strokeStyle=a.color;b(a.datapoints,e,Z(a.points,a.color),0,!1,a.xaxis,a.yaxis,k);x.restore()}function Y(a,b,c,d,e,k,f,g,r,h,n,j){var m,w,v,z;
n?(z=w=v=!0,m=!1,n=c,c=b+d,e=b+e,a<n&&(b=a,a=n,n=b,m=!0,w=!1)):(m=w=v=!0,z=!1,n=a+d,a+=e,e=c,c=b,c<e&&(b=c,c=e,e=b,z=!0,v=!1));if(!(a<g.min||n>g.max||c<r.min||e>r.max))if(n<g.min&&(n=g.min,m=!1),a>g.max&&(a=g.max,w=!1),e<r.min&&(e=r.min,z=!1),c>r.max&&(c=r.max,v=!1),n=g.p2c(n),e=r.p2c(e),a=g.p2c(a),c=r.p2c(c),f&&(h.beginPath(),h.moveTo(n,e),h.lineTo(n,c),h.lineTo(a,c),h.lineTo(a,e),h.fillStyle=f(e,c),h.fill()),0<j&&(m||w||v||z))h.beginPath(),h.moveTo(n,e+k),m?h.lineTo(n,c+k):h.moveTo(n,c+k),v?h.lineTo(a,
c+k):h.moveTo(a,c+k),w?h.lineTo(a,e+k):h.moveTo(a,e+k),z?h.lineTo(n,e+k):h.moveTo(n,e+k),h.stroke()}function la(a){x.save();x.translate(D.left,D.top);x.lineWidth=a.bars.lineWidth;x.strokeStyle=a.color;for(var b="left"==a.bars.align?0:-a.bars.barWidth/2,c=a.datapoints,d=b+a.bars.barWidth,e=a.bars.fill?function(b,c){return Z(a.bars,a.color,b,c)}:null,k=a.xaxis,f=a.yaxis,g=c.points,c=c.pointsize,r=0;r<g.length;r+=c)null!=g[r]&&Y(g[r],g[r+1],g[r+2],b,d,0,e,k,f,x,a.bars.horizontal,a.bars.lineWidth);x.restore()}
function Z(a,b,c,d){var e=a.fill;if(!e)return null;if(a.fillColor)return E(a.fillColor,c,d,b);a=y.color.parse(b);a.a="number"==typeof e?e:0.4;a.normalize();return a.toString()}function db(a){q.grid.hoverable&&r("plothover",a,function(a){return!1!=a.hoverable})}function u(a){q.grid.hoverable&&r("plothover",a,function(){return!1})}function k(a){r("plotclick",a,function(a){return!1!=a.clickable})}function r(b,c,d){var e=H.offset(),k=c.pageX-e.left-D.left,f=c.pageY-e.top-D.top,g=xa({left:k,top:f});g.pageX=
c.pageX;g.pageY=c.pageY;var c=q.grid.mouseActiveRadius,r=c*c+1,h=null,n,j;for(n=Q.length-1;0<=n;--n)if(d(Q[n])){var m=Q[n],w=m.xaxis,v=m.yaxis,z=m.datapoints.points,C=m.datapoints.pointsize,Y=w.c2p(k),la=v.c2p(f),l=c/w.scale,Fa=c/v.scale;w.options.inverseTransform&&(l=Number.MAX_VALUE);v.options.inverseTransform&&(Fa=Number.MAX_VALUE);if(m.lines.show||m.points.show)for(j=0;j<z.length;j+=C){var t=z[j],Z=z[j+1];if(null!=t&&!(t-Y>l||t-Y<-l||Z-la>Fa||Z-la<-Fa))t=Math.abs(w.p2c(t)-k),Z=Math.abs(v.p2c(Z)-
f),Z=t*t+Z*Z,Z<r&&(r=Z,h=[n,j/C])}if(m.bars.show&&!h){w="left"==m.bars.align?0:-m.bars.barWidth/2;m=w+m.bars.barWidth;for(j=0;j<z.length;j+=C)if(t=z[j],Z=z[j+1],v=z[j+2],null!=t&&(Q[n].bars.horizontal?Y<=Math.max(v,t)&&Y>=Math.min(v,t)&&la>=Z+w&&la<=Z+m:Y>=t+w&&Y<=t+m&&la>=Math.min(v,Z)&&la<=Math.max(v,Z)))h=[n,j/C]}}h?(n=h[0],j=h[1],C=Q[n].datapoints.pointsize,d={datapoint:Q[n].datapoints.points.slice(j*C,(j+1)*C),dataIndex:j,series:Q[n],seriesIndex:n}):d=null;d&&(d.pageX=parseInt(d.series.xaxis.p2c(d.datapoint[0])+
e.left+D.left),d.pageY=parseInt(d.series.yaxis.p2c(d.datapoint[1])+e.top+D.top));if(q.grid.autoHighlight){for(e=0;e<S.length;++e)k=S[e],k.auto==b&&(!d||!(k.series==d.series&&k.point[0]==d.datapoint[0]&&k.point[1]==d.datapoint[1]))&&ha(k.series,k.point);d&&ma(d.series,d.datapoint,b)}a.trigger(b,[g,d])}function n(){X||(X=setTimeout(w,30))}function w(){X=null;F.save();F.clearRect(0,0,L,M);F.translate(D.left,D.top);var a,b;for(a=0;a<S.length;++a)if(b=S[a],b.series.bars.show)A(b.series,b.point);else{var c=
b.series,d=b.point;b=d[0];var d=d[1],k=c.xaxis,f=c.yaxis;if(!(b<k.min||b>k.max||d<f.min||d>f.max)){var g=c.points.radius+c.points.lineWidth/2;F.lineWidth=g;F.strokeStyle=y.color.parse(c.color).scale("a",0.5).toString();g*=1.5;b=k.p2c(b);d=f.p2c(d);F.beginPath();"circle"==c.points.symbol?F.arc(b,d,g,0,2*Math.PI,!1):c.points.symbol(F,b,d,g,!1);F.closePath();F.stroke()}}F.restore();e(N.drawOverlay,[F])}function ma(a,b,c){"number"==typeof a&&(a=Q[a]);if("number"==typeof b)var d=a.datapoints.pointsize,
b=a.datapoints.points.slice(d*b,d*(b+1));d=Fa(a,b);-1==d?(S.push({series:a,point:b,auto:c}),n()):c||(S[d].auto=!1)}function ha(a,b){null==a&&null==b&&(S=[],n());"number"==typeof a&&(a=Q[a]);"number"==typeof b&&(b=a.data[b]);var c=Fa(a,b);-1!=c&&(S.splice(c,1),n())}function Fa(a,b){for(var c=0;c<S.length;++c){var d=S[c];if(d.series==a&&d.point[0]==b[0]&&d.point[1]==b[1])return c}return-1}function A(a,b){F.lineWidth=a.bars.lineWidth;F.strokeStyle=y.color.parse(a.color).scale("a",0.5).toString();var c=
y.color.parse(a.color).scale("a",0.5).toString(),d="left"==a.bars.align?0:-a.bars.barWidth/2;Y(b[0],b[1],b[2]||0,d,d+a.bars.barWidth,0,function(){return c},a.xaxis,a.yaxis,F,a.bars.horizontal,a.bars.lineWidth)}function E(a,b,c,d){if("string"==typeof a)return a;for(var b=x.createLinearGradient(0,c,0,b),c=0,e=a.colors.length;c<e;++c){var k=a.colors[c];if("string"!=typeof k){var f=y.color.parse(d);null!=k.brightness&&(f=f.scale("rgb",k.brightness));null!=k.opacity&&(f.a*=k.opacity);k=f.toString()}b.addColorStop(c/
(e-1),k)}return b}var Q=[],q={colors:["#edc240","#afd8f8","#cb4b4b","#4da74d","#9440ed"],legend:{show:!0,noColumns:1,labelFormatter:null,labelBoxBorderColor:"#ccc",container:null,position:"ne",margin:5,backgroundColor:null,backgroundOpacity:0.85},xaxis:{show:null,position:"bottom",mode:null,color:null,tickColor:null,transform:null,inverseTransform:null,min:null,max:null,autoscaleMargin:null,ticks:null,tickFormatter:null,labelWidth:null,labelHeight:null,reserveSpace:null,tickLength:null,alignTicksWithAxis:null,
tickDecimals:null,tickSize:null,minTickSize:null,monthNames:null,timeformat:null,twelveHourClock:!1},yaxis:{autoscaleMargin:0.02,position:"left"},xaxes:[],yaxes:[],series:{points:{show:!1,radius:3,lineWidth:2,fill:!0,fillColor:"#ffffff",symbol:"circle"},lines:{lineWidth:2,fill:!1,fillColor:null,steps:!1},bars:{show:!1,lineWidth:2,barWidth:1,fill:!0,fillColor:null,align:"left",horizontal:!1},shadowSize:3},grid:{show:!0,aboveData:!1,color:"#545454",backgroundColor:null,borderColor:null,tickColor:null,
labelMargin:5,axisMargin:8,borderWidth:2,minBorderMargin:null,markings:null,markingsColor:"#f4f4f4",markingsLineWidth:2,clickable:!1,hoverable:!1,autoHighlight:!0,mouseActiveRadius:10},hooks:{}},B=null,I=null,H=null,x=null,F=null,G=[],J=[],D={left:0,right:0,top:0,bottom:0},L=0,M=0,P=0,O=0,N={processOptions:[],processRawData:[],processDatapoints:[],drawSeries:[],draw:[],bindEvents:[],drawOverlay:[],shutdown:[]},T=this;T.setData=f;T.setupGrid=K;T.draw=s;T.getPlaceholder=function(){return a};T.getCanvas=
function(){return B};T.getPlotOffset=function(){return D};T.width=function(){return P};T.height=function(){return O};T.offset=function(){var a=H.offset();a.left+=D.left;a.top+=D.top;return a};T.getData=function(){return Q};T.getAxes=function(){var a={};y.each(G.concat(J),function(b,c){c&&(a[c.direction+(1!=c.n?c.n:"")+"axis"]=c)});return a};T.getXAxes=function(){return G};T.getYAxes=function(){return J};T.c2p=xa;T.p2c=function(a){var b={},c,d,e;for(c=0;c<G.length;++c)if((d=G[c])&&d.used)if(e="x"+
d.n,null==a[e]&&1==d.n&&(e="x"),null!=a[e]){b.left=d.p2c(a[e]);break}for(c=0;c<J.length;++c)if((d=J[c])&&d.used)if(e="y"+d.n,null==a[e]&&1==d.n&&(e="y"),null!=a[e]){b.top=d.p2c(a[e]);break}return b};T.getOptions=function(){return q};T.highlight=ma;T.unhighlight=ha;T.triggerRedrawOverlay=n;T.pointOffset=function(a){return{left:parseInt(G[h(a,"x")-1].p2c(+a.x)+D.left),top:parseInt(J[h(a,"y")-1].p2c(+a.y)+D.top)}};T.shutdown=function(){X&&clearTimeout(X);H.unbind("mousemove",db);H.unbind("mouseleave",
u);H.unbind("click",k);e(N.shutdown,[H])};T.resize=function(){U();g(B);g(I)};T.hooks=N;for(var V=0;V<d.length;++V){var W=d[V];W.init(T);W.options&&y.extend(!0,q,W.options)}y.extend(!0,q,c);null==q.xaxis.color&&(q.xaxis.color=q.grid.color);null==q.yaxis.color&&(q.yaxis.color=q.grid.color);null==q.xaxis.tickColor&&(q.xaxis.tickColor=q.grid.tickColor);null==q.yaxis.tickColor&&(q.yaxis.tickColor=q.grid.tickColor);null==q.grid.borderColor&&(q.grid.borderColor=q.grid.color);null==q.grid.tickColor&&(q.grid.tickColor=
y.color.parse(q.grid.color).scale("a",0.22).toString());for(c=0;c<Math.max(1,q.xaxes.length);++c)q.xaxes[c]=y.extend(!0,{},q.xaxis,q.xaxes[c]);for(c=0;c<Math.max(1,q.yaxes.length);++c)q.yaxes[c]=y.extend(!0,{},q.yaxis,q.yaxes[c]);q.xaxis.noTicks&&null==q.xaxis.ticks&&(q.xaxis.ticks=q.xaxis.noTicks);q.yaxis.noTicks&&null==q.yaxis.ticks&&(q.yaxis.ticks=q.yaxis.noTicks);q.x2axis&&(q.xaxes[1]=y.extend(!0,{},q.xaxis,q.x2axis),q.xaxes[1].position="top");q.y2axis&&(q.yaxes[1]=y.extend(!0,{},q.yaxis,q.y2axis),
q.yaxes[1].position="right");q.grid.coloredAreas&&(q.grid.markings=q.grid.coloredAreas);q.grid.coloredAreasColor&&(q.grid.markingsColor=q.grid.coloredAreasColor);q.lines&&y.extend(!0,q.series.lines,q.lines);q.points&&y.extend(!0,q.series.points,q.points);q.bars&&y.extend(!0,q.series.bars,q.bars);null!=q.shadowSize&&(q.series.shadowSize=q.shadowSize);for(c=0;c<q.xaxes.length;++c)l(G,c+1).options=q.xaxes[c];for(c=0;c<q.yaxes.length;++c)l(J,c+1).options=q.yaxes[c];for(var R in N)q.hooks[R]&&q.hooks[R].length&&
(N[R]=N[R].concat(q.hooks[R]));e(N.processOptions,[q]);R=a.children("canvas.base");c=a.children("canvas.overlay");0==R.length||0==c?(a.html(""),a.css({padding:0}),"static"==a.css("position")&&a.css("position","relative"),U(),B=t(!0,"base"),I=t(!1,"overlay"),R=!1):(B=R.get(0),I=c.get(0),R=!0);x=B.getContext("2d");F=I.getContext("2d");H=y([I,B]);R&&(a.data("plot").shutdown(),T.resize(),F.clearRect(0,0,L,M),H.unbind(),a.children().not([B,I]).remove());a.data("plot",T);f(b);K();s();q.grid.hoverable&&
(H.mousemove(db),H.mouseleave(u));q.grid.clickable&&H.click(k);e(N.bindEvents,[H]);var S=[],X=null},Ea=function(a,b){return b*Math.floor(a/b)};y.plot=function(a,b,c){return new Ec(y(a),b,c,y.plot.plugins)};y.plot.version="0.7";y.plot.plugins=[];y.plot.formatDate=function(a,b,c){var d=function(a){a=""+a;return 1==a.length?"0"+a:a},e=[],f=!1,h=!1,j=a.getUTCHours(),xa=12>j;null==c&&(c="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "));-1!=b.search(/%p|%P/)&&(12<j?j-=12:0==j&&(j=12));for(var l=
0;l<b.length;++l){var t=b.charAt(l);if(f){switch(t){case "h":t=""+j;break;case "H":t=d(j);break;case "M":t=d(a.getUTCMinutes());break;case "S":t=d(a.getUTCSeconds());break;case "d":t=""+a.getUTCDate();break;case "m":t=""+(a.getUTCMonth()+1);break;case "y":t=""+a.getUTCFullYear();break;case "b":t=""+c[a.getUTCMonth()];break;case "p":t=xa?"am":"pm";break;case "P":t=xa?"AM":"PM";break;case "0":t="",h=!0}t&&h&&(t=d(t),h=!1);e.push(t);h||(f=!1)}else"%"==t?f=!0:e.push(t)}return e.join("")};var Jb={},Kb=
"undefined"!==typeof B?B:Jb,Lb=function(a,b,c){var d;b&&"object"==typeof b&&(null!=b[a]?d=b[a]:c&&(b.get&&"function"==typeof b.get)&&(d=b.get(a)));return d},eb=function(a){return String(null===a||a===aa?"":a)};Kb.Template=function(a,b,c,d){a=a||{};this.r=a.code||this.r;this.c=c;this.options=d||{};this.text=b||"";this.partials=a.partials||{};this.subs=a.subs||{};this.ib()};Kb.Template.prototype={r:function(){return""},v:function(a){a=eb(a);return Fc.test(a)?a.replace(Gc,"&amp;").replace(Hc,"&lt;").replace(Ic,
"&gt;").replace(Jc,"&#39;").replace(Kc,"&quot;"):a},t:eb,render:function(a,b,c){return this.ri([a],b||{},c)},ri:function(a,b,c){return this.r(a,b,c)},ep:function(a,b){var c=this.partials[a],d=b[c.name];if(c.instance&&c.base==d)return c.instance;if("string"==typeof d){if(!this.c)throw Error("No compiler available.");d=this.c.compile(d,this.options)}if(!d)return null;this.partials[a].base=d;if(c.subs){this.activeSub===aa&&(b.stackText=this.text);var e=d,d=c.subs,c=c.partials,f=this.stackSubs,h=this.stackPartials,
j=b.stackText||this.text,xa=function(){},l=function(){};xa.prototype=e;l.prototype=e.subs;var t,e=new xa;e.subs=new l;e.subsText={};e.ib();f=f||{};e.stackSubs=f;for(t in d)f[t]||(f[t]=d[t]),e.subsText[t]=j;for(t in f)e.subs[t]=f[t];h=h||{};e.stackPartials=h;for(t in c)h[t]||(h[t]=c[t]);for(t in h)e.partials[t]=h[t];d=e}return this.partials[a].instance=d},rp:function(a,b,c,d){a=this.ep(a,c);return!a?"":a.ri(b,c,d)},rs:function(a,b,c){var d=a[a.length-1];if(sb(d))for(var e=0;e<d.length;e++)a.push(d[e]),
c(a,b,this),a.pop();else c(a,b,this)},s:function(a,b,c,d,e,f,h){if(sb(a)&&0===a.length)return!1;"function"==typeof a&&(a=this.ms(a,b,c,d,e,f,h));c=!!a;!d&&(c&&b)&&b.push("object"==typeof a?a:b[b.length-1]);return c},d:function(a,b,c,d){var e=a.split("."),f=this.f(e[0],b,c,d),h=this.options.modelGet,j=null;if("."===a&&sb(b[b.length-2]))f=b[b.length-1];else for(var l=1;l<e.length;l++)a=Lb(e[l],f,h),null!=a?(j=f,f=a):f="";if(d&&!f)return!1;!d&&"function"==typeof f&&(b.push(j),f=this.mv(f,b,c),b.pop());
return f},f:function(a,b,c,d){for(var e=!1,f=null,h=!1,j=this.options.modelGet,l=b.length-1;0<=l;l--)if(f=b[l],e=Lb(a,f,j),null!=e){h=!0;break}if(!h)return d?!1:"";!d&&"function"==typeof e&&(e=this.mv(e,b,c));return e},ls:function(a,b,c,d,e){var f=this.options.delimiters;this.options.delimiters=e;this.b(this.ct(eb(a.call(b,d)),b,c));this.options.delimiters=f;return!1},ct:function(a,b,c){if(this.options.disableLambda)throw Error("Lambda features disabled.");return this.c.compile(a,this.options).render(b,
c)},b:function(a){this.buf+=a},fl:function(){var a=this.buf;this.buf="";return a},ib:function(){this.buf=""},ms:function(a,b,c,d,e,f,h){b=b[b.length-1];a=a.call(b);if("function"==typeof a){if(d)return!0;d=this.activeSub&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text;return this.ls(a,b,c,d.substring(e,f),h)}return a},mv:function(a,b,c){b=b[b.length-1];a=a.call(b);return"function"==typeof a?this.ct(eb(a.call(b)),b,c):a},sub:function(a,b,c,d){var e=this.subs[a];e&&(this.activeSub=
a,e(b,c,this,d),this.activeSub=!1)}};var Gc=/&/g,Hc=/</g,Ic=/>/g,Jc=/\'/g,Kc=/\"/g,Fc=/[&<>\"\']/,sb=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},L="undefined"!==typeof B?B:Jb,Mb=function(a){return a.trim?a.trim():a.replace(/^\s*|\s*$/g,"")},Nb=function(a,b,c){if(b.charAt(c)!=a.charAt(0))return!1;for(var d=1,e=a.length;d<e;d++)if(b.charAt(c+d)!=a.charAt(d))return!1;return!0},Ob=function(a,b,c,d){for(var b=[],e=null,f=e=null,e=c[c.length-1];0<a.length;){f=
a.shift();if(e&&"<"==e.tag&&!(f.tag in Lc))throw Error("Illegal content in < super tag.");var h;if(!(h=L.tags[f.tag]<=L.tags.$))a:{h=f;for(var j=d,l=0,p=j.length;l<p;l++)if(j[l].o==h.n){h.tag="#";h=!0;break a}h=void 0}if(h)c.push(f),f.nodes=Ob(a,f.tag,c,d);else{if("/"==f.tag){if(0===c.length)throw Error("Closing tag without opener: /"+f.n);e=c.pop();if(a=f.n!=e.n){a:{a=0;for(c=d.length;a<c;a++)if(d[a].c==f.n&&d[a].o==e.n){d=!0;break a}d=void 0}a=!d}if(a)throw Error("Nesting error: "+e.n+" vs. "+f.n);
e.end=f.i;return b}"\n"==f.tag&&(f.last=0==a.length||"\n"==a[0].tag)}b.push(f)}if(0<c.length)throw Error("missing closing tag: "+c.pop().n);return b},Pb=function(a){var b=[],c;for(c in a.partials)b.push('"'+pa(c)+'":{name:"'+pa(a.partials[c].name)+'", '+Pb(a.partials[c])+"}");var b="partials: {"+b.join(",")+"}, subs: ",d,a=a.subs;c=[];for(d in a)c.push('"'+pa(d)+'": function(c,p,t,i) {'+a[d]+"}");d="{ "+c.join(",")+" }";return b+d},pa=function(a){return a.replace(Mc,"\\\\").replace(Nc,'\\"').replace(Oc,
"\\n").replace(Pc,"\\r")},fb=function(a){return~a.indexOf(".")?"d":"f"},Rb=function(a,b){var c="<"+(b.prefix||"")+a.n+Qb++;b.partials[c]={name:a.n,partials:{}};b.code+='t.b(t.rp("'+pa(c)+'",c,p,"'+(a.indent||"")+'"));';return c},Sb=function(a,b){b.code+="t.b(t.t(t."+fb(a.n)+'("'+pa(a.n)+'",c,p,0)));'},Qc=/\S/,Nc=/\"/g,Oc=/\n/g,Pc=/\r/g,Mc=/\\/g;L.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12};L.scan=function(a,b){function c(){0<l.length&&(p.push({tag:"_t",text:new String(l)}),
l="")}function d(a,b){c();var d;if(d=a)a:{d=!0;for(var e=g;e<p.length;e++)if(d=L.tags[p[e].tag]<L.tags._v||"_t"==p[e].tag&&null===p[e].text.match(Qc),!d){d=!1;break a}}if(d){d=g;for(var f;d<p.length;d++)if(p[d].text){if((f=p[d+1])&&">"==f.tag)f.indent=p[d].text.toString();p.splice(d,1)}}else b||p.push({tag:"\n"});t=!1;g=p.length}var e=a.length,f=0,h=null,j=null,l="",p=[],t=!1,U=0,g=0,s="{{",K="}}";b&&(b=b.split(" "),s=b[0],K=b[1]);for(U=0;U<e;U++)0==f?Nb(s,a,U)?(--U,c(),f=1):"\n"==a.charAt(U)?d(t):
l+=a.charAt(U):1==f?(U+=s.length-1,h=(j=L.tags[a.charAt(U+1)])?a.charAt(U+1):"_v","="==h?(s=a,j=U,U="="+K,f=s.indexOf(U,j),K=Mb(s.substring(s.indexOf("=",j)+1,f)).split(" "),s=K[0],K=K[K.length-1],U=f+U.length-1,f=0):(j&&U++,f=2),t=U):Nb(K,a,U)?(p.push({tag:h,n:Mb(l),otag:s,ctag:K,i:"/"==h?t-s.length:U+K.length}),l="",U+=K.length-1,f=0,"{"==h&&("}}"==K?U++:(j=p[p.length-1],"}"===j.n.substr(j.n.length-1)&&(j.n=j.n.substring(0,j.n.length-1))))):l+=a.charAt(U);d(t,!0);return p};var Lc={_t:!0,"\n":!0,
$:!0,"/":!0};L.stringify=function(a){return"{code: function (c,p,i) { "+L.wrapMain(a.code)+" },"+Pb(a)+"}"};var Qb=0;L.generate=function(a,b,c){Qb=0;var d={code:"",subs:{},partials:{}};L.walk(a,d);return c.asString?this.stringify(d,b,c):this.makeTemplate(d,b,c)};L.wrapMain=function(a){return'var t=this;t.b(i=i||"");'+a+"return t.fl();"};L.template=L.Template;L.makeTemplate=function(a,b,c){var d=this.makePartials(a);d.code=new Function("c","p","i",this.wrapMain(a.code));return new this.template(d,
b,this,c)};L.makePartials=function(a){var b,c={subs:{},partials:a.partials,name:a.name};for(b in c.partials)c.partials[b]=this.makePartials(c.partials[b]);for(b in a.subs)c.subs[b]=new Function("c","p","t","i",a.subs[b]);return c};L.codegen={"#":function(a,b){b.code+="if(t.s(t."+fb(a.n)+'("'+pa(a.n)+'",c,p,1),c,p,0,'+a.i+","+a.end+',"'+a.otag+" "+a.ctag+'")){t.rs(c,p,function(c,p,t){';L.walk(a.nodes,b);b.code+="});c.pop();}"},"^":function(a,b){b.code+="if(!t.s(t."+fb(a.n)+'("'+pa(a.n)+'",c,p,1),c,p,1,0,0,"")){';
L.walk(a.nodes,b);b.code+="};"},">":Rb,"<":function(a,b){var c={partials:{},code:"",subs:{},inPartial:!0};L.walk(a.nodes,c);var d=b.partials[Rb(a,b)];d.subs=c.subs;d.partials=c.partials},$:function(a,b){var c={subs:{},code:"",partials:b.partials,prefix:a.n};L.walk(a.nodes,c);b.subs[a.n]=c.code;b.inPartial||(b.code+='t.sub("'+pa(a.n)+'",c,p,i);')},"\n":function(a,b){b.code+='t.b("\\n"'+(a.last?"":" + i")+");"},_v:function(a,b){b.code+="t.b(t.v(t."+fb(a.n)+'("'+pa(a.n)+'",c,p,0)));'},_t:function(a,
b){var c=b.code,d='"'+pa(a.text)+'"';b.code=c+("t.b("+d+");")},"{":Sb,"&":Sb};L.walk=function(a,b){for(var c,d=0,e=a.length;d<e;d++)(c=L.codegen[a[d].tag])&&c(a[d],b);return b};L.parse=function(a,b,c){c=c||{};return Ob(a,"",[],c.sectionTags||[])};L.cache={};L.cacheKey=function(a,b){return[a,!!b.asString,!!b.disableLambda,b.delimiters,!!b.modelGet].join("||")};L.compile=function(a,b){var b=b||{},c=L.cacheKey(a,b),d=this.cache[c];if(d)return d;d=this.generate(this.parse(this.scan(a,b.delimiters),a,
b),a,b);return this.cache[c]=d};(function(){var a=this,b=a._,c={},d=Array.prototype,e=Object.prototype,f=d.push,h=d.slice,j=d.concat,l=e.toString,p=e.hasOwnProperty,e=Array.isArray,t=Object.keys,s=Function.prototype.bind,g=function(a){if(a instanceof g)return a;if(!(this instanceof g))return new g(a);this._wrapped=a};"undefined"!==typeof B?("undefined"!==typeof module&&module.exports&&(B=module.exports=g),B._=g):a._=g;g.VERSION="1.6.0";g.each=g.forEach=function(a,b,d){if(null==a)return a;if(a.length===
+a.length)for(var e=0,f=a.length;e<f;e++){if(b.call(d,a[e],e,a)===c)return}else for(var h=g.keys(a),e=0,f=h.length;e<f;e++)if(b.call(d,a[h[e]],h[e],a)===c)return;return a};g.map=g.collect=function(a,b,c){var d=[];if(null==a)return d;g.each(a,function(a,e,k){d.push(b.call(c,a,e,k))});return d};g.reduce=g.foldl=g.inject=function(a,b,c,d){var e=2<arguments.length;null==a&&(a=[]);g.each(a,function(a,k,f){e?c=b.call(d,c,a,k,f):(c=a,e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");
return c};g.reduceRight=g.foldr=function(a,b,c,d){var e=2<arguments.length;null==a&&(a=[]);var f=a.length;if(f!==+f)var h=g.keys(a),f=h.length;g.each(a,function(g,j,m){j=h?h[--f]:--f;e?c=b.call(d,c,a[j],j,m):(c=a[j],e=!0)});if(!e)throw new TypeError("Reduce of empty array with no initial value");return c};g.find=g.detect=function(a,b,c){var d;g.some(a,function(a,e,k){if(b.call(c,a,e,k))return d=a,!0});return d};g.filter=g.select=function(a,b,c){var d=[];if(null==a)return d;g.each(a,function(a,e,k){b.call(c,
a,e,k)&&d.push(a)});return d};g.reject=function(a,b,c){return g.filter(a,g.negate(b),c)};g.every=g.all=function(a,b,d){b||(b=g.identity);var e=!0;if(null==a)return e;g.each(a,function(a,k,f){if(!(e=e&&b.call(d,a,k,f)))return c});return!!e};g.some=g.any=function(a,b,d){b||(b=g.identity);var e=!1;if(null==a)return e;g.each(a,function(a,k,f){if(e||(e=b.call(d,a,k,f)))return c});return!!e};g.contains=g.include=function(a,b){return null==a?!1:a.length===+a.length?0<=g.indexOf(a,b):g.some(a,function(a){return a===
b})};g.invoke=function(a,b){var c=h.call(arguments,2),d=g.isFunction(b);return g.map(a,function(a){return(d?b:a[b]).apply(a,c)})};g.pluck=function(a,b){return g.map(a,g.property(b))};g.where=function(a,b){return g.filter(a,g.matches(b))};g.findWhere=function(a,b){return g.find(a,g.matches(b))};g.max=function(a,b,c){var d=-Infinity,e=-Infinity,f,h;if(!b&&g.isArray(a))for(var j=0,m=a.length;j<m;j++)f=a[j],f>d&&(d=f);else g.each(a,function(a,k,f){h=b?b.call(c,a,k,f):a;h>e&&(d=a,e=h)});return d};g.min=
function(a,b,c){var d=Infinity,e=Infinity,f,h;if(!b&&g.isArray(a))for(var j=0,m=a.length;j<m;j++)f=a[j],f<d&&(d=f);else g.each(a,function(a,k,f){h=b?b.call(c,a,k,f):a;h<e&&(d=a,e=h)});return d};g.shuffle=function(a){var b,c=0,d=[];g.each(a,function(a){b=g.random(c++);d[c-1]=d[b];d[b]=a});return d};g.sample=function(a,b,c){return null==b||c?(a.length!==+a.length&&(a=g.values(a)),a[g.random(a.length-1)]):g.shuffle(a).slice(0,Math.max(0,b))};var u=function(a,b){return null==a?g.identity:!g.isFunction(a)?
g.property(a):!b?a:function(){return a.apply(b,arguments)}};g.sortBy=function(a,b,c){b=u(b,c);return g.pluck(g.map(a,function(a,c,d){return{value:a,index:c,criteria:b(a,c,d)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")};var K=function(a){return function(b,c,d){var e={},c=u(c,d);g.each(b,function(d,f){var g=c(d,f,b);a(e,g,d)});return e}};g.groupBy=K(function(a,b,c){g.has(a,b)?a[b].push(c):a[b]=
[c]});g.indexBy=K(function(a,b,c){a[b]=c});g.countBy=K(function(a,b){g.has(a,b)?a[b]++:a[b]=1});g.sortedIndex=function(a,b,c,d){for(var c=u(c,d),b=c(b),d=0,e=a.length;d<e;){var f=d+e>>>1;c(a[f])<b?d=f+1:e=f}return d};g.toArray=function(a){return!a?[]:g.isArray(a)?h.call(a):a.length===+a.length?g.map(a,g.identity):g.values(a)};g.size=function(a){return null==a?0:a.length===+a.length?a.length:g.keys(a).length};g.first=g.head=g.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:0>b?[]:h.call(a,
0,b)};g.initial=function(a,b,c){return h.call(a,0,Math.max(0,a.length-(null==b||c?1:b)))};g.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:h.call(a,Math.max(a.length-b,0))};g.rest=g.tail=g.drop=function(a,b,c){return h.call(a,null==b||c?1:b)};g.compact=function(a){return g.filter(a,g.identity)};var y=function(a,b,c,d){if(b&&g.every(a,g.isArray))return j.apply(d,a);for(var e=0,h=a.length;e<h;e++){var m=a[e];!g.isArray(m)&&!g.isArguments(m)?c||d.push(m):b?f.apply(d,m):y(m,b,c,d)}return d};
g.flatten=function(a,b){return y(a,b,!1,[])};g.without=function(a){return g.difference(a,h.call(arguments,1))};g.partition=function(a,b,c){var b=u(b,c),d=[],e=[];g.each(a,function(a){(b(a)?d:e).push(a)});return[d,e]};g.uniq=g.unique=function(a,b,c,d){if(null==a)return[];g.isFunction(b)&&(d=c,c=b,b=!1);for(var e=[],f=[],h=0,j=a.length;h<j;h++){var m=a[h];c&&(m=c.call(d,m,h,a));if(b?!h||f!==m:!g.contains(f,m))b?f=m:f.push(m),e.push(a[h])}return e};g.union=function(){return g.uniq(y(arguments,!0,!0,
[]))};g.intersection=function(a){if(null==a)return[];for(var b=[],c=arguments.length,d=0,e=a.length;d<e;d++){var f=a[d];if(!g.contains(b,f)){for(var h=1;h<c&&g.contains(arguments[h],f);h++);h===c&&b.push(f)}}return b};g.difference=function(a){var b=y(h.call(arguments,1),!0,!0,[]);return g.filter(a,function(a){return!g.contains(b,a)})};g.zip=function(){for(var a=g.max(g.pluck(arguments,"length").concat(0)),b=Array(a),c=0;c<a;c++)b[c]=g.pluck(arguments,""+c);return b};g.object=function(a,b){if(null==
a)return{};for(var c={},d=0,e=a.length;d<e;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};g.indexOf=function(a,b,c){if(null==a)return-1;var d=0,e=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,e+c):c;else return d=g.sortedIndex(a,b),a[d]===b?d:-1;for(;d<e;d++)if(a[d]===b)return d;return-1};g.lastIndexOf=function(a,b,c){if(null==a)return-1;for(c=null==c?a.length:c;c--;)if(a[c]===b)return c;return-1};g.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);for(var c=arguments[2]||1,d=Math.max(Math.ceil((b-
a)/c),0),e=0,f=Array(d);e<d;)f[e++]=a,a+=c;return f};var v=function(){};g.bind=function(a,b){var c,d;if(s&&a.bind===s)return s.apply(a,h.call(arguments,1));if(!g.isFunction(a))throw new TypeError;c=h.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(b,c.concat(h.call(arguments)));v.prototype=a.prototype;var e=new v;v.prototype=null;var f=a.apply(e,c.concat(h.call(arguments)));return Object(f)===f?f:e}};g.partial=function(a){var b=h.call(arguments,1);return function(){for(var c=
0,d=b.slice(),e=0,f=d.length;e<f;e++)d[e]===g&&(d[e]=arguments[c++]);for(;c<arguments.length;)d.push(arguments[c++]);return a.apply(this,d)}};g.bindAll=function(a){var b=h.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");g.each(b,function(b){a[b]=g.bind(a[b],a)});return a};g.memoize=function(a,b){var c={};b||(b=g.identity);return function(){var d=b.apply(this,arguments);return g.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};g.delay=function(a,b){var c=h.call(arguments,
2);return setTimeout(function(){return a.apply(null,c)},b)};g.defer=function(a){return g.delay.apply(g,[a,1].concat(h.call(arguments,1)))};g.throttle=function(a,b,c){var d,e,f,h=null,j=0;c||(c={});var m=function(){j=!1===c.leading?0:g.now();h=null;f=a.apply(d,e);d=e=null};return function(){var v=g.now();!j&&!1===c.leading&&(j=v);var z=b-(v-j);d=this;e=arguments;0>=z||z>b?(clearTimeout(h),h=null,j=v,f=a.apply(d,e),d=e=null):!h&&!1!==c.trailing&&(h=setTimeout(m,z));return f}};g.debounce=function(a,
b,c){var d,e,f,h,j,m=function(){var v=g.now()-h;v<b&&0<v?d=setTimeout(m,b-v):(d=null,c||(j=a.apply(f,e),f=e=null))};return function(){f=this;e=arguments;h=g.now();var v=c&&!d;d||(d=setTimeout(m,b));v&&(j=a.apply(f,e),f=e=null);return j}};g.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};g.wrap=function(a,b){return g.partial(b,a)};g.negate=function(a){return function(){return!a.apply(this,arguments)}};g.compose=function(){var a=arguments;
return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};g.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};g.keys=function(a){if(!g.isObject(a))return[];if(t)return t(a);var b=[],c;for(c in a)g.has(a,c)&&b.push(c);return b};g.values=function(a){for(var b=g.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=a[b[e]];return d};g.pairs=function(a){for(var b=g.keys(a),c=b.length,d=Array(c),e=0;e<c;e++)d[e]=[b[e],a[b[e]]];return d};g.invert=
function(a){for(var b={},c=g.keys(a),d=0,e=c.length;d<e;d++)b[a[c[d]]]=c[d];return b};g.functions=g.methods=function(a){var b=[],c;for(c in a)g.isFunction(a[c])&&b.push(c);return b.sort()};g.extend=function(a){g.each(h.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};g.pick=function(a,b,c){var d={};if(g.isFunction(b))for(var e in a){var f=a[e];b.call(c,f,e,a)&&(d[e]=f)}else for(var f=j.apply([],h.call(arguments,1)),m=0,v=f.length;m<v;m++)e=f[m],e in a&&(d[e]=a[e]);return d};
g.omit=function(a,b,c){var d;g.isFunction(b)?b=g.negate(b):(d=g.map(j.apply([],h.call(arguments,1)),String),b=function(a,b){return!g.contains(d,b)});return g.pick(a,b,c)};g.defaults=function(a){g.each(h.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])});return a};g.clone=function(a){return!g.isObject(a)?a:g.isArray(a)?a.slice():g.extend({},a)};g.tap=function(a,b){b(a);return a};var m=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof
g&&(a=a._wrapped);b instanceof g&&(b=b._wrapped);var e=l.call(a);if(e!=l.call(b))return!1;switch(e){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var f=a.constructor,
h=b.constructor;if(f!==h&&(!g.isFunction(f)||!(f instanceof f&&g.isFunction(h)&&h instanceof h))&&"constructor"in a&&"constructor"in b)return!1;c.push(a);d.push(b);f=0;h=!0;if("[object Array]"==e){if(f=a.length,h=f==b.length)for(;f--&&(h=m(a[f],b[f],c,d)););}else{for(var j in a)if(g.has(a,j)&&(f++,!(h=g.has(b,j)&&m(a[j],b[j],c,d))))break;if(h){for(j in b)if(g.has(b,j)&&!f--)break;h=!f}}c.pop();d.pop();return h};g.isEqual=function(a,b){return m(a,b,[],[])};g.isEmpty=function(a){if(null==a)return!0;
if(g.isArray(a)||g.isString(a)||g.isArguments(a))return 0===a.length;for(var b in a)if(g.has(a,b))return!1;return!0};g.isElement=function(a){return!!(a&&1===a.nodeType)};g.isArray=e||function(a){return"[object Array]"==l.call(a)};g.isObject=function(a){return a===Object(a)};g.each("Arguments Function String Number Date RegExp".split(" "),function(a){g["is"+a]=function(b){return l.call(b)=="[object "+a+"]"}});g.isArguments(arguments)||(g.isArguments=function(a){return!(!a||!g.has(a,"callee"))});"function"!==
typeof/./&&(g.isFunction=function(a){return"function"===typeof a});g.isFinite=function(a){return isFinite(a)&&!isNaN(parseFloat(a))};g.isNaN=function(a){return g.isNumber(a)&&a!=+a};g.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==l.call(a)};g.isNull=function(a){return null===a};g.isUndefined=function(a){return void 0===a};g.has=function(a,b){return p.call(a,b)};g.noConflict=function(){a._=b;return this};g.identity=function(a){return a};g.constant=function(a){return function(){return a}};
g.noop=function(){};g.property=function(a){return function(b){return b[a]}};g.matches=function(a){return function(b){if(null==b)return g.isEmpty(a);if(b===a)return!0;for(var c in a)if(a[c]!==b[c])return!1;return!0}};g.times=function(a,b,c){for(var d=Array(Math.max(0,a)),e=0;e<a;e++)d[e]=b.call(c,e);return d};g.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};g.now=Date.now||function(){return(new Date).getTime()};var z={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;",
"'":"&#x27;"}};z.unescape=g.invert(z.escape);var C={escape:RegExp("["+g.keys(z.escape).join("")+"]","g"),unescape:RegExp("("+g.keys(z.unescape).join("|")+")","g")};g.each(["escape","unescape"],function(a){g[a]=function(b){return null==b?"":(""+b).replace(C[a],function(b){return z[a][b]})}});g.result=function(a,b){if(null!=a){var c=a[b];return g.isFunction(c)?a[b]():c}};g.mixin=function(a){g.each(g.functions(a),function(b){var c=g[b]=a[b];g.prototype[b]=function(){var a=[this._wrapped];f.apply(a,arguments);
a=c.apply(g,a);return this._chain?g(a).chain():a}})};var Y=0;g.uniqueId=function(a){var b=++Y+"";return a?a+b:b};g.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var la=/(.)^/,Z={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},db=/\\|'|\r|\n|\u2028|\u2029/g,A=function(a){return"\\"+Z[a]};g.template=function(a,b,c){var c=g.defaults({},c,g.templateSettings),d=RegExp([(c.escape||la).source,(c.interpolate||la).source,(c.evaluate||
la).source].join("|")+"|$","g"),e=0,f="__p+='";a.replace(d,function(b,c,d,g,h){f+=a.slice(e,h).replace(db,A);e=h+b.length;c?f+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'":d?f+="'+\n((__t=("+d+"))==null?'':__t)+\n'":g&&(f+="';\n"+g+"\n__p+='");return b});f+="';\n";c.variable||(f="with(obj||{}){\n"+f+"}\n");f="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+f+"return __p;\n";try{var h=new Function(c.variable||"obj","_",f)}catch(j){throw j.source=f,j;}if(b)return h(b,
g);b=function(a){return h.call(this,a,g)};b.source="function("+(c.variable||"obj")+"){\n"+f+"}";return b};g.chain=function(a){return g(a).chain()};g.mixin(g);g.each("pop push reverse shift sort splice unshift".split(" "),function(a){var b=d[a];g.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);("shift"==a||"splice"==a)&&0===c.length&&delete c[0];return this._chain?g(c).chain():c}});g.each(["concat","join","slice"],function(a){var b=d[a];g.prototype[a]=function(){var a=b.apply(this._wrapped,
arguments);return this._chain?g(a).chain():a}});g.extend(g.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}});"function"===typeof define&&define.amd&&define("underscore",[],function(){return g})}).call(this);(function(){function a(a){var b=!1;return function(){if(b)throw Error("Callback was already called.");b=!0;a.apply(c,arguments)}}var b={},c,d;c=this;null!=c&&(d=c.async);b.noConflict=function(){c.async=d;return b};var e=Object.prototype.toString,f=
Array.isArray||function(a){return"[object Array]"===e.call(a)},h=function(a,b){if(a.forEach)return a.forEach(b);for(var c=0;c<a.length;c+=1)b(a[c],c,a)},j=function(a,b){if(a.map)return a.map(b);var c=[];h(a,function(a,d,e){c.push(b(a,d,e))});return c},l=function(a){if(Object.keys)return Object.keys(a);var b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push(c);return b};"undefined"===typeof process||!process.nextTick?(b.nextTick="function"===typeof setImmediate?function(a){setImmediate(a)}:function(a){setTimeout(a,
0)},b.setImmediate=b.nextTick):(b.nextTick=process.nextTick,b.setImmediate="undefined"!==typeof setImmediate?function(a){setImmediate(a)}:b.nextTick);b.each=function(b,c,d){function e(a){a?(d(a),d=function(){}):(f+=1,f>=b.length&&d())}d=d||function(){};if(!b.length)return d();var f=0;h(b,function(b){c(b,a(e))})};b.forEach=b.each;b.eachSeries=function(a,b,c){c=c||function(){};if(!a.length)return c();var d=0,e=function(){b(a[d],function(b){b?(c(b),c=function(){}):(d+=1,d>=a.length?c():e())})};e()};
b.forEachSeries=b.eachSeries;b.eachLimit=function(a,b,c,d){p(b).apply(null,[a,c,d])};b.forEachLimit=b.eachLimit;var p=function(a){return function(b,c,d){d=d||function(){};if(!b.length||0>=a)return d();var e=0,f=0,g=0;(function Dc(){if(e>=b.length)return d();for(;g<a&&f<b.length;)f+=1,g+=1,c(b[f-1],function(a){a?(d(a),d=function(){}):(e+=1,g-=1,e>=b.length?d():Dc())})})()}},t=function(a){return function(){var c=Array.prototype.slice.call(arguments);return a.apply(null,[b.each].concat(c))}},s=function(a,
b){return function(){var c=Array.prototype.slice.call(arguments);return b.apply(null,[p(a)].concat(c))}},g=function(a){return function(){var c=Array.prototype.slice.call(arguments);return a.apply(null,[b.eachSeries].concat(c))}},u=function(a,b,c,d){var e=[],b=j(b,function(a,b){return{index:b,value:a}});a(b,function(a,b){c(a.value,function(c,d){e[a.index]=d;b(c)})},function(a){d(a,e)})};b.map=t(u);b.mapSeries=g(u);b.mapLimit=function(a,b,c,d){return s(b,u)(a,c,d)};b.reduce=function(a,c,d,e){b.eachSeries(a,
function(a,b){d(c,a,function(a,d){c=d;b(a)})},function(a){e(a,c)})};b.inject=b.reduce;b.foldl=b.reduce;b.reduceRight=function(a,c,d,e){a=j(a,function(a){return a}).reverse();b.reduce(a,c,d,e)};b.foldr=b.reduceRight;var K=function(a,b,c,d){var e=[],b=j(b,function(a,b){return{index:b,value:a}});a(b,function(a,b){c(a.value,function(c){c&&e.push(a);b()})},function(){d(j(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};b.filter=t(K);b.filterSeries=g(K);b.select=b.filter;b.selectSeries=
b.filterSeries;K=function(a,b,c,d){var e=[],b=j(b,function(a,b){return{index:b,value:a}});a(b,function(a,b){c(a.value,function(c){c||e.push(a);b()})},function(){d(j(e.sort(function(a,b){return a.index-b.index}),function(a){return a.value}))})};b.reject=t(K);b.rejectSeries=g(K);K=function(a,b,c,d){a(b,function(a,b){c(a,function(c){c?(d(a),d=function(){}):b()})},function(){d()})};b.detect=t(K);b.detectSeries=g(K);b.some=function(a,c,d){b.each(a,function(a,b){c(a,function(a){a&&(d(!0),d=function(){});
b()})},function(){d(!1)})};b.any=b.some;b.every=function(a,c,d){b.each(a,function(a,b){c(a,function(a){a||(d(!1),d=function(){});b()})},function(){d(!0)})};b.all=b.every;b.sortBy=function(a,c,d){b.map(a,function(a,b){c(a,function(c,d){c?b(c):b(null,{value:a,criteria:d})})},function(a,b){if(a)return d(a);d(null,j(b.sort(function(a,b){var c=a.criteria,d=b.criteria;return c<d?-1:c>d?1:0}),function(a){return a.value}))})};b.auto=function(a,c){var c=c||function(){},d=l(a),e=d.length;if(!e)return c();var g=
{},j=[],t=function(){e--;h(j.slice(0),function(a){a()})};j.unshift(function(){if(!e){var a=c;c=function(){};a(null,g)}});h(d,function(d){var e=f(a[d])?a[d]:[a[d]],k=function(a){var e=Array.prototype.slice.call(arguments,1);1>=e.length&&(e=e[0]);if(a){var f={};h(l(g),function(a){f[a]=g[a]});f[d]=e;c(a,f);c=function(){}}else g[d]=e,b.setImmediate(t)},z=e.slice(0,Math.abs(e.length-1))||[],n=function(){var a;var b=function(a,b){return a&&g.hasOwnProperty(b)},c=!0;z.reduce?a=z.reduce(b,c):(h(z,function(a,
d,e){c=b(c,a,d,e)}),a=c);return a&&!g.hasOwnProperty(d)};if(n())e[e.length-1](k,g);else{var C=function(){if(n()){a:for(var a=C,b=0;b<j.length;b+=1)if(j[b]===a){j.splice(b,1);break a}e[e.length-1](k,g)}};j.unshift(C)}})};b.retry=function(a,c,d){var e=[];"function"===typeof a&&(d=c,c=a,a=5);var a=parseInt(a,10)||5,f=function(f,g){for(var h=function(a,b){return function(c){a(function(a,d){c(!a||b,{err:a,result:d})},g)}};a;)e.push(h(c,!(a-=1)));b.series(e,function(a,b){b=b[b.length-1];(f||d)(b.err,b.result)})};
return d?f():f};b.waterfall=function(a,c){c=c||function(){};if(!f(a))return c(Error("First argument to waterfall must be an array of functions"));if(!a.length)return c();var d=function(a){return function(e){if(e)c.apply(null,arguments),c=function(){};else{var f=Array.prototype.slice.call(arguments,1),g=a.next();g?f.push(d(g)):f.push(c);b.setImmediate(function(){a.apply(null,f)})}}};d(b.iterator(a))()};var y=function(a,b,c){c=c||function(){};if(f(b))a.map(b,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,
1);1>=c.length&&(c=c[0]);b.call(null,a,c)})},c);else{var d={};a.each(l(b),function(a,c){b[a](function(b){var e=Array.prototype.slice.call(arguments,1);1>=e.length&&(e=e[0]);d[a]=e;c(b)})},function(a){c(a,d)})}};b.parallel=function(a,c){y({map:b.map,each:b.each},a,c)};b.parallelLimit=function(a,b,c){y({map:s(b,u),each:p(b)},a,c)};b.series=function(a,c){c=c||function(){};if(f(a))b.mapSeries(a,function(a,b){a&&a(function(a){var c=Array.prototype.slice.call(arguments,1);1>=c.length&&(c=c[0]);b.call(null,
a,c)})},c);else{var d={};b.eachSeries(l(a),function(b,c){a[b](function(a){var e=Array.prototype.slice.call(arguments,1);1>=e.length&&(e=e[0]);d[b]=e;c(a)})},function(a){c(a,d)})}};b.iterator=function(a){var b=function(c){var d=function(){a.length&&a[c].apply(null,arguments);return d.next()};d.next=function(){return c<a.length-1?b(c+1):null};return d};return b(0)};b.apply=function(a){var b=Array.prototype.slice.call(arguments,1);return function(){return a.apply(null,b.concat(Array.prototype.slice.call(arguments)))}};
K=function(a,b,c,d){var e=[];a(b,function(a,b){c(a,function(a,c){e=e.concat(c||[]);b(a)})},function(a){d(a,e)})};b.concat=t(K);b.concatSeries=g(K);b.whilst=function(a,c,d){a()?c(function(e){if(e)return d(e);b.whilst(a,c,d)}):d()};b.doWhilst=function(a,c,d){a(function(e){if(e)return d(e);var f=Array.prototype.slice.call(arguments,1);c.apply(null,f)?b.doWhilst(a,c,d):d()})};b.until=function(a,c,d){a()?d():c(function(e){if(e)return d(e);b.until(a,c,d)})};b.doUntil=function(a,c,d){a(function(e){if(e)return d(e);
var f=Array.prototype.slice.call(arguments,1);c.apply(null,f)?d():b.doUntil(a,c,d)})};b.queue=function(c,d){function e(a,c,d,g){a.started||(a.started=!0);f(c)||(c=[c]);if(0==c.length)return b.setImmediate(function(){a.drain&&a.drain()});h(c,function(c){c={data:c,callback:"function"===typeof g?g:null};d?a.tasks.unshift(c):a.tasks.push(c);a.saturated&&a.tasks.length===a.concurrency&&a.saturated();b.setImmediate(a.process)})}d===aa&&(d=1);var g=0,j={tasks:[],concurrency:d,saturated:null,empty:null,drain:null,
started:!1,paused:!1,push:function(a,b){e(j,a,!1,b)},kill:function(){j.drain=null;j.tasks=[]},unshift:function(a,b){e(j,a,!0,b)},process:function(){if(!j.paused&&g<j.concurrency&&j.tasks.length){var b=j.tasks.shift();j.empty&&0===j.tasks.length&&j.empty();g+=1;var d=a(function(){g-=1;b.callback&&b.callback.apply(b,arguments);j.drain&&0===j.tasks.length+g&&j.drain();j.process()});c(b.data,d)}},length:function(){return j.tasks.length},running:function(){return g},idle:function(){return 0===j.tasks.length+
g},pause:function(){!0!==j.paused&&(j.paused=!0,j.process())},resume:function(){!1!==j.paused&&(j.paused=!1,j.process())}};return j};b.cargo=function(a,c){var d=!1,e=[],g={tasks:e,payload:c,saturated:null,empty:null,drain:null,drained:!0,push:function(a,d){f(a)||(a=[a]);h(a,function(a){e.push({data:a,callback:"function"===typeof d?d:null});g.drained=!1;g.saturated&&e.length===c&&g.saturated()});b.setImmediate(g.process)},process:function Z(){if(!d)if(0===e.length)g.drain&&!g.drained&&g.drain(),g.drained=
!0;else{var b="number"===typeof c?e.splice(0,c):e.splice(0,e.length),f=j(b,function(a){return a.data});g.empty&&g.empty();d=!0;a(f,function(){d=!1;var a=arguments;h(b,function(b){b.callback&&b.callback.apply(null,a)});Z()})}},length:function(){return e.length},running:function(){return d}};return g};K=function(a){return function(b){var c=Array.prototype.slice.call(arguments,1);b.apply(null,c.concat([function(b){var c=Array.prototype.slice.call(arguments,1);"undefined"!==typeof console&&(b?console.error&&
console.error(b):console[a]&&h(c,function(b){console[a](b)}))}]))}};b.log=K("log");b.dir=K("dir");b.memoize=function(a,c){var d={},e={},c=c||function(a){return a},f=function(){var f=Array.prototype.slice.call(arguments),g=f.pop(),h=c.apply(null,f);h in d?b.nextTick(function(){g.apply(null,d[h])}):h in e?e[h].push(g):(e[h]=[g],a.apply(null,f.concat([function(){d[h]=arguments;var a=e[h];delete e[h];for(var b=0,c=a.length;b<c;b++)a[b].apply(null,arguments)}])))};f.memo=d;f.unmemoized=a;return f};b.unmemoize=
function(a){return function(){return(a.unmemoized||a).apply(null,arguments)}};b.times=function(a,c,d){for(var e=[],f=0;f<a;f++)e.push(f);return b.map(e,c,d)};b.timesSeries=function(a,c,d){for(var e=[],f=0;f<a;f++)e.push(f);return b.mapSeries(e,c,d)};b.seq=function(){var a=arguments;return function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();b.reduce(a,d,function(a,b,d){b.apply(c,a.concat([function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);d(a,b)}]))},function(a,
b){e.apply(c,[a].concat(b))})}};b.compose=function(){return b.seq.apply(null,Array.prototype.reverse.call(arguments))};K=function(a,b){var c=function(){var c=this,d=Array.prototype.slice.call(arguments),e=d.pop();return a(b,function(a,b){a.apply(c,d.concat([b]))},e)};if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return c.apply(this,d)}return c};b.applyEach=t(K);b.applyEachSeries=g(K);b.forever=function(a,b){function c(d){if(d){if(b)return b(d);throw d;}a(c)}c()};"undefined"!==
typeof module&&module.exports?module.exports=b:"undefined"!==typeof define&&define.amd?define([],function(){return b}):c.async=b})();var Ga=B,gb=Ga._;Ga.EventBase=function(){this.handlers={}};gb.extend(Ga.EventBase.prototype,{constructor:Ga.EventBase,on:function(a,b){gb.isUndefined(this.handlers[a])&&(this.handlers[a]=[]);this.handlers[a].push(b)},fire:function(a){a.target||(a.target=this);if(gb.isArray(this.handlers[a.type]))for(var b=this.handlers[a.type],c=0,d=b.length;c<d;c++)b[c](a)},un:function(a,
b){if(gb.isArray(this.handlers[a])){for(var c=this.handlers[a],d=0,e=c.length;d<e&&c[d]!==b;d++);c.splice(d,1)}}});Ga.PageEvent=new Ga.EventBase;B||(B={});var ia=B;ia.PageCache=function(a,b,c){return c?new ia.PageCache.async(a,b):new ia.PageCache.sync(a,b)};ia.PageCache.sync=function(a,b){0!=arguments.length&&(this.page_no=-1,this.pager_total_entries=this.pager_total_pages=void 0,this.cache=[],"function"==typeof a?(this.generator=a,this.generator_finished=!1):(this.pager=a.get,this.pager_page_size=
a.PageSize),this.page_size=b.PageSize)};ia.PageCache.sync.prototype={next:function(){var a=[];this.hasNext()&&(this.page_no++,a=this.get(this.page_no+1).Entries,0==a.length&&this.page_no--);return a},previous:function(){var a=[];this.hasPrevious()&&(this.page_no--,a=this.get(this.page_no+1).Entries);return a},hasNext:function(){var a=this.getTotalPages();return isNaN(a)?!0:this.page_no+1<a},hasPrevious:function(){return 0<this.page_no},getTotalPages:function(){var a;if(this.pager){if("undefined"==
typeof this.pager_total_pages)return NaN;a="undefined"==typeof this.pager_total_entries?"undefined"!=typeof this.cache[this.pager_total_pages-1]?(this.pager_total_pages-1)*this.pager_page_size+this.cache[this.pager_total_pages-1].Entries.length:this.pager_total_pages*this.pager_page_size:this.pager_total_entries}else if(this.generator_finished)a=this.cache.length;else return NaN;return Math.ceil(a/this.page_size)},get:function(a){a=parseInt(a);if(isNaN(a)||1>a)a=1;var b=[],c=(a-1)*this.page_size,
a=a*this.page_size;if(this.pager){for(var d=Math.floor(c/this.pager_page_size),e=Math.ceil(a/this.pager_page_size),f=d;f<e;f++){"undefined"==typeof this.cache[f]&&(this.cache[f]=this.pager(f+1));var h=this.pager_page_size*f;b.push.apply(b,this.cache[f].Entries.slice(h>=c?0:c-h,h+this.pager_page_size>a?a-h:this.pager_page_size));"undefined"==typeof this.pager_total_pages&&(this.pager_total_pages=this.cache[f].TotalPages);e=Math.min(e,this.pager_total_pages)}"undefined"!=typeof this.cache[d]&&this.cache[d].TotalEntries&&
(this.pager_total_entries=this.cache[d].TotalEntries)}else{for(;!this.generator_finished&&this.cache.length<a;)b=this.generator(),0==b.length&&(this.generator_finished=!0),this.cache.push.apply(this.cache,b);b=this.cache.slice(c,a)}return{TotalPages:this.getTotalPages(),Entries:b}},reset:function(){this.page_no=-1}};ia.PageCache.async=function(a,b){ia.PageCache.sync.call(this,a,b)};ia.PageCache.async.prototype=new ia.PageCache.sync;ia.PageCache.async.prototype.constructor=ia.PageCache.async;ia.PageCache.async.prototype.next=
function(a){if(this.hasNext()){this.page_no++;var b=this;this.get(this.page_no+1,function(c){c=c.Entries;0==c.length&&b.page_no--;a(c)})}else a([])};ia.PageCache.async.prototype.previous=function(a){this.hasPrevious()?(this.page_no--,this.get(this.page_no+1,function(b){a(b.Entries)})):a([])};ia.PageCache.async.prototype.get=function(a,b){var c=this,a=parseInt(a);if(isNaN(a)||1>a)a=1;var d=(a-1)*this.page_size,e=a*this.page_size,f=[],h=function(){b({TotalPages:c.getTotalPages(),Entries:f},a)};if(this.pager){var j=
Math.floor(d/this.pager_page_size),l=Math.ceil(e/this.pager_page_size),p=function(a,b){if(a>=l)"undefined"!=typeof c.cache[j]&&c.cache[j].TotalEntries&&(c.pager_total_entries=c.cache[j].TotalEntries),h();else{var f=function(a,f){a-=1;c.cache[a]=f;var h=c.pager_page_size*a;b.push.apply(b,c.cache[a].Entries.slice(h>=d?0:d-h,h+c.pager_page_size>e?e-h:c.pager_page_size));"undefined"==typeof c.pager_total_pages&&(c.pager_total_pages=c.cache[a].TotalPages);l=Math.min(l,c.pager_total_pages);p(a+1,b)};"undefined"==
typeof c.cache[a]?c.pager(a+1,f):f(a+1,c.cache[a])}};p(j,f)}else if(!this.generator_finished&&this.cache.length<e){var t=function(a){a&&0==a.length&&(c.generator_finished=!0);c.cache.push.apply(c.cache,a);!c.generator_finished&&c.cache.length<e?c.generator(t):(f=c.cache.slice(d,e),h())};this.generator(t)}else f=c.cache.slice(d,e),h()};var fa=B;fa.filterChain=function(){this.index=-1;this.chain=0<arguments.length?arguments:[]};fa.filterChain.prototype.register=function(a){this.chain.push(a)};fa.filterChain.prototype.run=
function(){this.index++;this.index<this.chain.length&&this.chain[this.index].run(this)};fa.i18n={locale:"en",messages:{zh:{see_detail:"\u8be6\u60c5",no_results:"\u62b1\u6b49\uff01\u6ca1\u6709\u627e\u5230\u76f8\u5173\u7684\u5546\u54c1",hide:"\u9690\u85cf",show:"\u663e\u793a",feedback:"\u53cd\u9988",shoppingassist:"\u5982\u610f\u6dd8",settings:"\u9009\u9879",feedback_url:"http://ruyi.taobao.com/feedback",choose_at_least_one:"\u8bf7\u81f3\u5c11\u9009\u4e2d\u4e00\u4e2a\u641c\u7d22\u7f51\u7ad9",homepage:"\u5b98\u65b9\u7f51\u7ad9",
search:"\u641c\u7d22",search_engine_setting:"\u641c\u7d22\u5546\u57ce\u8bbe\u7f6e",search_engine_setting_title:"\u641c\u7d22\u5546\u57ce",search_engine_setting_commit:"\u5b8c\u6210",no_products:"\u62b1\u6b49\uff01\u6ca1\u6709\u627e\u5230\u76f8\u5173\u7684\u5546\u54c1",search_engine_setting_msg:"\u8bf7\u81f3\u5c11\u9009\u62e9\u4e00\u4e2a\u5546\u57ce\u3002",search_product_in:'\u5728${1}\u641c\u7d22"${2}"',click_to_hide:"\u70b9\u51fb\u9690\u85cf\u641c\u7d22\u7ed3\u679c",expand:"\u5c55\u5f00",shrink:"\u6536\u8d77",
close:"\u5173\u95ed",hide_searchbox:"\u9690\u85cf\u641c\u7d22\u6846"},en:{see_detail:"See Detail",no_results:"sorry, no results",hide:"Hide",show:"Show",feedback:"Feedback",settings:"Options",shoppingassist:"Shopping Assistant",homepage:"Homepage",choose_at_least_one:"Please select at least one search site",feedback_url:"http://spreadsheets.google.com/viewform?hl=en&formkey=dFhZVkE5ZC1veFk4YzRfVnpDRGtkTWc6MQ",expand:"Expand",collapse:"Collapse",close:"Close",search:"Search",search_engine_setting:"Customize",
search_engine_setting_title:"Search On",search_engine_setting_commit:"OK",no_products:"Oops, no results",search_engine_setting_msg:"Please select at least one site.",search_product_in:'Search "${2}" at ${1}',click_to_hide:"Click to hide",shrink:"Shrink",hide_searchbox:"Hide searchbox"},fr:{see_detail:"Voir le d\u00e9tail",no_results:"D\u00e9sol\u00e9, aucun r\u00e9sultat",hide:"Hide",show:"Show",feedback:"Feedback",settings:"Options",shoppingassist:"Shopping Assistant",homepage:"Homepage",choose_at_least_one:"Merci de s\u00e9lectionner au moins un site de recherche",
feedback_url:"http://spreadsheets.google.com/viewform?hl=en&formkey=dFhZVkE5ZC1veFk4YzRfVnpDRGtkTWc6MQ",expand:"Expand",collapse:"Collapse",close:"Close",search:"Search",search_engine_setting:"Customize",search_engine_setting_title:"Search On",search_engine_setting_commit:"OK",no_products:"Oops, no results",search_engine_setting_msg:"Please select at least one site.",search_product_in:'Search "${2}" at ${1}',click_to_hide:"Click to hide",shrink:"Shrink",hide_searchbox:"Hide searchbox"},it:{see_detail:"Vedi dettagli",
no_results:"Spiacenti, nessun risultato",hide:"Hide",show:"Show",feedback:"Feedback",settings:"Opzioni",shoppingassist:"Shopping Assistant",homepage:"Homepage",choose_at_least_one:"Prego, selezionare almeno un sito di ricerca",feedback_url:"http://spreadsheets.google.com/viewform?hl=en&formkey=dFhZVkE5ZC1veFk4YzRfVnpDRGtkTWc6MQ",expand:"Expand",collapse:"Collapse",close:"Close",search:"Search",search_engine_setting:"Customize",search_engine_setting_title:"Search On",search_engine_setting_commit:"OK",
no_products:"Oops, no results",search_engine_setting_msg:"Please select at least one site.",search_product_in:'Search "${2}" at ${1}',click_to_hide:"Click to hide",shrink:"Shrink",hide_searchbox:"Hide searchbox"},de:{see_detail:"Details anschauen",no_results:"Entschuldigung, keine Suchergebnisse",hide:"Verstecken",show:"Zeigen",feedback:"Reaktion",settings:"Optionen",shoppingassist:"Shopping Assistant",homepage:"Startseite",choose_at_least_one:"Bitte w\u00e4hlen Sie mindestens eine Seite zum Durchsuchen aus",
feedback_url:"http://spreadsheets.google.com/viewform?hl=en&formkey=dFhZVkE5ZC1veFk4YzRfVnpDRGtkTWc6MQ",expand:"Erweitern",collapse:"Zusammenbruch",close:"in der N\u00e4he",search:"Search",search_engine_setting:"Customize",search_engine_setting_title:"Search On",search_engine_setting_commit:"OK",no_products:"Oops, no results",search_engine_setting_msg:"Please select at least one site.",search_product_in:'Search "${2}" at ${1}',click_to_hide:"Click to hide",shrink:"Shrink",hide_searchbox:"Hide searchbox"}},
setLocale:function(a){a in this.messages&&(this.locale=a)},getLocale:function(){return this.locale},getMessage:function(){var a=arguments,b=a[0],c="";b in this.messages[this.locale]&&(c=this.messages[this.locale][b],1<a.length&&(c=c.replace(/\$\{\d\}/g,function(b){b=b.substring(2,3);return a[b]})));return c}};fa.extend=function(a,b,c,d){if(!a||!b)return a;void 0===c&&(c=!0);var e,f,h;if(d&&(h=d.length))for(e=0;e<h;e++){if(f=d[e],f in b&&(c||!(f in a)))a[f]=b[f]}else for(f in b)if(c||!(f in a))a[f]=
b[f];return a};fa.debounce=function(a,b,c){var d;return function(){var e=this,f=arguments;d?clearTimeout(d):c&&a.apply(e,f);d=setTimeout(function(){c||a.apply(e,f);d=null},b||100)}};fa.str_repeat=function(a,b){for(var c=[];0<b;c[--b]=a);return c.join("")};fa.sprintf=function(){for(var a=0,b,c=arguments[a++],d=[],e,f,h;c;){if(e=/^[^\x25]+/.exec(c))d.push(e[0]);else if(e=/^\x25{2}/.exec(c))d.push("%");else if(e=/^\x25(?:(\d+)\$)?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(c)){if(null==(b=
arguments[e[1]||a++])||void 0==b)throw"Too few arguments.";if(/[^s]/.test(e[7])&&"number"!=typeof b)throw"Expecting number but found "+typeof b;switch(e[7]){case "b":b=b.toString(2);break;case "c":b=String.fromCharCode(b);break;case "d":b=parseInt(b);break;case "e":b=e[6]?b.toExponential(e[6]):b.toExponential();break;case "f":b=e[6]?parseFloat(b).toFixed(e[6]):parseFloat(b);break;case "o":b=b.toString(8);break;case "s":b=(b=String(b))&&e[6]?b.substring(0,e[6]):b;break;case "u":b=Math.abs(b);break;
case "x":b=b.toString(16);break;case "X":b=b.toString(16).toUpperCase()}b=/[def]/.test(e[7])&&e[2]&&0<=b?"+"+b:b;f=e[3]?"0"==e[3]?"0":e[3].charAt(1):" ";h=e[5]-String(b).length-0;f=e[5]?fa.str_repeat(f,h):"";d.push(""+(e[4]?b+f:f+b))}else throw"Huh ?!";c=c.substring(e[0].length)}return d.join("")};fa.format_price=function(a,b){if(0>=a)return"";var c="",c=fa.sprintf("%.2f",a/100);switch(b){case "us":c="$"+c;break;case "ca":c="CDN$"+c;break;case "fr":case "de":c="EUR "+c;break;case "uk":c="&#xA3;"+
c;break;default:c="$"+c}return c};fa.get_cookie=function(a){for(var b=document.cookie.split("; "),c=0,d;d=b[c]&&b[c].split("=");c++)if(d[0]===a)return d[1]||""};var tb={},Tb={},Ub=function(){var a=String.fromCharCode(Math.floor(25*Math.random()+97))+Math.floor(134217728*Math.random()).toString(36);if("undefined"!=typeof Tb[a])return Ub();Tb[a]=!0;return a};fa.transform_selector=function(a){return"undefined"!=typeof tb[a]?tb[a]:tb[a]=""+Ub()};fa.isNumeric=function(a){return!isNaN(parseFloat(a))&&isFinite(a)};
fa.checkAndRun=function(a){fa.browser.extension.sendRequest({topic:"page_signature"},function(b){document.body.getAttribute(b)||(document.body.setAttribute(b,1),a())})};var Vb=B,Wb=function(a,b){this.value=a;this.encoding="undefined"==typeof b?(document.charset||document.characterSet||"").toLowerCase():b};Wb.prototype={toString:function(){return this.value},containMultbyteChar:function(a){for(var b=0,c=a.length;b<c;b++)if(128<a.charCodeAt(0))return!0;return!1},getUnicode:function(a){if(this.value.match(/%u[0-9a-fA-F]{4}/)){var b=
this.value.replace(/%u([0-9a-fA-F]{4})/g,function(a,b){return String.fromCharCode(parseInt(b,16))});a(b)}else this.containMultbyteChar(this.value)?a(decodeURIComponent(this.value)):this.encoding.match(/(x-)?(cp936|gbk|gb2312|gb18030)/)?Vb.browser.extension.sendRequest({topic:"decode_gbk",data:this.value},a):a(this.value)}};Vb.site={SearchTerm:Wb,get_domain:function(a){return a.location&&a.location.hostname?a.location.hostname:""},get_domain_from_str:function(a){var b="undefined";0==a.toLowerCase().indexOf("http://")?
(b=a.substring(7),b="http://"+b.substring(0,b.indexOf("/"))):0==a.toLowerCase().indexOf("https://")&&(b=a.substring(8),b="https://"+b.substring(0,b.indexOf("/")));return b},get_url:function(a){return a.location&&a.location.href?a.location.href:a.title?a.title:""},get_site:function(a){var b="";if(a){var b=2,c=a.split(".");a.match(/\.(com|co|org|net)\.(cn|uk|jp|hk|us|ca)$/)&&(b+=1);b=c.length>=b?c.splice(c.length-b,c.length).join("."):a}return b},get_sub_domain:function(a,b){var c="";a&&(c=a.length>
b.length?a.substring(0,a.length-b.length-1):"DUMMY");return c},check_shopping_term:function(){var a=this.get_site(this.get_domain(document));if("google.com"==a||"google.cn"==a||"google.com.hk"==a||"google.co.uk"==a){if(a=decodeURIComponent(document.location.href),-1!=a.indexOf("/products")||-1!=a.indexOf("tbs=bks:1")||-1!=a.indexOf("tbs=shop:1")||-1!=a.indexOf("tbm=bks")||-1!=a.indexOf("tbm=shop"))return!0}else{if("bing.com"==a){if(-1!=document.location.href.indexOf("/shopping/"))return!0;var a=$("#sw_abarl").find("a"),
b=!1;$.each(a,function(a,d){-1!=$(d).attr("href").indexOf("/shopping/")&&(b=!0)});return b}return!0}},get_search_term:function(a,b){if(!this.check_shopping_term())return!1;var c="",d=this.get_domain(b),e=this.get_site(d),d=this.get_sub_domain(d,e);a[d]&&"undefined"==typeof a[d].e&&(c=this.extract_search_term(a[d],b));c&&"string"==typeof c&&(c=new this.SearchTerm(c));return c},extract_search_term:function(a,b){for(var c="",d=b.location.search||b.location.hash,e,f=0;f<a.length;f++){var h=a[f].k,j=a[f].d,
l=a[f].s,p=a[f].sk,t=a[f].charset;if(d){for(var d=d.slice(1),j=d.split(j),s=j.length,g,f=0;f<s;f++)g=j[f].split("="),h&&g[0]==h?c=g[1]:g[0]==t&&(e=g[1]);c&&(c=new this.SearchTerm(c,e))}!c&&l&&(c=this.find_search_term_from_document(b,l),p&&p==c&&(c=""));if(c)break}return c},find_search_term_from_query:function(a,b,c){for(var d="",a=a.split(c),b=RegExp("(?:^|\\?)"+b+'=([^#;\\?:@=&{}\\|\\\\^~\\[\\]`<>\\"]*)'),c=0;c<a.length;c++){var e=b.exec(a[c]);e&&(d=e[1])}d&&(d=d.replace(/\+/g," "));return d},find_search_term_from_document:function(a,
b){var c="",d=a.getElementById(b);if(d)c=d.value;else for(var d=a.getElementsByTagName("input"),e=0;e<d.length;e++)if(d[e].name==b){c=d[e].value;break}return c?new this.SearchTerm(c,"unicode"):c}};var Ra=B;Ra.SearchBox||(Ra.SearchBox={});var E=Ra.transform_selector;Ra.SearchBox.Tmpl={getSearchEngineSettingTemplate:function(a,b){var c=a.length,d=[],e;a.reverse();for(var f=0;f<c;f++)e=a[f],e='<li id="'+E("se-"+e.name)+'" class="'+E("merchant-item")+'" data-se-id="'+e.name+'">'+e.title+"</li>",d.push(e);
"zh"==b&&(e='<li id="'+E("se-etao")+'" class="'+E("merchant-item")+" "+E("merchant-selected")+'" data-se-id="etao">\u6240\u6709\u5546\u57ce</li>',d.push(e));return d.join("")},getSearchEnginesTemplate:function(a){for(var b=a.length,c=[],d,e=0;e<b;e++)d=a[e],c.push('<li id="'+E("se-"+d.name)+'" data-se-id="'+d.name+'" class="'+E("se")+'" data-se-name="'+d.title+'">'),c.push('<img src="'+d.icon+'" /></li>'),0==e&&c.push('<li class="'+E("separator-se")+" "+E("separator-small")+" "+E("ib")+'"></li>');
return c.join("")},getProductsTemplate:function(a){console.log(a);for(var b=a.length,c,d=Ra.SearchBox.Util.getURL("assets/images/loading.gif"),d='<span class="'+E("product-image-wrapper")+'"><img class="'+E("product-image")+'" src="'+d+'" /><b class="'+E("line-height-setter")+'"></b></span>',e,f=[],h=0;h<b;h++)c=a[h],e=c.preferredPrice,c='<li class="'+E("product-item")+'" data-click-url="'+(c.ClickUrl||c.click_url||c.DetailPageURL)+'">',"<img"!=e.substring(0,4)&&(e='<span class="'+E("product-price-wrapper")+
'">'+e+"</span>"),e='<div class="'+E("product-price")+'">'+e+"</div>",f.push(c+d+e+"</li>");return f.join("")},getProductDetailTemplate:function(a){var b=[],c=a.Title,d=a.productUsedPrice,e=a.productPrice,f=a.productFastTrack,h=a.productRatingStars,j=a.ClickUrl||a.click_url||a.DetailPageURL;b.push('<div id="'+E("product-title")+'">');b.push('<span id="'+E("product-page-link")+'" title="'+c+'" data-href="'+j+'">'+c+"</span>");b.push('</div><div id="'+E("product-price")+'">');b.push('<span id="'+E("product-used-price")+
'">'+d+"</span>");b.push('<span id="'+E("product-now-price")+'">'+e+"</span>");b.push('</div><div id="'+E("product-image")+'">');b.push('<img data-href="'+j+'" src="'+a.productImageUrl+'" />');b.push('<span class="'+E("line-height-setter")+'"></span></div>');b.push('<div id="'+E("product-fast-trick")+'">'+f+"</div>");b.push('<div id="'+E("product-rating-stars")+'">'+h+"</div>");b.push('<div id="'+E("ivy-wrapper-in-detail")+'">');b.push('<span id="'+E("buy-btn-in-detail")+'" data-href="'+j+'"></span>');
b.push('<span id="'+E("want-buy-btn-in-detail")+'" data-url="'+a.DetailPageURL+'"></span>');b.push('<div id="'+E("want-buy-count-info-in-detail")+'">\u5982\u610f\u6dd8\u7528\u6237\u4e2d\u6709123\u4eba\u60f3\u4e70</div></div>');return b.join("")},getMarketsTemplate:function(a,b,c){console.log(a);for(var c=c||"",d=[],e,f=!1,h,j=0,l=a.length;j<l;j++)h=a[j],0<j&&(!f&&h.BSeller!=e)&&(f=!0,d.push('<li class="'+E(c+"market-icon")+" "+E(c+"market-unimportant")+'"></li>')),e=h.BSeller,d.push(this.getMarketTemplate(h,
j,b,c));f&&d.unshift('<li class="'+E(c+"market-icon")+" "+E(c+"market-important")+'"></li>');return d.join("")},getMarketTemplate:function(a,b,c,d){var d=d||"",e=[],f="";b===c&&(f=" "+E(d+"current-merchant"));e.push('<li class="'+E(d+"market-item")+f+'" data-href="'+a.DetailUrl+'" >');e.push('<div class="'+E(d+"price")+'">'+a.Price+"</div>");0==b?e.push('<div class="'+E(d+"market-name")+" "+E(d+"market-name-hightlight")+'">'+a.ShopName+"</div>"):e.push('<div class="'+E(d+"market-name")+'">'+a.ShopName+
"</div>");e.push("</li>");return e.join("")},getLikeItemsTemplate:function(a){for(var b=[],c=a.length,d,e=0;e<c;e++)d=a[e],b.push('<li class="ruyitao-like-product-item" data-large-image-url="'+d.LargeImageUrl+'" data-title="'+d.Title+'">'),b.push('<a hideFocus="true" href="'+d.DetailPageURL+'" target="_blank" class="ruyitao-like-product-image ruyitao-log">'),b.push('<img class="ruyitao-small-image" src="'+d.SmallImageUrl+'" />'),b.push('<b class="ruyitao-line-height-setter"></b></a></li>');return b.join("")},
getPriceCurveTipTemplate:function(){var a=[];a.push('<div id="'+E("price-curve-tip")+'">');a.push('<div id="'+E("current-point-date")+'"></div>');a.push('<div id="'+E("current-point-price")+'"></div>');a.push('<div id="'+E("price-curve-arrow-down")+'"></div></div>');return a.join("")},getPriceInfoTemplate:function(a,b){return'\u6700\u9ad8\u4ef7\uff1a<span class="'+E("highest-price")+'">\uffe5'+b+'</span>\u6700\u4f4e\u4ef7\uff1a<span class="'+E("lowest-price")+'">\uffe5'+a+"</span>"},getTopTipContentTemplate:function(a,
b){var c="",d='<a class="'+E("check-out-more-merchants-in-tip")+'"target="_blank" href="${moreMerchantsLink}">\u67e5\u770b\u66f4\u591a\u5546\u5bb6</a>';"cheap"==a?c="\u672c\u7f51\u7ad9\u5728\u91cd\u70b9\u5546\u5bb6\u4e2d\u4ef7\u683c<strong>\u6700\u4f4e\uff01</strong>"+d:"expensive"==a&&(c='<strong>${relativeMerchantName}</strong>\u8981\u4fbf\u5b9c<strong>\uffe5${priceDiff}\u5143\uff01</strong><a target="_blank" href="${relativeMerchantLink}">\u53bb\u770b\u770b</a>'+d);if(c)for(var e in b)c=c.replace("${"+
e+"}",b[e]);return c}};var N=B,ub=window,qa=document;N.SearchBox||(N.SearchBox={});var Xb=N.transform_selector;N.SearchBox.Util={getClickUrl:function(a,b){N.browser.extension.sendRequest({topic:"construct_click_url",url:a},b)},getURL:function(a){return N.browser.extension.getURL(a)},getCurrentTab:function(a){N.browser.extension.sendRequest({topic:"get_current_tab"},a)},openTab:function(a,b,c){N.browser.extension.sendRequest({topic:"tab_open",url:a,selected:b||!1},c)},closeTab:function(a,b){N.browser.extension.sendRequest({topic:"close_tab",
tabId:a},b)},activeTab:function(a,b){N.browser.extension.sendRequest({topic:"active_tab",tabId:a},b)},appendTraceParameter:function(a,b){for(var c=b.split(/[?&]/),d=0,e=c.length;d<e;d++)0==c[d].indexOf("tb_lm_id=")&&(a=a.replace(/&tb_lm_id=[^&]*/,"").replace(/\?tb_lm_id=[^&]*&/,"?")+(-1==a.indexOf("?")?"?":"&")+c[d]);return a},sendLog:function(a,b){var c={topic:"send_log",action:a,referrer:document.referrer};"undefined"!=typeof b&&(c.label=b);N.browser.extension.sendRequest(c)},_imgCache:{},_imgCacheIndex:0,
sendImageLog:function(a){if(a){var b=this,c=new Image,d=this._imgCacheIndex++;this._imgCache[d]=c;c.onload=c.onerror=function(){delete b._imgCache[d]};c.src=a;c=null}},getViewPortWidth:function(){return"CSS1Compat"==qa.compatMode?qa.documentElement.clientWidth:qa.body.clientWidth},getViewPortHeight:function(){return"CSS1Compat"==qa.compatMode?qa.documentElement.clientHeight:qa.body.clientHeight},getOverlayWidth:function(){var a=this.getViewPortWidth();return Math.max(a,qa.body.scrollWidth)},getOverlayHeight:function(){var a=
this.getViewPortHeight();return Math.max(a,qa.body.scrollHeight)},getScrollPosition:function(){var a=$.browser.webkit,b=qa.body,c=qa.documentElement;return{top:a?b.scrollTop:c.scrollTop,left:a?b.scrollLeft:c.scrollLeft}},handleSogou:function(){/SE\s\d\.X\sMetaSr\s\d\.\d/g.test(ub.navigator.userAgent)&&$("#"+Xb("option-link")).hide()},replaceTemplateSelectors:function(a){return a.replace(/ruyitao-selector-prefix-([\w_-]+)/g,function(a,c){return N.transform_selector(c)})},getTemplate:function(a,b,c){var d=
this;N.browser.extension.sendRequest({topic:"get_template",page:a},function(a){"function"==typeof N.loadJQuery&&($=jQuery=N.loadJQuery());a=c?a:N.SearchBox.Util.replaceTemplateSelectors(a);d.sanitizeHTML(a,function(a){b(a)})})},sanitizeHTML:function(a,b){var c=a.replace(/<script\b[\s\S]*?<\/script\s*>/g,"").replace(/\bon[A-z]+\s*=\s*['"]?[^>"]+['"]?/g," ").replace(/href\s*=\s*['"]?\s*javascript:/g," ");b(c)},addEvent:function(a,b,c,d){a.addEventListener?a.addEventListener(b,c,d||!1):a.attachEvent&&
a.attachEvent("on"+b,c)},addThousandSeparator:function(a){if(!isNaN(+a)){var a=a+"",b=a.split(".")[0],a=a.split(".")[1];return b.replace(/(\d)(?=(?:\d{3})+\b)/g,"$1,")+(a?"."+a:"")}},ajax:function(a,b){a.topic="ajax";N.browser.extension.sendRequest(a,b)},mergeStyleSheets:function(){if(!$.browser.msie||!document.styleSheets)return!0;var a=document.styleSheets,b=document.getElementsByTagName("style"),c=document.getElementsByTagName("link");if(32>b.length+c.length||!a[0].cssText)return!0;for(var a=document.styleSheets[0],
b=$("."+Xb("stylesheet")),d=0;d<b.length;d++){c=b.get(d);try{a.cssText+=c.styleSheet.cssText,$(c).remove()}catch(e){return!1}}return!0},parseImagePrice:function(a,b){var c=a.attr("data-lazyload");c||(c=a.attr("src"));N.browser.extension.sendRequest({topic:"parse_image_price",domain:N.SearchBox.Util.getLocationProperty(ub,"hostname"),url:c},b)},loadJQuery:function(){},parsePriceString:function(a){if(a){var b=/\d+(?:\.\d+)?/.exec(a);b&&(a=b[0],a=parseFloat(a))}return a},getTopLevelDomain:function(a){a=
/[a-z0-9_-]+\.(?:com|net|org)/ig.exec(a);return!a?null:a[0].toLowerCase()},getSiteMetaInfo:function(a){a=this.getTopLevelDomain(a);return!a?null:this.siteMetaInfo[a]},siteMetaInfo:{"360buy.com":{name:"\u4eac\u4e1c"},"51buy.com":{name:"\u6613\u8fc5"},"suning.com":{name:"\u82cf\u5b81\u6613\u8d2d"}},randomAppend:function(a,b){$(a).append(b)},openFeedback:function(a,b){var c="http://ruyi.taobao.com/bug/item/"+a+"?ref="+(b||encodeURIComponent(N.SearchBox.Util.getLocationHref(ub)));N.SearchBox.Util.sendLog("click_compare",
c);N.SearchBox.Util.openTab(c,!0)},elemInArray:function(a,b){if("function"==typeof b.indexOf)return-1!=b.indexOf(a);for(var c=0,d=b.length;c<d;c++)if(b[c]===a)return!0;return!1},getLocation:function(a){a=a||window;return a.location||a.document.location},getLocationProperty:function(a,b){"string"===typeof a&&(b=a,a=void 0);return N.SearchBox.Util.getLocation(a)[b]},setFixed:function(a,b){var c,d;"iPad"==navigator.platform&&-1<navigator.userAgent.toLowerCase().search("cpu os 4")&&(c=b?1:0,c+=Number($(b?
a+" "+b:a).css("height").slice(0,-2)),d=window.innerHeight+window.pageYOffset-c,$(a).css("top",d),window.onscroll=function(){$(a).css("display","none");setTimeout(function(){d=window.innerHeight+window.pageYOffset-c;$(a).css("top",d);$(a).css("display","block")},100)})},getLocationHref:function(a){return N.SearchBox.Util.getLocationProperty(a,"href")},CATEGORY_TAGS:{"\u7535\u5b50":1,"\u7537":1,"\u5973":1,"\u513f\u7ae5":1,"\u8f66":1,"\u98df\u54c1":1,"\u6237\u5916":1,"\u5bb6\u5c45":1,"\u65f6\u5c1a":1,
"\u5a31\u4e50":1,"\u4e66":1},filterCategoryTags:function(a){if(!a||0==a.length)return[];for(var b=[],c=this.CATEGORY_TAGS,d=0,e=a.length;d<e;d++)c.hasOwnProperty(a[d])||b.push(a[d]);return b}};var Aa=B;Aa.SearchBox||(Aa.SearchBox={});var Yb=Aa.SearchBox,G=Aa.transform_selector;Yb.UI={visibleProductNum:null,init:function(){},activateControlIcon:function(a){$(a).addClass(""+G("active-control-icon"));$(a).hasClass(""+G("se"))&&this.updateSearchEngineTitle(a,!0)},inactivateControlIcon:function(a){$(a).removeClass(""+
G("active-control-icon"));$(a).hasClass(""+G("se"))&&this.updateSearchEngineTitle(a,!1)},isActiveControlIcon:function(a){return $(a).hasClass(""+G("active-control-icon"))},updateSearchEngineTitle:function(a,b){var c=$(a),d=c.attr("data-se-name"),e=Yb.App.getKeyword(),d=Aa.i18n.getMessage("search_product_in",d,e);b&&(d=Aa.i18n.getMessage("click_to_hide"));c.attr("title",d)},showOptionList:function(){$("#"+G("option-list-content")).show()},hideOptionList:function(){$("#"+G("option-list-content")).hide()},
showSearchBar:function(){$("#"+G("search-bar")).show();this.activateControlIcon($("#"+G("search-icon")))},hideSearchBar:function(){$("#"+G("search-bar")).hide();this.inactivateControlIcon($("#"+G("search-icon")))},focusSearch:function(){$("#"+G("search")).get(0).focus()},focusSearchBar:function(){$("#"+G("search-bar")).addClass(""+G("search-focus"))},blurSearchBar:function(){$("#"+G("search-bar")).removeClass(""+G("search-focus"))},searchBarStatus:function(){return $("#"+G("search-bar")).is(":visible")},
showSearchEngineSetting:function(){$("#"+G("search-engines-setting")).show();this.activateControlIcon($("#"+G("plus-btn")))},hideSearchEngineSetting:function(){$("#"+G("search-engines-setting")).hide();this.inactivateControlIcon($("#"+G("plus-btn")))},showSearchEngineSettingMsg:function(){$("#"+G("ses-msg")).show()},hideSearchEngineSettingMsg:function(){$("#"+G("ses-msg")).hide()},hideOtherPopups:function(a){$("."+G("popup")).filter('[id!="'+a+'"]').hide()},hidePopups:function(){this.hideOptionList();
this.hideSearchEngineSetting();var a=Aa.i18n.getMessage("search_engine_setting");$("#"+G("plus-btn")).attr("title",a)},showControlBar:function(){$.browser.msie&&9>parseInt($.browser.version)?$("#"+G("controller-bar")).css("filter",""):$("#"+G("controller-bar")).css("opacity",1)},enableSearchEngineHover:function(){$("#"+G("search-engines")).addClass(""+G("se-hover-enabled"))},disableSearchEngineHover:function(){$("#"+G("search-engines")).removeClass(""+G("se-hover-enabled"))}};var ra=B;ra.SearchBox||
(ra.SearchBox={});var vb=ra.SearchBox.Util,Zb=ra.SearchBox.Tmpl,Ha,$b,Sa,Ia=ra.transform_selector;ra.SearchBox.SearchEngines={init:function(){this.renderEnabledSearchEngines();this.registerEvents()},registerEvents:function(){var a=this;$("#"+Ia("submit-ses-btn")).click(function(b){b.preventDefault();a.submit()})},getAll:function(a){var b=this;ra.browser.extension.sendRequest({topic:"get_search_engines"},function(c){Ha=JSON.parse(JSON.stringify(c.search_engines));b.setEnabled(Ha);b.setLocale(c.locale);
a(c)})},updateCached:function(a){var b,c,d,e;for(e in Ha)if(Ha.hasOwnProperty(e)){b=Ha[e];for(var f=0,h=b.length;f<h;f++)c=b[f],d=c.name,a.hasOwnProperty(d)&&(c.enabled=a[d])}},setLocale:function(a){Sa=a;ra.i18n.setLocale(a)},getLocale:function(){return Sa},getCachedAll:function(){return Ha},filter:function(a){for(var b=ra.site.get_site(vb.getLocationProperty(window,"hostname")),c=[],d=0,e=a.length;d<e;d++){var f=a[d];f.host&&b.match(f.host)||("etao"==f.name||("paipai.com"==b||"eachnet.com"==b)&&
"taobao"==f.name)||c.push(f)}return c},sort:function(a){a.sort(function(a,c){return"etao"==a.name?-1:"etao"==c.name?1:a.order-c.order})},getCurrentLocaleSearchEngines:function(){var a=this.getCachedAll(),b=this.getLocale(),c=[],d;for(d in a)a.hasOwnProperty(d)&&d==b&&(c=Array.prototype.concat.apply(c,a[d]));return c},renderSearchEngineSettingHtml:function(){var a=this.getCurrentLocaleSearchEngines(),a=this.filter(a),a=Zb.getSearchEngineSettingTemplate(a,this.getLocale());$("#"+Ia("merchant-list")).html(a)},
renderEnabledSearchEngines:function(){var a=this.getEnabled();this.sort(a);$("#"+Ia("search-engine-item-template")).html();$.each(a,function(a,c){c.icon=c.icon||vb.getURL("assets/images/search/se-icons/"+c.name+".png")});a=Zb.getSearchEnginesTemplate(a);$("#"+Ia("search-engines")).html(a)},setSearchEngineSettingPosition:function(){var a=$("#"+Ia("plus-btn")),b=$("#"+Ia("search-engines-setting")),a=a.position().left+a.width()/2,c=b.outerWidth(),a=a-c/2;0>a&&(a=0);b.css("left",a+"px")},getEnabled:function(){return $b},
setEnabled:function(a){var a=a||this.getCachedAll(),b=ra.site.get_site(vb.getLocationProperty(window,"hostname")),c=[],d=function(d){var d=a[d],e,j;e=0;for(j=d.length;e<j;e++){var l=d[e];if(l.enabled&&(!l.host||!b.match(l.host)))(!("paipai.com"==b||"eachnet.com"==b)||!("taobao"==l.name||"etao"==l.name))&&c.push(l)}};a[Sa]&&d(Sa);for(var e in a)a.hasOwnProperty(e)&&e!=Sa&&d(e);$b=c},getSearchEngineById:function(a){var b=this.getCurrentLocaleSearchEngines();if(b)for(var c=0,d=b.length;c<d;c++)if(b[c].name===
a)return b[c];return null}};var S=B;S.SearchBox||(S.SearchBox={});var Rc=S.PageEvent,Ta=S.SearchBox,na=Ta.Util,ac=Ta.Tmpl,u=S.transform_selector,Ja=Ta.Products={DEFAULT_SEARCH_ENGINE:"etao",BOOK_AUTHOR_SEARCH_ENGINE:"amazoncn_book",SAME_PRODUCTS_SEARCH_ENGINE:"product_search",keyword:"",searchEngine:"",productNumPerPage:0,pageCache:null,maxPageNum:0,loading:!1,arrowManualDisabled:!1,prevArrowValid:!0,nextArrowValid:!0,arrowValidDelay:200,init:function(){var a=R.calcProductNumByViewPortWidth();this.setProductNumPerPage(a);
this.reset();this.registerEvents()},sendClickLog:function(a){var b;switch(S.currentViewType){case "same":b="click_same";break;case "recommend":b="click_like";break;case "related":case "search":b="click_search"}b?na.sendLog(b,a+"|"+na.getLocationHref()):S.console.debug("Ready to send log but no action.")},registerEvents:function(){var a=this,b=$("#"+u("product-list"));b.delegate("."+u("product-item"),"click",function(){var b=$(this).attr("data-click-url");na.openTab(b);a.sendClickLog(b)});b.delegate("."+
u("product-item"),"mouseenter",function(){clearTimeout(Ba.timer);var c=b.find("."+u("product-item")).index(this);Ba.render(a.productsData[c]);Ba.show(this)}).delegate("."+u("product-item"),"mouseleave",function(){Ba.timer=setTimeout(function(){Ba.hide()},Ba.delay)});$("#"+u("prev-page-btn")).click(function(){if(a.hasPrevPage()&&a.prevArrowValid){a.prevArrowValid=!1;var b=a.getProductNumPerPage();R.setProductListWrapperWidthByProductNum(b);R.moveProductList("prev");a.currentPageNum--;a.setArrowStatus();
setTimeout(function(){a.prevArrowValid=!0},a.arrowValidDelay)}});$("#"+u("next-page-btn")).click(function(){a.hasNextPage()&&a.nextArrowValid&&(a.nextArrowValid=!1,a.searchNextPage(function(){R.moveProductList("next");a.setArrowStatus();setTimeout(function(){a.nextArrowValid=!0},a.arrowValidDelay)}))})},reset:function(){var a=this;this.productsData=[];this.currentPageNum=this.maxPageNum=0;this.loading=!1;bc.cancel("searchbox_next");this.setSearchEngine("");this.setKeyword("");var b=1,c=aa,d=this.getProductNumPerPage();
this.pageCache=S.PageCache(function(d){"undefined"==typeof c||b<=c?S.browser.extension.sendRequest({topic:"item_search",Keyword:a.getKeyword(),SearchEngine:a.getSearchEngine(),ItemPage:b},function(a){b++;if("Code"in a)S.console.debug(a.Message),d([]);else return(c=a.TotalPages)?d(a.Items):d([])}):d([])},{PageSize:d},!0)},searchNextPage:function(a){var b=$("#"+u("product-list")+" ."+u("product-item")).length,c=this.getProductNumPerPage(),d=c*this.currentPageNum;d<b?(this.currentPageNum++,b=Math.min(b-
d,c),R.setProductListWrapperWidthByProductNum(b),a()):(b=this.getSearchEngine(),c=this.getKeyword(),this.search(b,c,this.currentPageNum+1,null,a))},doNewSearch:function(a,b){a&&b?(this.reset(),this.search(a,b,1,function(){R.clear();R.reset()})):this.renderByData(this.productsData)},renderByData:function(a){this.reset();R.hideNoResult();this.manualDisableAllArrow();R.showLoading();this.maxPageNum=1;R.clear();R.reset();this.searchSuccess(a)},search:function(a,b,c,d,e){var f=this;this.setSearchEngine(a);
this.setKeyword(b);R.hideNoResult();this.manualDisableAllArrow();R.showLoading();a=bc.register("searchbox_next",function(a){f.maxPageNum=a.TotalPages||10;d&&d();f.searchSuccess(a.Entries,e)});this.pageCache.get(c,a)},searchSuccess:function(a,b){var c=this;R.hideLoading();this.manualEnableAllArrow();var d=a.length;d?(a=this.filter(a),this.productsData=this.productsData.concat(a),R.render(a),R.setProductListWrapperWidthByProductNum(d),b&&b(),this.currentPageNum++):(this.maxPageNum=this.currentPageNum,
setTimeout(function(){c.nextArrowValid=!0},c.arrowValidDelay),0==this.currentPageNum&&R.showNoResult());this.setArrowStatus()},filter:function(a){$.each(a,function(a,c){c.SmallImageUrl=c.SmallImageUrl||S.browser.extension.getURL("assets/images/no_image_available.png");var d=c.Price||"",d=d.match(/too low/i)?"Too low":-1!=d.indexOf("-")?$.trim(d.split("-")[0])||"&nbsp;":$.trim(d)||"&nbsp;";c.preferredPrice=d});return a},setArrowStatus:function(){R.disableAllArrow();this.hasPrevPage()&&R.enableArrowBtn("prev");
this.hasNextPage()&&R.enableArrowBtn("next")},hasPrevPage:function(){return!this.arrowManualDisabled&&1<this.currentPageNum},hasNextPage:function(){return!this.arrowManualDisabled&&this.currentPageNum<this.maxPageNum},manualDisableAllArrow:function(){this.arrowManualDisabled=!0;R.disableAllArrow()},manualEnableAllArrow:function(){this.arrowManualDisabled=!1},getKeyword:function(){return this.keyword},setKeyword:function(a){try{this.keyword=decodeURIComponent(a)}catch(b){this.keyword=a}},getSearchEngine:function(){return this.searchEngine},
setSearchEngine:function(a){this.searchEngine=a},getProductNumPerPage:function(){return this.productNumPerPage},setProductNumPerPage:function(a){this.productNumPerPage=a}},R=Ta.ProductsView={viewPortWidth:0,resizeTimer:null,resizeDelay:100,init:function(){this.viewPortWidth=na.getViewPortWidth();Ba.init()},reset:function(){$("#"+u("product-list")).hide().css("left",0).show();this.disableAllArrow()},registerEvents:function(){var a=this;na.addEvent(window,"resize",function(){clearTimeout(a.resizeTimer);
a.resizeTimer=setTimeout(function(){if(na.getViewPortWidth()!=a.viewPortWidth){a.viewPortWidth=na.getViewPortWidth();var b=a.calcProductNumByViewPortWidth();Ja.setProductNumPerPage(b);var b=Ja.getSearchEngine(),c=Ja.getKeyword();Ja.doNewSearch(b,c)}},a.resizeDelay)})},calcProductNumByViewPortWidth:function(){var a=na.getViewPortWidth()-102-20-20-60-112,a=Math.floor(a/90);3>a?a=3:20<a&&(a=20);return a},setProductListWrapperWidthByProductNum:function(a){this.setProductListWrapperWidth(90*a)},show:function(){$("#"+
u("products-wrapper")).show()},hide:function(){$("#"+u("products-wrapper")).hide()},render:function(a){var b=ac.getProductsTemplate(a);S.SearchBox.Util.sanitizeHTML(b,function(b){var d=$("#"+u("product-list"));d.append(b);var b=d.find("."+u("product-image")),e=b.length,f=b.length-a.length,h=0;b.each(function(b){b>=f&&b<e&&$(this).attr("src",a[h++].SmallImageUrl)});setTimeout(function(){var a=$("#"+u("prev-page-btn"));Rc.fire({type:"listRenderSuccess",viewMode:a.length?"search":"recommend",hide:"block"==
$("#"+u("price-comparation-hide-wrapper"))[0].style.display})},0)})},clear:function(){$("#"+u("product-list")).html("")},showLoading:function(){$("#"+u("product-list-overlay")).show()},hideLoading:function(){$("#"+u("product-list-overlay")).hide()},showNoResult:function(){$("#"+u("message")).show()},hideNoResult:function(){$("#"+u("message")).hide()},hidePageTurningBtns:function(){$("."+u("arrow")).hide()},enableArrowBtn:function(a){$("#"+u(a+"-page-btn")).addClass(""+u("active-arrow"))},disableArrowBtn:function(a){$("#"+
u(a+"-page-btn")).removeClass(""+u("active-arrow"))},disableAllArrow:function(){this.disableArrowBtn("prev");this.disableArrowBtn("next")},setProductListWrapperWidth:function(a){203>a&&($.browser.msie&&"6.0"==$.browser.version)&&(a=203);$("#"+u("product-list-wrapper")).width(a)},getProductListWrapperWidth:function(){$("#"+u("product-list-wrapper")).width()},moveProductList:function(a){var b=$("#"+u("product-list")),c=b.position().left,d=90*Ja.getProductNumPerPage();"next"==a?c-=d:"prev"==a&&(c+=d);
b.css("left",c)}},Ba=Ta.Popup={timer:null,delay:200,init:function(){var a=this;$("#"+u("product-detail-container")).mouseenter(function(){clearTimeout(a.timer)}).mouseleave(function(){a.hide()});$("#"+u("product-detail-container")).delegate("#"+u("product-page-link")+", #"+u("product-image")+" > img, #"+u("buy-btn-in-detail"),"click",function(){var a=$(this).attr("data-href");na.openTab(a);Ja.sendClickLog(a)}).delegate("#"+u("want-buy-btn-in-detail"),"click",function(){if(!$(this).hasClass(u("want-buy-btn-disabled"))){var b=
$(this).attr("data-url");a.wantThis(b)}}).delegate("#"+u("want-buy-count-info-in-detail"),"click",function(){a.openUserHomepage()})},setPosition:function(a){var b=$("#"+u("product-detail-container")),c=b.outerWidth(),a=$(a).offset().left+45-c/2-20,d=na.getViewPortWidth();0>a&&(a=-1);c=d-c-20-20;a>c&&(a=c);b.css("left",a+"px")},_mode:"",show:function(a){var b=$("#"+u("product-detail-container"));b.show();this.setPosition(a);this._mode=this._mode||b.data("mode");na.sendLog("hover_"+this._mode,na.getLocationHref())},
hide:function(){$("#"+u("product-detail-container")).hide()},filter:function(a){a.productImageUrl=a.LargeImageUrl||a.SmallImageUrl;a.productUsedPrice=a.UsedPrice||"";a.productPrice=a.Price||"";a.productRatingStars=a.Stars||"";a.productFastTrack=a.FastTrack||"";return a},getWantCounts:function(a){var b=this;S.browser.extension.sendRequest({topic:"item_like_count",url:a},function(a){a.error?$("#"+u("ivy-wrapper-in-detail")).hide():($("#"+u("ivy-wrapper-in-detail")).show(),b.updateWantsStatus(a.users,
a.wanted))})},wantThis:function(a){var b=this;S.browser.extension.sendRequest({topic:"item_like_add",url:a},function(a){a&&(a.success&&"undefined"!=typeof a.users)&&b.updateWantsStatus(a.users,!0)})},updateWantsStatus:function(a,b){var c="",c='<a class="'+u("ivy-wants-count")+'" target="_blank">';$("#"+u("want-buy-btn-in-detail")).removeClass(u("want-buy-btn-disabled"));a=parseInt(a);if(isNaN(a)||0>a)a=0;0==a?c="\u6210\u4e3a\u7b2c "+c+"1 \u4e2a</a>\u60f3\u4e70\u7684\u5982\u610f\u6dd8\u7528\u6237":
b?(c=1==a?"\u4f60\u662f\u7b2c"+c+" 1 \u4e2a</a>\u60f3\u4e70\u7684\u5982\u610f\u6dd8\u7528\u6237":"\u4f60\u4e0e\u5176\u4ed6"+c+(a-1)+" \u4e2a</a>\u5982\u610f\u6dd8\u7528\u6237\u90fd\u60f3\u4e70",$("#"+u("want-buy-btn-in-detail")).addClass(u("want-buy-btn-disabled"))):c="\u5982\u610f\u6dd8\u7528\u6237\u4e2d\u6709"+c+a+" \u4eba</a>\u60f3\u4e70";$("#"+u("want-buy-count-info-in-detail")).html(c)},openUserHomepage:function(a){S.browser.extension.sendRequest({topic:"item_like_open_homepage",url:a})},getWantCountsTimer:null,
render:function(a){var b=this,c=$("#"+u("product-detail-container")),d,e=240;a.Popup?(c.addClass(u("product-detail-container-for-etao")),this.renderForEtao(a),d=$("#"+u("product-image-for-etao")+" img"),e=100):(c.removeClass(u("product-detail-container-for-etao")),clearTimeout(this.getWantCountsTimer),this.getWantCountsTimer=setTimeout(function(){b.getWantCounts(a.DetailPageURL)},50),a=this.filter(a),$("#"+u("product-detail-template")).html(),c=ac.getProductDetailTemplate(a),S.SearchBox.Util.sanitizeHTML(c,
function(a){$("#"+u("product-detail-container")).html("").append(a);d=$("#"+u("product-image")+" img")}));$.browser.msie&&"6.0"==$.browser.version&&S.IE6Patch.fixImageMaxSize(d,e)},renderForEtao:function(a){var b=a.Popup,c=$("#"+u("product-detail-container"));$.trim(a.popupHTML)?(b=a.popupHTML,c.html("").append(b)):0==b.indexOf("http://")?(c.html('<div class="'+u("popup-loading")+'"></div>'),S.browser.extension.sendRequest({topic:"ajax",url:b,dataType:"text"},function(b){(b=$.trim(b))&&"string"==
typeof b?(b=b&&b.replace(/(https?:\/\/)img\d+\.(taobaocdn|tbcdn)\.com/g,"$1go.alicdn.com"),b=S.SearchBox.Util.replaceTemplateSelectors(b),S.SearchBox.Util.sanitizeHTML(b,function(b){a.popupHTML=b;c.html("").append(b)})):c.hide()})):c.html("").append(b)}},bc={callback_id:1,callbacks:{},keys:function(a){var b=[],c;for(c in a)b.push(c);return b},register:function(a,b){var c=this;this.cancel(a);var d=this.callback_id++;this.callbacks[a][d]=b;return function(){var b=c.get(a,d);b&&(b.apply(b,arguments),
c.cancel(a))}},cancel:function(a){this.callbacks[a]={}},get:function(a,b){if("object"==typeof this.callbacks[a]&&"function"==typeof this.callbacks[a][b])return this.callbacks[a][b]}},J=B,Sc=window,Ua=document;J.SearchBox||(J.SearchBox={});var Va=J.SearchBox,hb=Va.UI,ya=Va.Util,Ca=Va.SearchEngines,ib=Va.Products,cc=Va.ProductsView,dc=null,ec=null,fc=null,Ka,I=J.transform_selector,wb=ya.getLocationHref(Sc),Tc=J.PageEvent;J.SearchBox.App={searchEngine:"",isFirstShown:!1,expanded:!0,run:function(a){var b=
this,c=J.site.get_domain(Ua),d=J.site.get_site(c),e=function(d){if(d.config){var e=b.getSearchTerm(d);J.console.debug("get search term '"+e+"'");e?(ya.loadJQuery(),b.init(e,d.status)):a.run();b.handleAjaxSearch(c)}else a.run()};Ca.getAll(function(){0<Ca.getEnabled().length?b.baidu.isSERP()?b.baidu.isCommoditySearch(function(a,c,d){a&&b.init(c,d)}):b.getSiteConfig(d,e):a.run()})},baidu:{isCommoditySearch:function(a){ya.loadJQuery();var b=this.filterKeyword(this.getKeyword()||""),c=this.getURL();this.checkCommodiySearch(b,
c,a)},isSERP:function(){return wb.match(/^http:\/\/www\.baidu\.com\/s\?/)||wb.match(/^http:\/\/www\.baidu\.com\/baidu\?word=/)},getKeyword:function(){return $("#kw").val()},getURL:function(){var a=[];$('td.f span.g, td.f span.c-showurl, td.f div.c-showurl, td.f>font[color=\'#008000\'], td.f #ala_img_results a:not([href^="http://www.baidu.com/link?url="]):not([href^="http://www.baidu.com/baidu.php?url="])td.f #ala_img_desc a:not([href^="http://www.baidu.com/link?url="]):not([href^="http://www.baidu.com/baidu.php?url="])td.f .op_digital_base_moreInfo_l a, td.f .op_digital_moreLink_p a.op_digital_base_moreLink_a, td.f h3.t a:not([href^="http://www.baidu.com/link?url="]):not([href^="http://www.baidu.com/baidu.php?url="])').each($.proxy(function(b,
c){var d=$(c);if(d.length){var e=d.text();c.tagName&&"a"===c.tagName.toLowerCase()&&(e=d.attr("href"));(e=this.filterURL(e))&&a.push(e)}},this));return a},filterURL:function(a){return $.trim(a.replace(/&nbsp;/g," ")).split(RegExp(String.fromCharCode(32)+"|"+String.fromCharCode(160),"g"))[0]},filterKeyword:function(a){return $.trim(a.replace(/(\u5B98\u7F51|\u5B98\u65B9\u7F51\u7AD9|\u65D7\u8230\u5E97|\u5B98\u65B9\u65D7\u8230\u5E97)+$/gm,""))},checkCommodiySearch:function(a,b,c){var d=J.site.get_domain(Ua),
d=J.site.get_site(d);J.browser.extension.sendRequest({topic:"baidu_page_is_commodity_search",domain:d,keyword:a,url:wb,urls:b},function(b){b&&b.is_shopping_keyword?c(!0,a,b.site_status):c(!1)})}},destory:function(){$("."+I("searchbox-protection")).remove()},getSiteConfig:function(a,b){J.browser.extension.sendRequest({topic:"get_site_config",domain:a},b)},getSearchTerm:function(a){return J.site.get_search_term(a.config,Ua)},getKeyword:function(){return Ka},setKeyword:function(a){fc=Ka;try{Ka=decodeURIComponent(a)}catch(b){Ka=
""}$("#"+I("search")).val(Ka)},handleAjaxSearch:function(a){var b=this;if("www.amazon.cn"==a){var c=$("#twotabsearchtextbox"),a=c.get(0).form;$(a).submit(d);c.change(d);$("#rightResultsATF").delegate("#relatedSearches a","mousedown",d);history.pushState?$(window).bind("popstate",d):$(window).bind("hashchange",d);var d=function(){setTimeout(function(){var a=c.val();if(a&&a!=Ka){var d=b.getCurrentSearchEngine();b.setKeyword(a);d&&b.selectSearchEngine(d)}},200)}}},init:function(a,b){if(!$("#"+I("controller-bar")).length&&
!$("#"+I("products-wrapper")).length){var c=this;this.fixFlash();async.parallel({isLogin:function(a){J.browser.extension.sendRequest({topic:"is_loged_in_ivy"},function(b){b&&b.nick?a(null,!0):a(null,!1)})},template:function(a){J.SearchBox.Util.getTemplate("views/searchbox.html",function(b){a(null,b)},!0)}},function(d,e){var f=e.isLogin,h=J.compile(e.template);ya.randomAppend(document.documentElement,J.SearchBox.Util.replaceTemplateSelectors(h.render({hide:!b,login:f,search:!0,viewType:"search"})));
Ca.init();c.doI18n();c.registerEvents();J.currentViewType="search";var j=Ca.getEnabled()[0].name;ib.init();cc.init();ya.handleSogou();f=function(a){c.setKeyword(a);Ca.renderSearchEngineSettingHtml();c.selectSearchEngine(j);b?c.showControlBar():ib.doNewSearch(j,a)};"object"==typeof a&&"function"==typeof a.getUnicode?a.getUnicode(f):f(a)})}},fixFlash:function(){var a=$('embed[type="application/x-shockwave-flash"]'),b=null;$.each(a,function(a,d){b=$(d).clone(!0);b.attr("wmode","transparent");$(d).replaceWith(b)})},
showControlBar:function(){$("#"+I("controller-bar")).show()},hideControlBar:function(){$("#"+I("controller-bar")).hide()},showShrinkBar:function(){$("#"+I("shrink-bar")).show()},hideShrinkBar:function(){$("#"+I("shrink-bar")).hide()},registerEvents:function(){var a=this;$("#"+I("close-btn")).click(function(){a.hideControlBar();a.setSiteStatus("search",!1);Tc.fire({type:"listExt",mode:"0"})});$(document).click(function(b){b=b.target;!$(b).is("."+I("popup"))&&!$(b).parents("."+I("popup")).is("."+I("popup"))&&
a.resetPopups()});$("#"+I("search-form")).submit(function(b){b.preventDefault();if(b=$.trim($("#"+I("search")).val()))a.setKeyword(b),a.selectSearchEngine(a.searchEngine),clearTimeout(a.hideControlBarTimer)});this._registerSearchBarEvents();var b=null,c=$("#"+I("merchants-selection-wrapper"));$("#"+I("merchants-selection-handler")).mouseenter(function(){c.show()}).mouseleave(function(){b=setTimeout(function(){c.hide()},0)});c.mouseenter(function(){clearTimeout(b)}).mouseleave(function(){$(this).hide()});
$("#"+I("search-logo")).click(function(){J.SearchBox.Util.openTab("http://ruyi.taobao.com/?utm_medium=ext&utm_source=ruyi",!0)});$("#"+I("merchant-list")).delegate("."+I("merchant-item"),"click",function(){var b=I("merchant-selected"),c=$(this);c.siblings("."+b).removeClass(b);c.addClass(b);$("#"+I("current-merchant-name")).text(c.text());b=c.attr("data-se-id");b!=a.getCurrentSearchEngine()&&(a.setSiteStatus("search",!0),a.selectSearchEngine(b))});$("#"+I("shrink-bar")).click(function(){a.hideShrinkBar();
cc.show();a.showControlBar();a.setSiteStatus("search",!0)});$("."+I("ivy-home-link")).click(function(){J.browser.extension.sendRequest({topic:"item_like_open_homepage"});ya.sendLog("click_mywant",ya.getLocationHref())})},_registerSearchBarEvents:function(){var a;$("#"+I("search")).focus(function(){hb.focusSearchBar()}).blur(function(){a&&clearTimeout(a);a=setTimeout(function(){hb.blurSearchBar()},200)});$("#"+I("search-btn")).click(function(){a&&clearTimeout(a);hb.focusSearch()})},setPosition:function(a){if($.browser.msie&&
"6.0"==$.browser.version){var b;"active"==a?b=76:"inactive"==a&&(b=0);J.IE6Patch.setBarPosition(b);J.IE6Patch.resetPosition()}else a=I(a+"-position"),a=I("wrapper")+" "+I("searchbox-protection")+" "+a,$("#"+I("controller-bar")).attr("class",a)},getSiteStatus:function(a,b){J.browser.extension.sendRequest({topic:"get_site_status",type:a,domain:J.site.get_site(J.site.get_domain(Ua))},function(a){b(a)})},setSiteStatus:function(a,b){J.browser.extension.sendRequest({topic:"set_site_status",domain:J.site.get_site(J.site.get_domain(Ua)),
type:a,status:b})},checkCurrentSearchEngineIsEnabled:function(){for(var a=Ca.getEnabled(),b=this.getCurrentSearchEngine(),c=0,d=a.length;c<d;c++)if(a[c].name==b)return!0;return!1},selectSearchEngine:function(a){this.searchEngine=a;var b=$("#"+I("se-"+a));if(a!=ib.getSearchEngine()||fc!=this.getKeyword())b.addClass(I("merchant-selected")),$("#"+I("current-merchant-name")).text(b.text()),ib.doNewSearch(a,this.getKeyword());this.setCurrentSearchEngine(a)},resetPopups:function(){hb.hidePopups();this.setActiveControllerIcon(null)},
getActiveControllerIcon:function(){return ec},setActiveControllerIcon:function(a){ec=a},getCurrentSearchEngine:function(){return dc},setCurrentSearchEngine:function(a){dc=a},doI18n:function(){var a=Ca.getLocale(),b,c,d;$("."+I("wrapper")+" [data-i18n]").each(function(){b=$(this).attr("data-i18n");c=b.split("->");d=c[1];"content"==c[0]?$(this).html(J.i18n.getMessage(d)):"attribute"==c[0]&&(d=d.split(":"),$(this).attr(d[0],J.i18n.getMessage(d[1])))});"zh"==a?(a=ya.getURL("assets/images/search/search-cn.png"),
$("#"+I("search-icon")+" img").attr("src",a)):($("#"+I("search-logo")).hide(),$("#"+I("non-zh-logo")).show(),$("#"+I("shrink-bar")).addClass(I("shrink-bar-en")).attr("title","Click to show Shopping Assistant"),$("#"+I("merchants-selection-wrapper")).css("left","76px"))}};var Wa=B,ga=Wa.transform_selector;Wa.ControlBar={init:function(a){this.bindEvents();this.setPosition(a);$.browser.msie&&"6.0"==$.browser.version&&Wa.IE6Patch.init()},bindEvents:function(){$("#"+ga("products-close-btn")).click(function(){$("#"+
ga("products-wrapper")).hide()});this._registerSearchBarEvents()},_registerSearchBarEvents:function(){var a=this,b;$("#"+ga("search")).focus(function(){a.focusSearchBar()}).blur(function(){b&&clearTimeout(b);b=setTimeout(function(){a.blurSearchBar()},200)});$("#"+ga("search-btn")).click(function(){b&&clearTimeout(b);a.focusSearch()})},CONTROL_BAR_BOTTOM_WITH_PRICE_COMPARATION:46,CONTROL_BAR_BOTTOM_WITH_SEARCH:76,CONTROL_BAR_BOTTOM_WITH_NOTHING:0,setPosition:function(a){if($.browser.msie&&"6.0"==$.browser.version){var b;
"product"==a?b=this.CONTROL_BAR_BOTTOM_WITH_PRICE_COMPARATION:"search"==a?b=this.CONTROL_BAR_BOTTOM_WITH_SEARCH:"hide"==a&&(b=this.CONTROL_BAR_BOTTOM_WITH_NOTHING);Wa.IE6Patch.setBarPosition(b);Wa.IE6Patch.resetPosition()}else a=ga(a+"-bottom"),a=ga("wrapper")+" "+ga("products-protection")+" "+a,$("#"+ga("controller-bar")).attr("class",a)},showSearchBar:function(){$("#"+ga("search-bar")).show()},hideSearchBar:function(){$("#"+ga("search-bar")).hide()},focusSearch:function(){$("#"+ga("search")).get(0).focus()},
focusSearchBar:function(){$("#"+ga("search-bar")).addClass(""+ga("search-focus"))},blurSearchBar:function(){$("#"+ga("search-bar")).removeClass(""+ga("search-focus"))},setKeyword:function(a){$("#"+ga("search")).val(a)}};var La=window,l=B,Uc=function(a){for(var b,c,d=a.length,e,f;d--;)e=a[d],c=$(e.xpath),f=RegExp(e.regexp,"i"),$.each(c,function(){var a;if(a=(this.innerHTML||"").match(f))return b=a[1],!1});return b},xb=l.site,za=l.browser.extension,yb=La.document,F=l.SearchBox.Util,s=l.transform_selector,
zb=l.PageEvent,Ab=l._,gc=l.PriceComparationsUI={viewPortWidth:0,_ICON_CLASSNAME:s("market-icon"),_widthArr:null,init:function(){this.viewPortWidth=document.documentElement.clientWidth;this._widthArr=this._getMarketListWidthArr();this.adjustMarketListWidth();this.bindEvents()},bindEvents:function(){var a=this;l.debounce(function(){document.documentElement.clientWidth!=a.viewPortWidth&&(a.viewPortWidth=document.documentElement.clientWidth,l.ItemBar.markCurrentMerchant())})},_getMarketListWidthArr:function(){var a=
this,b=$("#"+s("price-comparation-wrapper")).is(":hidden"),c=0,d=[];b&&($("#"+s("products-wrapper")).remove(),$("#"+s("price-comparation-wrapper")).css({visible:"hidden"}).show());$("#"+s("market-list")+" li").each(function(b,f){c+=$(f).outerWidth(!0);d.push({isIcon:$(f).hasClass(a._ICON_CLASSNAME),width:c})});b&&$("#"+s("price-comparation-wrapper")).hide().css({visible:""});return d},adjustWrapperWidth:function(){var a=112+$("#"+s("market-list")).width();$("."+s("main-content")).css({width:a+"px"});
$("."+s("main-wrapper")).css({width:a+"px","transition-property":"none"});setTimeout(function(){$("."+s("main-wrapper")).css({"transition-property":"width"})},0)},adjustMarketListWidth:function(){for(var a=$("#"+s("author-icon")).length?60:0,b,c=document.documentElement.clientWidth-107-20-120-112-a,d=!1,e=this._widthArr.length-1;0<=e&&!(a=this._widthArr[e],b=a.width,(d=d||a.isIcon)&&this._widthArr[0].isIcon&&(b-=this._widthArr[0].width),(2>e||b<=c)&&!a.isIcon);e--);d?this.hideIcon():this.showIcon();
this.setMarketListWidth(b+2)},showIcon:function(){$("#"+s("price-comparation-wrapper")+" ."+this._ICON_CLASSNAME).show()},hideIcon:function(){$("#"+s("price-comparation-wrapper")+" ."+this._ICON_CLASSNAME).hide()},setMarketListWidth:function(a){$("#"+s("market-list")).width(a)},show:function(){$("#"+s("price-comparation-wrapper")).show()},hide:function(){$("#"+s("price-comparation-wrapper")).hide()}};l.ItemBar={_max_items:aa,_loading:!1,_page_size:aa,_total_pages:aa,_page:0,_has_more_books:!1,moreBooksOfAuthor:null,
productNum:0,priceComparationInfo:{valid:!1,type:"",currentPrice:aa,currentMerchantName:"",productTitle:"",relativeMerchantName:"",priceDiff:aa},destory:function(){$("#"+s("products-style")).remove();$("#"+s("controller-bar")).remove();$("#"+s("products-wrapper")).remove();$("#"+s("price-comparation-wrapper")).remove()},initPriceComparation:function(a){var b=this,c=a.productList,d=a.product;this.productNum=c.length;console.log([c,a]);var e=xb.get_domain(yb),f={isLogin:function(a){l.browser.extension.sendRequest({topic:"is_loged_in_ivy"},
function(b){b&&b.nick?a(null,!0):a(null,!1)})},isOpen:function(a){l.SearchBox.App.getSiteStatus("price_compare",function(b){a(null,b)})},template:function(a){l.SearchBox.Util.getTemplate("views/products.html",function(b){a(null,b)},!0)}};"book.douban.com"==e&&a.book_author&&(f.hasAuthor=function(b){za.sendRequest({topic:"item_search",Keyword:a.book_author,SearchEngine:l.SearchBox.Products.BOOK_AUTHOR_SEARCH_ENGINE,ItemPage:1},function(c){var d="http://www.amazon.cn/s?tag=ruyita-23&ie=UTF8&search-alias=books&field-author="+
a.book_author;Ab.isArray(c.Items)&&0<Ab.size(c.Items)?b(null,{url:d,items:c.Items}):b(null,!1)})});async.parallel(f,function(f,j){var p=j.isLogin,u=j.isOpen,t=l.compile(j.template),y=Ab.min(c,function(a){return a.Price});y&&(y.isLowest=!0);F.randomAppend(document.documentElement,l.SearchBox.Util.replaceTemplateSelectors(t.render({compare:!0,viewType:"compare",login:p,hide:!u,hasGood:c[0].BSeller,list:c,hasAuthor:j.hasAuthor})));setTimeout(function(){l.SearchBox.Products.init();l.SearchBox.ProductsView.init();
b.calcCurrentMerchantIndex(c,d);gc.init();b.markCurrentMerchant();u?b.sendShowLog("show_product",c):b.checkExpandTip();b.bindEvents(d,c);"book.douban.com"==e&&j.hasAuthor&&(l.ItemBar._has_more_books=!0,l.ItemBar.moreBooksOfAuthor=j.hasAuthor.items,l.ItemBar.author=a.book_author,$("#"+s("author-icon")).click(function(){l.SearchBox.Util.openTab(j.hasAuthor.url,!0)}));F.handleSogou();b.handleIvyHomeLinkClick();zb.fire({type:"listRenderSuccess",viewMode:"compare",hasAuthor:j.hasAuthor,hide:!u})},0)})},
calcCurrentMerchantIndex:function(a,b){for(var c,d=0,e=a.length;d<e;d++)if(b.ItemNid&&b.ItemNid==a[d].nid){c=d;break}return c},markCurrentMerchant:function(){var a=$("."+s("current-merchant")).eq(0),b=$("#"+s("current-merchant-cursor")),c=$("#"+s("market-list")),d=c.find("."+s("market-item")),c=parseInt(c.width()/120);a.length&&d.index(a)<=c-1?(a=a.position().left+54,b.show().css("left",a+"px")):b.hide()},isSameProduct:function(a){return a&&a.Epid&&14<a.Epid.length&&3<=a.Epid.charAt(0)},initSame:function(a,
b){var c=this,d=a.productList;this.productNum=d.length;this.sameProductsKeyword=a.Keyword;async.parallel({isLogin:function(a){l.browser.extension.sendRequest({topic:"is_loged_in_ivy"},function(b){b&&b.nick?a(null,!0):a(null,!1)})},isOpen:function(a){l.SearchBox.App.getSiteStatus("price_compare",function(b){a(null,b)})},template:function(a){l.SearchBox.Util.getTemplate("views/products.html",function(b){a(null,b)},!0)}},function(e,f){var h=f.isLogin,j=f.isOpen,p=l.compile(f.template);F.randomAppend(document.documentElement,
l.SearchBox.Util.replaceTemplateSelectors(p.render({same:!0,hide:!j,login:h,viewType:"same",list:d})));b?(c.updateLogo("recommend"),l.currentViewType="recommend"):(c.updateLogo("same"),l.currentViewType="same");l.SearchBox.ProductsView.hidePageTurningBtns();l.SearchBox.Products.init();l.SearchBox.ProductsView.init();l.SearchBox.Products.doNewSearch(l.SearchBox.Products.SAME_PRODUCTS_SEARCH_ENGINE,c.sameProductsKeyword);c.handleLogoClick();h={same:"show_same",recommend:"show_like"};j?(l.SearchBox.ProductsView.show(),
c.sendShowLog(h[l.currentViewType]||"show_same",d)):(l.SearchBox.ProductsView.hide(),c.checkExpandTip());c.checkMoreBooksOfAuthor(a.book_author);F.handleSogou();c.handleShrink("same",d);c.handleIvyHomeLinkClick()})},sendShowLog:function(a,b){var c=F.getLocationHref();b&&"object"==typeof b[0]&&"undefined"!=typeof b[0].DetailPageURL?F.sendLog(a,F.appendTraceParameter(c,b[0].DetailPageURL)):F.sendLog(a,c)},initLike:function(a){var b=this,c=a.productList;this.productNum=c.length;async.parallel({isLogin:function(a){l.browser.extension.sendRequest({topic:"is_loged_in_ivy"},
function(b){b&&b.nick?a(null,!0):a(null,!1)})},isOpen:function(a){l.SearchBox.App.getSiteStatus("price_compare",function(b){a(null,b)})},template:function(a){l.SearchBox.Util.getTemplate("views/products.html",function(b){a(null,b)},!0)}},function(d,e){var f=e.isLogin,h=e.isOpen,j=l.compile(e.template);F.randomAppend(document.documentElement,l.SearchBox.Util.replaceTemplateSelectors(j.render({recommend:!0,viewType:"recommend",login:f,hide:!h,list:c})));b.updateLogo("recommend");l.currentViewType="recommend";
l.SearchBox.ProductsView.hidePageTurningBtns();l.SearchBox.Products.init();l.SearchBox.ProductsView.init();l.etaoLike.render(c);b.handleLogoClick();h?(l.SearchBox.ProductsView.show(),b.sendShowLog("show_like",c)):(l.SearchBox.ProductsView.hide(),b.showShrinkBar(),b.checkExpandTip());b.checkMoreBooksOfAuthor(a.book_author);F.handleSogou();b.handleShrink("like",c);b.handleIvyHomeLinkClick();zb.fire({type:"listRenderSuccess",viewMode:"recommend",hide:!h})})},initRelated:function(a){var b=this;l.SearchBox.Util.getTemplate("views/products.html",
function(c){F.randomAppend(document.documentElement,c);b.updateLogo("similar");l.currentViewType="related";l.SearchBox.Products.init();l.SearchBox.ProductsView.init();0<a.length&&(l.SearchBox.Products.doNewSearch(l.SearchBox.Products.DEFAULT_SEARCH_ENGINE,a),b.handleLogoClick(),l.SearchBox.App.getSiteStatus("price_compare",function(a){a?(l.SearchBox.ProductsView.show(),b.sendShowLog("show_product")):(l.SearchBox.ProductsView.hide(),b.showShrinkBar(),b.checkExpandTip())}));F.handleSogou();b.handleShrink("related");
b.handleIvyHomeLinkClick()})},initSearch:function(){var a=this;async.parallel({isOpen:function(a){l.SearchBox.App.getSiteStatus("price_compare",function(c){a(null,c)})},template:function(a){l.SearchBox.Util.getTemplate("views/products.html",function(c){a(null,c)},!0)}},function(b,c){var d=c.isOpen,e=l.compile(c.template);F.randomAppend(document.documentElement,l.SearchBox.Util.replaceTemplateSelectors(e.render({hide:!d,smallSearch:!0,viewType:"smallSearch"})));a.handleSearch();a.handleLogoClick();
a.handleClose();F.handleSogou()});F.sendLog("show_empty",F.getLocationHref())},updateLogo:function(a){$("#"+s("logo")).attr("title","\u5982\u610f\u6dd8 - "+{same:"\u540c\u6b3e\u5546\u54c1",recommend:"\u5546\u54c1\u63a8\u8350",similar:"\u76f8\u5173\u5546\u54c1"}[a]).addClass(s(a+"-logo"));$("."+s("logo-type")).html({same:"\u540c\u6b3e",recommend:"\u63a8\u8350",similar:"\u76f8\u5173"}[a])},bindEvents:function(a,b){var c=F.getLocationHref();$("#"+s("market-list")).delegate("."+s("market-item"),"click",
function(){if(!$(this).hasClass(s("current-merchant"))){var a=$(this).attr("data-href");F.openTab(a);F.sendLog("click_product",a+"|"+c)}});$("#"+s("more-results-link")).click(function(){l.SearchBox.Util.openTab(a.DetailPageURL,!0);F.sendLog("click_product",a.DetailPageURL+"|"+c)});a.SmallImageUrl&&a.SmallImageUrl.replace("_80x80.jpg","");var d=(a.Title||"").replace(/(?:\(|\uff08)[^(^)^\uff08^\uff09]+(?:\)|\uff09)/g,""),e="http://s.taobao.com/search?tb_lm_id=ryt_ext&q=";l.browser.extension.sendRequest({topic:"encode_gbk",
str:d},function(a){a&&(e+=a)});$("#"+s("search-in-taobao-icon")).attr("title","\u5728\u6dd8\u5b9d\u641c\u7d22\u201c"+d+"\u201d").click(function(){l.SearchBox.Util.openTab(e,!0);F.sendLog("click_product",e+"|"+c)});this.handleLogoClick();this.handleShrink("price_compare",b)},showShrinkBar:function(){$("#"+s("shrink-bar")).show()},hideShrinkBar:function(){$("#"+s("shrink-bar")).hide()},handleShrink:function(a,b){var c=this;$("#"+s("price-comparation-close-btn")).click(function(){l.SearchBox.App.setSiteStatus("price_compare",
!1);zb.fire({type:"listExt",mode:"0"})});$("#"+s("products-close-btn")).click(function(){l.SearchBox.ProductsView.hide();c.showShrinkBar();l.SearchBox.App.setSiteStatus("price_compare",!1)});$("#"+s("shrink-bar")).click(function(){c.hideShrinkBar();"price_compare"==a?(gc.show(),c.sendShowLog("show_product",b)):(l.SearchBox.ProductsView.show(),"same"==a?c.sendShowLog("show_same",b):"related"==a?c.sendShowLog("show_product",b):"like"==a&&c.sendShowLog("show_like",b));l.SearchBox.App.setSiteStatus("price_compare",
!0)})},handleIvyHomeLinkClick:function(){$("."+s("ivy-home-link")).click(function(){l.browser.extension.sendRequest({topic:"item_like_open_homepage"});F.sendLog("click_mywant",F.getLocationHref())})},handleClose:function(){var a=$("#"+s("price-comparation-close-btn")),b=$("."+s("main-wrapper"));a.click(function(){"1"==b.data("hide")?(b.css({width:"auto"}),b.data("hide","0"),a.removeClass(s("close-unfold")).addClass(s("close-fold")),$("#"+s("search-field")).focus()):(b.css({width:"0"}),b.data("hide",
"1"),a.removeClass(s("close-fold")).addClass(s("close-unfold")))})},handleSearch:function(){var a=null;$("#"+s("search-field")).focus(function(){$(this).addClass(s("search-field-focused"))}).blur(function(){var b=$(this);a=setTimeout(function(){b.removeClass(s("search-field-focused"))},100)});$("#"+s("search-form")).submit(function(b){b.preventDefault();clearTimeout(a);b=$("#"+s("search-field")).val();(b=$.trim(b))?l.SearchBox.Util.openTab("http://s.etao.com/search?tb_lm_id=ryt_ext&q="+b,!0):($("#"+
s("search-btn")).blur(),$("#"+s("search-field")).focus())})},handleLogoClick:function(){$("."+s("logo")).click(function(){l.SearchBox.Util.openTab("http://ruyi.taobao.com/?utm_medium=ext&utm_source=ruyi",!0)})},checkAddToWantIntroStatus:function(){var a=this;za.sendRequest({topic:"check_add_to_want_intro_status"},function(b){b&&l.SearchBox.Util.getTemplate("views/add-to-want-intro.html",function(b){$(document.body).append(b);var d=$("#"+s("popup-intro-wrapper"));$("#"+s("pi-close")).click(function(){d.css("top",
"-100px");a.adjustBodyPaddingTop(0);l.likeButtonTips&&l.likeButtonTips.fixPos()});setTimeout(function(){d.css("top",0);a.adjustBodyPaddingTop();za.sendRequest({topic:"set_add_to_want_intro_status"});l.likeButtonTips&&l.likeButtonTips.fixPos()},500)})})},adjustBodyPaddingTop:function(a){"undefined"==typeof a&&(a=100);var b=$(document.body).attr("style")||"";$(document.body).attr("style",b+";padding-top:"+a+"px !important;")},checkExpandTip:function(){var a=l.site.get_site(l.site.get_domain(document));
("taobao.com"==a||"tmall.com"==a)&&za.sendRequest({topic:"get_expand_tip_status",domain:a},function(b){b&&l.SearchBox.Util.getTemplate("views/expand-tip.html",function(b){$(document.body).append(b);var d=$("#"+s("et-wrapper"));d.css("bottom",0);$("#"+s("et-close")).click(function(){d.css("bottom","-330px")});$("#"+s("et-expend-now-btn")).click(function(){d.css("bottom","-330px");$("#"+s("mini-close-btn")).trigger("click")});za.sendRequest({topic:"set_expand_tip_status",domain:a})})})},renderMarketList:function(a,
b){$.each(a,function(a,b){b.DetailUrl=b.ClickUrl||b.DetailPageURL});var c=l.SearchBox.Tmpl.getMarketsTemplate(a,b);$("#"+s("market-list")).html(c)},fillMoreBookList:function(a){for(var a=this.moreBooksOfAuthor,b=$("#"+s("book-list")),c=0,d=Math.min(a.length,6),e=[];c<d;c++){var f=a[c];e.push('<li class="'+s("book-item")+'">');e.push('<a target="_blank" href="'+(f.ClickUrl||f.DetailPageURL)+'">'+f.Title+"</a>");e.push("</li>");c!=d-1&&e.push('<li class="'+s("book-separater")+'"></li>')}b.html(e.join(""))},
hideAuthorIcon:function(){$("#"+s("author-icon")).hide()},checkMoreBooksOfAuthor:function(a){var b=this;a?(l.console.debug("Has author: "+a),za.sendRequest({topic:"item_search",Keyword:a,SearchEngine:l.SearchBox.Products.BOOK_AUTHOR_SEARCH_ENGINE,ItemPage:1},function(c){"object"==typeof c.Items&&0<c.Items.length?(l.console.debug(a+" wroted "+c.Items.length+" books."),l.ItemBar._has_more_books=!0,l.ItemBar.moreBooksOfAuthor=c.Items,l.ItemBar.author=a,$("#"+s("author-icon")).click(function(){l.SearchBox.Util.openTab("http://www.amazon.cn/s?tag=ruyita-23&ie=UTF8&search-alias=books&field-author="+
a,!0)})):b.hideAuthorIcon()})):b.hideAuthorIcon()},parseCurrentProductPrice:function(a){za.sendRequest({topic:"get_detail_config",domain:F.getLocationProperty(La,"hostname")},function(b){if(b&&b.length)for(var c,d,e=0;e<b.length;e++)if(c=b[e],RegExp(c.url).test(F.getLocationHref(La)))for(var f=0;f<c.patterns.length;f++)if(d=c.patterns[f],d.price&&(d=$(d.price),d.length)){"IMG"==d.get(0).tagName?F.parseImagePrice(d,function(b){b=F.parsePriceString(b);a(b)}):(c=d.text(),c=F.parsePriceString(c),a(c));
break}})},constructPriceComparationInfo:function(a,b,c){var d=this.priceComparationInfo;if(!a||!b||!c)d.valid=!1;else if(c=c[0],c.BSeller){var e=F.getSiteMetaInfo(F.getLocationProperty(La,"hostname"));e?(d.currentMerchantName=e.name,(e=F.parsePriceString(c.Price))?(e=a-e,d.priceDiff=Math.abs(e).toFixed(1),0<e?d.type="expensive":0>e&&(d.type="cheap"),e=b.book?["\u300a","\u300b"]:["\u201c","\u201d"],d.productTitle=e[0]+b.Title+e[1],d.currentPrice=a,d.relativeMerchantName=c.ShopName,d.relativeMerchantLink=
c.DetailUrl||c.ClickUrl||c.DetailPageURL,d.moreMerchantsLink=b.DetailPageURL,d.valid=!0):d.valid=!1):d.valid=!1}else d.valid=!1}};l.sameBookAssist={};l.sameBookAssist.run=function(a){var b=xb.get_url(yb),c=xb.get_domain(yb);za.sendRequest({topic:"is_book_site",domain:c,url:b},function(b){if(b){"function"==typeof l.loadJQuery&&($=l.loadJQuery());var c;var f,h={};if(b){for(f in b)b.hasOwnProperty(f)&&(h[f]=Uc(b[f]));c=h}else c=void 0;c.isbn?(l.IvyWantBuy.init(),b=JSON.stringify({url:F.getLocationHref(La),
title:La.document.title,isbn:c.isbn}),l.browser.extension.sendRequest({topic:"item_search",Keyword:b,SearchEngine:"product_search",ItemPage:1},function(a){"object"==typeof a.Items&&0<a.Items.length?(a.Product.book=c,l.ItemBar.isSameProduct(a.Product)?l.ItemBar.initSame({productList:a.Items,product:a.Product,Keyword:l.productSearch.getKeyword(),book_author:c.author}):l.ItemBar.initPriceComparation({productList:a.Items,max_items:8,book_author:c.author,product:a.Product}),l.ItemBar.constructPriceComparationInfo(c.price,
a.Product,a.Items),l.console.debug("Current product price: "+c.price)):l.ItemBar.initSearch()})):a.run()}else a.run()})};var jb=window,V=B,hc=V.SearchBox.Util;V.productSearch={getKeyword:function(){return JSON.stringify({url:hc.getLocationHref(jb),title:jb.document.title})}};V.productSearch.run=function(){var a=this;V.browser.extension.sendRequest({topic:"is_detail_site",url:hc.getLocationHref(jb),title:jb.document.title},function(b){if("undefined"!=typeof b.locale){V.IvyWantBuy.init();var c;V.SearchBox.Util.loadJQuery();
b.product?(c=a.getKeyword(),V.browser.extension.sendRequest({topic:"item_search",Keyword:c,SearchEngine:"product_search",ItemPage:1},function(a){V.console.debug("1. "+a.Items.length);"object"==typeof a.Items&&0<a.Items.length&&(V.ItemBar.isSameProduct(a.Product)?V.ItemBar.initSame({productList:a.Items,product:a.Product,Keyword:c}):V.ItemBar.initPriceComparation({productList:a.Items,product:a.Product}),V.ItemBar.parseCurrentProductPrice(function(b){b&&(V.ItemBar.constructPriceComparationInfo(b,a.Product,
a.Items),V.console.debug("Current product price: "+b))}))})):b.likeItems?V.ItemBar.initLike({productList:b.likeItems}):b.productSameTag?(c=a.getKeyword(),V.browser.extension.sendRequest({topic:"item_search",Keyword:c,SearchEngine:"product_search",ItemPage:1},function(a){V.console.debug("1. "+a.Items.length);"object"==typeof a.Items&&0<a.Items.length&&(V.ItemBar.initSame({productList:a.Items,product:a.Product,Keyword:c},!0),V.ItemBar.parseCurrentProductPrice(function(b){b&&(V.ItemBar.constructPriceComparationInfo(b,
a.Product,a.Items),V.console.debug("Current product price: "+b))}))})):b.keyword?V.ItemBar.initRelated(b.keyword):V.ItemBar.initSearch()}})};var ic=B;ic.etaoLike={_productList:null,render:function(a){(a=this._productList=a||this._productList)&&ic.SearchBox.Products.renderByData(a)}};var M=B,Xa=window,oa=M.SearchBox.Util,p=M.transform_selector;M.SrpCompare={initialized:!1,hideDelay:100,hideIconTimer:aa,hidePopupTimer:aa,templateInserted:!1,CLASS_ICON_DISABLED:p("huoyan-icon-disabled"),init:function(){var a=
this;this.initialized||(this.initialized=!0,M.browser.extension.sendRequest({topic:"get_srp_config",domain:oa.getLocationProperty(Xa,"hostname")},function(b){b&&(oa.loadJQuery(),a.bindEvents(b))}))},destory:function(){$("."+p("fast-compare-protection")).remove()},registeredAnchorAndImg:[],bindEvents:function(a){for(var b=this,c=0,d=a.length;c<d;c++){var e=a[c];if(("undefined"==typeof e.url||RegExp(e.url).test(oa.getLocationHref(Xa)))&&"undefined"!=typeof e.patterns){for(var f=!1,e=e.patterns,h=0,
j=e.length;h<j;h++){var l=e[h],p="undefined"!=typeof l.list,t=p?$(l.list):$(document.body);0<t.size()&&(l.img&&l.a&&!oa.elemInArray(l.img+"|"+l.a,this.registeredAnchorAndImg))&&(this.registeredAnchorAndImg.push(l.img+"|"+l.a),f=function(a,c){return function(d){b.showIcon($(d.target),a,c)}}(l,t),p?t.delegate(l.img,"mouseenter",f).delegate(l.img,"mouseleave",function(){b.hideIcon(b.hideDelay);b.hidePopup(b.hideDelay)}):$(l.img,t).mouseenter(f).mouseleave(function(){b.hideIcon(b.hideDelay);b.hidePopup(b.hideDelay)}),
f=!0)}if(f)break}}},parseCurrentProductPrice:function(a,b,c){for(var d,e,f=0;f<a.length;f++){e=b;for(var h=0;h<a[f].imgToItemLevel;h++)e=e.parent();d=$(a[f].selector,e).eq(0);if(d.length)break}d.length&&("IMG"==d.get(0).tagName?M.SearchBox.Util.parseImagePrice(d,function(a){var e=d,a=M.SearchBox.Util.parsePriceString(a);c(a,b,e)}):(a=d.text(),e=d,a=M.SearchBox.Util.parsePriceString(a),c(a,b,e)))},priceComparationInfo:{valid:!1,type:"",currentPrice:aa,currentMerchantName:"",productTitle:"",relativeMerchantName:"",
priceDiff:aa},constructPriceComparationInfo:function(a,b,c){var d=this.priceComparationInfo;if(!a||!b||!c)d.valid=!1;else{var e=oa.getSiteMetaInfo(oa.getLocationProperty(Xa,"hostname"));e?(d.currentMerchantName=e.name,(e=oa.parsePriceString(c.Price))?(e=a-e,d.priceDiff=Math.abs(e).toFixed(1),0<e?d.type="expensive":0>e&&(d.type="cheap"),e=b.Book?["\u300a","\u300b"]:["\u201c","\u201d"],d.productTitle=e[0]+b.Title+e[1],d.currentPrice=a,d.relativeMerchantName=c.SiteName,d.valid=!0):d.valid=!1):d.valid=
!1}},currentImageElement:null,selectorPattern:null,matchedResultList:null,showIcon:function(a,b,c){var d=this;this.clearHideIconTimer();var e=$(b.img,c).index(a);-1!=e&&(e=$(b.a,c).eq(e),0!=e.size()&&(this.currentImageElement=a,this.selectorPattern=b,this.matchedResultList=c,d.templateInserted?d.setIconPosition():d.insertTemplateAndBindEvents(function(){d.setIconPosition()}),this.currentProductLink=e.get(0).href))},setIconPosition:function(){this.enableIcon();var a=this.currentImageElement,b=$("#"+
p("huoyan-icon")),c=a.offset(),d=a.outerWidth(),a=a.outerHeight(),e=b.width(),f=b.height();b.css({top:c.top+a-f-1+"px",left:c.left+(d-e)/2+"px"}).show()},clearHideIconTimer:function(){this.hideIconTimer!=aa&&clearTimeout(this.hideIconTimer);this.hideIconTimer=aa},hideIcon:function(a){var b=this;this.clearHideIconTimer();a?this.hideIconTimer=setTimeout(function(){b._hideIcon()},a):this._hideIcon()},_hideIcon:function(){$("#"+p("huoyan-icon")).hide()},disableIcon:function(){$("#"+p("huoyan-icon")).addClass(this.CLASS_ICON_DISABLED)},
enableIcon:function(){$("#"+p("huoyan-icon")).removeClass(this.CLASS_ICON_DISABLED)},showPopup:function(){var a=this.currentImageElement,b=this.selectorPattern,c=this.matchedResultList;if(a&&b&&c){var d=this;this.currentImageElement=a;var e=$(b.img,c).index(a);-1!=e&&(c=$(b.a,c).eq(e),0!=c.size()&&(c=c.get(0).href,d.hidePopup(),M.browser.extension.sendRequest({topic:"get_price_comparation_and_history_prices_data",link:c},function(c){if(!c||!c.Item)d.disableIcon();else{var e=c.Items,j=c.tagsInfo,l=
c.Item;if("undefined"!=typeof l){d.searchResult=c;var s=$("#"+p("huoyan-wrapper")).show();M.SearchBox.Util.sendLog("show_compare",oa.getLocationHref(Xa));var t=$("#"+p("fast-compare"));$("#"+p("no-price-comparation-info")).hide();var u=$("#"+p("huoyan-header")),g=$("#"+p("huoyan-body")),y=$("#"+p("hy-ivy-bar")),K=$("#"+p("hy-tags-wrapper")),A;if(e&&0<e.length){for(var j=[],v,m=0,z=e.length;m<z;m++)v=e[m],A=""+p("fc-item"),j.push('<li class="'+A+'" title="'+v.SiteName+'"><a class="'+p("fc-item-link")+
'" href="javascript:void(0);" data-click-url="'+v.ClickUrl+'"><img width="16" height="16" class="'+p("fc-item-img")+'" alt="'+v.SiteName+'" src="'+v.SiteLogo+'" /><span class="'+p("fc-item-price")+'">'+v.Price+"</span></a></li>");$("#"+p("fc-list")).empty().append(j.join("\n"));t.css("display","inline-block");K.hide();A=425;j=427}else if(j&&j.tags&&2<j.tags.length){v=j.tags;var C=j.item_id,j="";A=p("hy-tag-item");for(var B,m=0,z=v.length;m<z;m++)B=v[m],j+='<li class="'+A+'">'+B+"</li>";$("#"+p("hy-tag-list")).empty().append(j);
j="http://ruyi.taobao.com/item/"+encodeURIComponent(C)+"?utm_medium=ext&utm_source=ruyi#similar";$("#"+p("hy-tag-list")).attr("data-href",j);$("#"+p("hy-search-tags-in-etao")).attr("href",j);A=425;j=427;K.css("display","inline-block");t.hide()}else A=314,setTimeout(function(){t.hide();K.hide()},0),j=316;u.width(A);g.width(A);y.width(A);d.renderPlot(l.Prices,l);var l=b.price,u=a.attr(p("detected-price")),F=c.Product,E;e&&(E=e[0]);u?d.constructPriceComparationInfo(u,F,E):l&&l.length&&d.parseCurrentProductPrice(l,
a,function(b){a.attr(p("detected-price"),b);d.constructPriceComparationInfo(b,F,E)});c=$("#"+p("huoyan-wrapper")+" ."+p("fc-arrow"));arrow_width=c.width();e=a.offset();s.outerHeight();parseInt(c.css("height"));l=e.top+a.outerHeight()/2-s.outerHeight()/2;u=e.left+a.outerWidth()+arrow_width;y=$(document.body).scrollLeft()+document.documentElement.clientWidth;u+j<y?(c.removeClass(p("fc-arrow-right")),c.css({left:-1*arrow_width}),t.addClass(p("float-right-layout")),K.addClass(p("float-right-layout")),
$("#"+p("hy-price-curve")).prependTo(g)):(c.addClass(""+p("fc-arrow-right")),u=e.left-arrow_width-j,c.css({left:j-2}),t.removeClass(p("float-right-layout")).prependTo(g),K.removeClass(p("float-right-layout")).prependTo(g));s.css({top:l,left:u})}}}),this.getWantCounts(c)))}},clearHidePopupTimer:function(){this.hidePopupTimer!=aa&&clearTimeout(this.hidePopupTimer);this.hidePopupTimer=aa},hidePopup:function(a){var b=this;this.clearHidePopupTimer();a?this.hidePopupTimer=setTimeout(function(){b._hidePopup()},
a):this._hidePopup()},_hidePopup:function(){$("#"+p("huoyan-wrapper")).hide()},insertTemplateAndBindEvents:function(a){var b=this;M.SearchBox.Util.getTemplate("views/srp-compare.html",function(c){if(!b.templateInserted){b.templateInserted=!0;M.SearchBox.Util.randomAppend(document.body,c);$("#"+p("huoyan-wrapper")).mouseenter(function(){b.clearHideIconTimer();b.clearHidePopupTimer()}).mouseleave(function(){b.hidePopup();b.hideIcon()});$("#"+p("fast-compare")).delegate("."+p("fc-item-link"),"click",
function(){var a=$(this).attr("data-click-url");M.browser.extension.sendRequest({topic:"tab_open",url:a});M.SearchBox.Util.sendLog("click_compare",a+"|"+oa.getLocationHref(Xa))});$("#"+p("fc-product-link")).click(function(){b.searchResult&&("undefined"!=typeof b.searchResult.Product&&"undefined"!=typeof b.searchResult.Product.DetailPageURL)&&(M.SearchBox.Util.sendLog("click_compare",b.searchResult.Product.DetailPageURL),window.open(b.searchResult.Product.DetailPageURL))});var d=null;$("#"+p("hy-price-curve-plot")).bind("plothover",
function(a,c,h){h?d!=h.dataIndex&&(d=h.dataIndex,b.hideTip(),a=new Date(h.datapoint[0]),a=a.getFullYear()+"/"+(a.getMonth()+1)+"/"+a.getDate(),c=h.datapoint[1].toFixed(2),c="\uffe5 "+oa.addThousandSeparator(c),b.showTip(a,c,h.pageX,h.pageY)):(b.hideTip(),d=null)});$("#"+p("fc-share")).click(function(){if(b.searchResult&&"undefined"!=typeof b.searchResult.Item&&"undefined"!=typeof b.searchResult.Item.DetailPageURL){var a=b.searchResult.Item,c=a.DetailPageURL,d=a.SmallImageUrl.replace("_80x80.jpg",
""),j=M.Share.getContentTemplate("ca",{productTitle:"\u201c"+a.Title+"\u201d"}),a=b.priceComparationInfo;a.valid&&0!=a.priceDiff&&(j="pk_"+a.type,j=M.Share.getContentTemplate(j,a));var l={custom:!0,siteId:"sina_weibo",text:j,url:c},c=M.Share;c.supportCaptureShare?(l.imageType="capture",M.Share.calcCaptureDataForFastCompare(b.currentImageElement,function(a){l.imageWidth=a.width;l.imageHeight=a.height;l.top=a.top;l.left=a.left;M.Share.handleRequest(l)})):(l.imageUrl=d,c.supportSimpleShare?l.imageType=
"simple":l.custom=!1,M.Share.handleRequest(l))}});$("#"+p("huoyan-icon")).mouseenter(function(){b.clearHideIconTimer();b.showPopup()}).mouseleave(function(){b.hideIcon(b.hideDelay);b.hidePopup(b.hideDelay)});$("#"+p("hy-ivy-wants-text")).click(function(){b.openUserHomepage(b.currentItemId)});$("#"+p("hy-ivy-want-btn")).click(function(){$(this).hasClass(p("bought"))||(b.wantThis(b.currentProductLink),M.SearchBox.Util.sendLog("click_compare",b.currentProductLink))});a&&"function"==typeof a&&a();$("#"+
p("hy-tag-list")).click(function(){oa.openTab($(this).attr("data-href"),!0)})}})},filterPriceHistoryData:function(a,b){var c=0;if(a){for(var d=0,e=0,f=a.length;e<f;e++)a[e][0]*=1E3,a[e][0]>d&&(d=a[e][0]),null==a[e][1]&&(a[e][1]=aa,c++);c=new Date;(f=b||"")||(f=a[a.length-1][1]);d=new Date(parseInt(d));f&&(c.getMonth()==d.getMonth()?c.getDate()!=d.getDate()&&(a[e]=[c.getTime(),f]):a[e]=[c.getTime(),f])}return a},renderPlot:function(a,b){var c=b.Price.replace(/\uffe5|\s/g,""),c=parseFloat(c);if((a=
this.filterPriceHistoryData(a,c))&&0<a.length){var d=$("#"+p("hy-price-curve-plot")),e=this;try{this.drawPlot(a,d)}catch(f){M.console.debug("draw plot error: "+f.message),setTimeout(function(){try{e.drawPlot(a,d)}catch(b){M.console.debug("draw plot error again: "+b.message)}},0)}var c=this.getPrice(a,"max"),h=this.getPrice(a,"min");this.setPrices(h,c,b.nid)}},getPrice:function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)a[d][1]&&c.push(a[d][1]);return Math[b].apply(null,c)},setPrices:function(a,b,c){a=
this.getPriceInfoTemplate(this.formatNum(a),this.formatNum(b),c);$("#"+p("hy-pc-price-info")).html(a)},drawPlot:function(a,b){var c=new Date,d=c.getTime();c.setMonth(c.getMonth()-3);c.setDate(c.getDate()-1);var c=c.getTime(),e=this.getPrice(a,"max"),f=this.getPrice(a,"min"),h;1>e-f&&(h=2);d={series:{lines:{show:!0,lineWidth:1,steps:!0},points:{show:!0,radius:2,lineWidth:0,fillColor:"#faaa2b"},color:"#fab13c",shadowSize:1},grid:{hoverable:!0,backgroundColor:"#fff",borderWidth:1,borderColor:"#d1e3ea",
tickColor:"#d1e3ea",labelMargin:8},xaxis:{min:c,max:d,mode:"time",timeformat:"%0m/%0d",tickSize:[15,"day"]},yaxis:{minTickSize:5,tickDecimals:h,tickFormatter:this.formatNum}};try{b.data("plot")}catch(j){M.console.debug("destroy plot error: "+j.message)}$.plot(b,[a],d)},showTip:function(a,b,c,d){var e=this.getPriceCurveTipTemplate();$(document.body).append(e);b="\u4ef7\u683c\uff1a"+b;$("#"+p("hy-current-point-date")).text("\u65e5\u671f\uff1a"+a);$("#"+p("hy-current-point-price")).text(b);var a=$("#"+
p("hy-price-curve-tip")),b=a.outerWidth(),e=a.outerHeight(),f=c-b/2,h=(b-8)/2,j=document.documentElement.clientWidth;f+b>j&&(f=j-b,h=b-(j-c)-4);a.css({top:d-e-15,left:f}).addClass(p("hy-tip-visible"));$("#"+p("hy-price-curve-arrow-down")).css("left",h)},hideTip:function(){$("#"+p("hy-price-curve-tip")).remove()},formatNum:function(a){a=Math.round(100*a)/100;return a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")},getPriceCurveTipTemplate:function(){return'<div id="'+p("hy-price-curve-tip")+'" ><div id="'+
p("hy-current-point-date")+'"></div><div id="'+p("hy-current-point-price")+'"></div><div id="'+p("hy-price-curve-arrow-down")+'"></div></div>'},getWantCounts:function(a){var b=this;M.browser.extension.sendRequest({topic:"item_like_count",url:a},function(a){if(a.error)$("#"+p("huoyan-wrapper")).addClass(p("fetch-like-count-error"));else{$("#"+p("huoyan-wrapper")).removeClass(p("fetch-like-count-error"));var d=a.wanted,e=a.users;b.currentItemId=a.item_id;b.updateWantsStatus(e,d)}})},wantThis:function(a){var b=
this;M.browser.extension.sendRequest({topic:"item_like_add",url:a},function(a){a&&(a.success&&"undefined"!=typeof a.users)&&b.updateWantsStatus(a.users,!0)})},updateWantsStatus:function(a,b){var c="",c='<a class="'+p("ivy-wants-count")+'" target="_blank">';$("#"+p("hy-ivy-want-btn")).removeClass(p("bought"));a=parseInt(a);if(isNaN(a)||0>a)a=0;0==a?c="\u6210\u4e3a\u7b2c "+c+"1 \u4e2a</a>\u60f3\u4e70\u7684\u5982\u610f\u6dd8\u7528\u6237":b?(c=1==a?"\u4f60\u662f\u7b2c"+c+" 1 \u4e2a</a>\u60f3\u4e70\u7684\u5982\u610f\u6dd8\u7528\u6237":
"\u4f60\u4e0e\u5176\u4ed6"+c+(a-1)+" \u4e2a</a>\u5982\u610f\u6dd8\u7528\u6237\u90fd\u60f3\u4e70",$("#"+p("hy-ivy-want-btn")).addClass(p("bought"))):c="\u5982\u610f\u6dd8\u7528\u6237\u4e2d\u6709"+c+a+" \u4eba</a>\u60f3\u4e70";$("#"+p("hy-ivy-wants-text")).html(c)},openUserHomepage:function(a){M.browser.extension.sendRequest({topic:"item_like_open_homepage",item_id:a})},getPriceInfoTemplate:function(a,b){return'<span>\u6700\u9ad8\u4ef7\uff1a<span class="'+p("hy-highest-price")+'">\uffe5'+b+'</span></span><span>\u6700\u4f4e\u4ef7\uff1a<span class="'+
p("hy-lowest-price")+'">\uffe5'+a+"</span></span>"}};var kb=B,Vc=window,Wc=kb.SearchBox.Util;kb.CnaCookie={hostRegexp:/\b(taobao|etao|tmall)\.com/,init:function(){if(this.hostRegexp.test(Wc.getLocationProperty(Vc,"hostname"))){var a=kb.get_cookie("cna");a&&kb.browser.extension.sendRequest({topic:"set_cna_cookie",value:a})}}};var lb=B,Xc=window,Yc=lb.SearchBox.Util;lb.TracknickCookie={hostRegexp:/\b(taobao|etao|tmall)\.com/,init:function(){if(this.hostRegexp.test(Yc.getLocationProperty(Xc,"hostname"))){var a=
lb.get_cookie("tracknick");a&&lb.browser.extension.sendRequest({topic:"set_tracknick_cookie",value:a})}}};var Zc=B,H=function(){if(!(this instanceof H))return new H;this._callbacks={};this._fired={}};H.prototype.addListener=function(a,b){this._callbacks=this._callbacks||{};this._callbacks[a]=this._callbacks[a]||[];this._callbacks[a].push(b);return this};H.prototype.bind=H.prototype.addListener;H.prototype.on=H.prototype.addListener;H.prototype.await=H.prototype.addListener;H.prototype.removeListener=
function(a,b){var c=this._callbacks,d;if(a){if(c)if(b){var e=c[a];if(!e)return this;d=e.length;for(c=0;c<d;c++)if(b===e[c]){e[c]=null;break}}else c[a]=[]}else this._callbacks={};return this};H.prototype.unbind=H.prototype.removeListener;H.prototype.removeAllListeners=function(a){return this.unbind(a)};H.prototype.trigger=function(a,b){var c,d,e,f,h,j,l=2;if(!(d=this._callbacks))return this;for(;l--;)if(c=l?a:"all",c=d[c]){h=0;for(j=c.length;h<j;h++)(e=c[h])?(f=l?Array.prototype.slice.call(arguments,
1):arguments,e.apply(this,f)):(c.splice(h,1),h--,j--)}return this};H.prototype.emit=H.prototype.trigger;H.prototype.fire=H.prototype.trigger;H.prototype.once=function(a,b){var c=this,d=function(){b.apply(c,arguments);c.unbind(a,d)};this.bind(a,d);return this};H.prototype.immediate=function(a,b,c){this.bind(a,b);this.trigger(a,c);return this};var jc=function(a,b,c,d){var e=this,f,h=0,j=arguments.length,l,p,t,s,g=0,u={};if(3>j)return this;t=Array.prototype.slice.apply(arguments,[0,j-2]);p=arguments[j-
2];s=arguments[j-1];if("function"!==typeof p)return this;f=t.length;j=function(a){e[s?"once":"bind"](a,function(b){e._fired[a]=e._fired[a]||{};e._fired[a].data=b;u[a]||(u[a]=!0,g++)})};for(h=0;h<f;h++)j(t[h]);l=function(){if(!(g<f)){var a=[];for(h=0;h<f;h++)a.push(e._fired[t[h]].data);s&&e.unbind("all",l);p.apply(null,a)}};e.bind("all",l)};H.prototype.all=function(a,b,c){var d=Array.prototype.concat.apply([],arguments);d.push(!0);jc.apply(this,d);return this};H.prototype.assign=H.prototype.all;H.prototype.tail=
function(){var a=Array.prototype.concat.apply([],arguments);a.push(!1);jc.apply(this,a);return this};H.prototype.assignAll=H.prototype.tail;H.prototype.assignAlways=H.prototype.tail;H.prototype.after=function(a,b,c){if(0===b)return c.call(null,[]),this;var d=this,e=[],f;f=function(h,j){h===a&&(b--,e.push(j),1>b&&(d.unbind("all",f),c.apply(null,[e])))};d.bind("all",f);return this};H.prototype.any=function(){var a=this,b,c,d=arguments.length;b=arguments[d-1];var d=Array.prototype.slice.apply(arguments,
[0,d-1]),e=d.length,f=d.join("_");a.once(f,b);c=function(b){a.bind(b,function(c){a.trigger(f,{data:c,eventName:b})})};for(b=0;b<e;b++)c(d[b])};H.prototype.not=function(a,b){this.bind("all",function(c,d){c!==a&&b(d)})};H.create=function(){var a=new H;arguments.length&&a.assign.apply(a,Array.prototype.slice.call(arguments));return a};Zc.EventProxy=H;var ja=B,kc=document,mb=ja.SearchBox.Util,lc=ja.SearchBox.Tmpl,W=ja.transform_selector,$c=mb.getLocationHref(window),X=function(a){if(a)for(var b in a)a.hasOwnProperty(b)&&
(this[b]=a[b])};X.prototype.getCurrentPrice=function(){};X.prototype.destoryTemplateWrapper=function(){this.templateWrapper&&(this.templateWrapper.remove(),delete this.templateWrapper)};ja.PriceCurve={proxy:null,nodataClass:W("price-curve-no-data"),buttonDom:"#"+W("like-button-price-curve"),site:null,sites:{"tmall.com":new X,"taobao.com":new X,"360buy.com":new X,"dangdang.com":new X,"suning.com":new X({getCurrentPrice:function(){var a=$("#netPrice em").text();if(a&&a.match(/\d+\.\d+/))return a}}),
"gome.com.cn":new X({getCurrentPrice:function(){var a=$(".info .price b");if((a=0<a.size()?a.text():"")&&a.match(/\d+\.\d+/))return a}}),"coo8.com":new X,"yhd.com":new X({getCurrentPrice:function(){var a=0<$("#current_price").size()?$("#current_price").text():$("#nonMemberPrice").text();if(a&&a.match(/\d+\.\d+/))return a}}),"51buy.com":new X({getCurrentPrice:function(){var a=0<$("#goods_detail_mate .item_icson .price_font").size()?$("#goods_detail_mate .item_icson .price_font").text():"";if(a&&a.match(/\d+\.\d+/))return a}}),
"yixun.com":new X({getCurrentPrice:function(){var a=0<$("#goods_detail_mate .item_icson .price_font").size()?$("#goods_detail_mate .item_icson .price_font").text():"";if(a&&a.match(/\d+\.\d+/))return a}}),"amazon.cn":new X,"vancl.com":new X,"vjia.com":new X,"lefeng.com":new X,"newegg.cn":new X,"xiu.com":new X,"jumei.com":new X},copyStyle:function(a,b,c){var d={},e=0;for(len=c.length;e<len;e++)d[c[e]]=b.css(c[e]);a.css(d)},init:function(a){this.mode=a;this._init()},_init:function(){var a=this,b=ja.site.get_site(ja.site.get_domain(kc));
this.sites["jd.com"]=this.sites["360buy.com"];this.sites.hasOwnProperty(b)&&(this.site=this.sites[b],$(this.buttonDom).css("display","block"),this.site.insertTemplate=function(a){var b=$("body"),e=this.templateWrapper=$("<div/>");e.addClass(W("price-curve-protection"));e.appendTo(b).append(a);return!0},ja.SearchBox.Util.loadJQuery(),ja.SearchBox.Util.getTemplate("views/price-curve.html",function(b){a.site.insertTemplate(b)&&(a.proxy=new ja.EventProxy,a.proxy.assign("priceHistoryData",function(){a.render.apply(a,
arguments);a.bindEvents.apply(a)}),a.getPriceHistoryData())}))},destory:function(){$("#"+W("price-curve")).remove();$("#"+W("price-curve-style")).remove()},render:function(a){this.hideLoading();if(a){var b=$("#"+W("price-curve-plot")),c=this,d=this.filterPriceHistoryData(a.Item.Prices);try{this.drawPlot(d,b)}catch(e){$.browser.msie&&9<=$.browser.version||(ja.console.debug("draw plot error: "+e.message),setTimeout(function(){try{c.drawPlot(d,b)}catch(a){ja.console.debug("draw plot error again: "+a.message),
$("#"+W("price-curve")).remove()}},0))}var f=this.getPrice(d,"max"),h=this.getPrice(d,"min");this.setPrices(h,f,a.Item.nid)}else this.handleNoPriceData()},getPriceHistoryData:function(){var a=this;ja.browser.extension.sendRequest({topic:"get_price_history_data",url:$c},function(b){a.proxy.trigger("priceHistoryData",b)})},filterPriceHistoryData:function(a){var b=0;if(a){for(var c=0,d=0,e=a.length;d<e;d++)a[d][0]*=1E3,a[d][0]>c&&(c=a[d][0]),null==a[d][1]&&(a[d][1]=aa,b++);var f=new Date,h=this.site.getCurrentPrice();
h||(h=a[a.length-1][1]);c=new Date(parseInt(c));h&&(f.getMonth()==c.getMonth()?f.getDate()!=c.getDate()&&(a[d]=[f.getTime(),h]):a[d]=[f.getTime(),h]);if(2>a.length||b==e)a=null}return a},getPrice:function(a,b){for(var c=[],d=0,e=a.length;d<e;d++)a[d][1]&&c.push(a[d][1]);return Math[b].apply(null,c)},setPrices:function(a,b,c){a=lc.getPriceInfoTemplate(this.formatNum(a),this.formatNum(b),c);$("#"+W("pc-price-info")).html(a)},drawPlot:function(a,b){var c=new Date,d=c.getTime();c.setMonth(c.getMonth()-
3);c.setDate(c.getDate()-1);var c=c.getTime(),e=this.getPrice(a,"max"),f=this.getPrice(a,"min"),h;1>e-f&&(h=2);$.plot(b,[a],{series:{lines:{show:!0,lineWidth:1,steps:!0},points:{show:!0,radius:2,lineWidth:0,fillColor:"#faaa2b"},color:"#fab13c",shadowSize:1},grid:{hoverable:!0,backgroundColor:"#fff",borderWidth:1,borderColor:"#d1e3ea",tickColor:"#d1e3ea",labelMargin:8},xaxis:{min:c,max:d,mode:"time",timeformat:"%0m/%0d",tickSize:[15,"day"]},yaxis:{minTickSize:5,tickDecimals:h,tickFormatter:this.formatNum}})},
bindEvents:function(){var a=this,b={timer:null,clear:function(){this.timer&&(clearTimeout(this.timer),delete this.timer)},set:function(a){this.clear();this.timer=a}};$(this.buttonDom).bind("mouseenter",function(){b.clear();a.show();mb.sendLog("hover_price",mb.getLocationHref())}).bind("mouseleave",function(){b.set(setTimeout($.proxy(a.hide,a),50))});$("#"+W("price-curve")).bind("mouseenter",function(){b.clear()}).bind("mouseleave",function(){b.set(setTimeout($.proxy(a.hide,a),50))});var c=null;$("#"+
W("price-curve-plot")).bind("plothover",function(b,e,f){f?c!=f.dataIndex&&(c=f.dataIndex,a.hideTip(),b=new Date(f.datapoint[0]),b=b.getFullYear()+"/"+(b.getMonth()+1)+"/"+b.getDate(),e=f.datapoint[1].toFixed(2),e="\uffe5 "+mb.addThousandSeparator(e),a.showTip(b,e,f.pageX,f.pageY)):(a.hideTip(),c=null)})},handleNoPriceData:function(){$("#"+W("no-price-history-info")).show();$("#"+W("price-curve-plot")).hide()},hideLoading:function(){$("#"+W("price-curve-loading")).hide()},adjustPosition:function(){var a=
$("#"+W("price-curve")),b=$(this.buttonDom),c=b.offset(),d=b.outerWidth(),b=b.outerHeight(),b=c.top+b+5,e=c.left+d-a.outerWidth();this.mode==ja.IvyWantBuy.mode.LINE2&&(e=c.left,$("#"+W("price-curve-arrow")).css({left:d/2-4+"px",right:"auto"}));a.css({top:b+"px",left:e+"px",left:e+127+"px"})},show:function(){this.adjustPosition();$("#"+W("price-curve")).show()},hide:function(){$("#"+W("price-curve")).hide()},showTip:function(a,b,c,d){var e=lc.getPriceCurveTipTemplate();$(kc.body).append(e);b="\u4ef7\u683c\uff1a"+
b;$("#"+W("current-point-date")).text("\u65e5\u671f\uff1a"+a);$("#"+W("current-point-price")).text(b);a=$("#"+W("price-curve-tip"));b=a.outerWidth();e=a.outerHeight();a.css({top:d-e-15,left:c-b/2}).addClass(W("tip-visible"));$("#"+W("price-curve-arrow-down")).css("left",(b-8)/2)},hideTip:function(){$("#"+W("price-curve-tip")).remove()},formatNum:function(a){a=Math.round(100*a)/100;return a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}};var O=B,nb=O.SearchBox.Util,P=O.transform_selector,Ma=
nb.getLocationHref(window);nb.getLocationProperty(window,"hostname");var ea=P("like-button-protection"),ba=function(a){this.getWrapper=a};ba.prototype.insertTemplate=function(a){return!(!this.getWrapper||!(this.templateWrapper=this.getWrapper(a)))};ba.prototype.destoryTemplateWrapper=function(){this.templateWrapper&&(this.templateWrapper.remove(),delete this.templateWrapper,delete this.getWrapper)};var Bb=O.PageEvent;O.IvyWantBuy={showPriceAlertSettingsTip:!1,site:null,sites:{"tmall.com":new ba(function(a){var b=
$("#J_DetailMeta .tb-key");if(0<b.size()){var c=$("<div></div>").css("padding-top","15px");c.addClass(ea);b.prepend(c.append(a));return c}}),"taobao.com":new ba(function(a){var b=$("#J_PromoPrice"),b=0>=b.length?$("#J_StrPriceModBox"):b;if(0<b.size()){var c=$("<li></li>");c.addClass(ea);c.insertAfter(b).append(a);return c}}),"jd.com":new ba(function(a){var b=$("#summary-price");b.length||(b=$("#priceinfo").parent());if(0<b.size()){var c=$("<li></li>");c.addClass(ea);c.insertAfter(b).append(a);return c}}),
"dangdang.com":new ba(function(a){var b=0<$("#d_price").size()?$("#d_price").parent():$(".show_info .m_price").parent();if(0<b.size()){var c=$("<div></div>");c.addClass(ea);c.insertAfter(b).append(a);return c}}),"suning.com":new ba(function(a){var b=$(".product-info-type .sn-price:last");if(0<b.size()){var c=$("<li></li>");c.addClass(ea);c.insertAfter(b).append(a);return c}}),"gome.com.cn":new ba(function(a){var b=$("#amount");if(0<b.size()){var c=$("<li/>");c.addClass(ea);O.IvyWantBuy.copyStyle(c,
b,["width"]);c.insertAfter(b).append(a);return c}}),"coo8.com":new ba(function(a){var b=$("#c8InfoData");if(0<b.size()){var c=$("<li/>");c.addClass(ea);c.insertAfter(b).append(a);return c}}),"yhd.com":new ba(function(a){var b=$("#currentPriceArea");if(0<b.size()){var c=$("<div></div>");c.addClass(ea);c.insertAfter(b).append(a);return c}}),"1mall.com":new ba(function(a){var b=$(".specific_info1:first");if(0<b.size()){var c=$("<div></div>");c.addClass(ea);c.css({marginLeft:14});c.insertAfter(b).append(a);
return c}}),"yixun.com":new ba(function(a){var b=$(".xbase_item.xprice:last");if(0<b.size()){var c=$("<div/>");c.addClass(ea);O.IvyWantBuy.copyStyle(c,b,["marginBottom"]);c.insertAfter(b).append(a);return c}}),"amazon.cn":new ba(function(a){var b=$("#actualPriceRow").parent();if(0<b.size()){var c=$("<tr/>");c.addClass(ea);c.appendTo(b).append($('<td colspan="2"></td>').append(a));return c}}),"vancl.com":new ba(function(a){var b=$(".MSpriceArea");if(0<b.size()){var c=$("<div/>").css("marginTop","10px");
c.addClass(ea);c.insertAfter(b).append(a);return c}}),"vjia.com":new ba(function(a){var b=$("#MarketPrice"),b=0<b.length?b.parent("li"):$("#SellPrice").parent("li");if(0<b.size()){var c=$("<li/>").css("clear","both");c.addClass(ea);c.insertAfter(b).append(a);return c}}),"lefeng.com":new ba(function(a){var b=$(".messagenu");if(0<b.size()){var c=$("<p/>");c.addClass(ea);c.insertBefore(b).append(a);return c}}),"newegg.cn":new ba(function(a){var b=$(".goods_price_now");if(0<b.size()){var c=$("<li/>");
c.addClass(ea);c.insertAfter(b).append(a);return c}}),"xiu.com":new ba(function(a){var b=$(".col1.xs2");0==b.length&&(b=$(".col1.layer12"));if(0<b.size()){var c=$("<p/>").css("clear","both");c.addClass(ea);c.insertAfter(b).append(a);return c}}),"jumei.com":new ba(function(a){var b=$(".info .productinfo_righttop .price");if(0<b.size()){var c=$("<div/>");c.addClass(ea);c.insertAfter(b).append(a);return c}})},copyStyle:function(a,b,c){var d={},e=0;for(len=c.length;e<len;e++)d[c[e]]=b.css(c[e]);a.css(d)}};
O.IvyWantBuy.mode={DEFAULT:"like-button-mode-default",LINE2:"like-button-mode-line2"};O.IvyWantBuy.checkMode=function(){return this.mode.DEFAULT};O.IvyWantBuy.init=function(){var a=this,b=O.site.get_site(O.site.get_domain(document));this.sites.hasOwnProperty(b)&&"amazon.cn"!=b&&(this.site=this.sites[b],async.parallel({historyData:function(a){O.browser.extension.sendRequest({topic:"get_price_history_data",url:Ma},function(b){a(null,b)})},likeCount:function(a){O.browser.extension.sendRequest({topic:"item_like_count",
url:Ma},function(b){b.users=b.users||0;a(null,b)})}},function(b,d){var e=d.likeCount,f=d.historyData;if(!e.error){var h=e.item_id,j=f.Item.nid;nb.loadJQuery();if(!(0<$("#"+P("like-button")).size())){nb.getTemplate("views/like-button.html",function(b){var b=O.compile(b),c=[{"class":P("like-button-price-stability"),text:"\u4ef7\u683c\u5e73\u7a33"},{"class":P("like-button-price-bottom"),text:"\u5386\u53f2\u6700\u4f4e"},{"class":P("like-button-price-down"),text:"\u4ef7\u683c\u4e0b\u964d"},{"class":P("like-button-price-up"),
text:"\u4ef7\u683c\u4e0a\u6da8"},{"class":P("like-button-price-stable"),text:"\u4ef7\u683c\u6ce2\u52a8"}];e.PriceState=f.Item.PriceTrend?c[f.Item.PriceTrend]:!1;b=$(b.render(e));a.site.insertTemplate(b)&&(O.PriceCurve.init(a.checkMode()),O.SearchBox.Util.sendLog("show_detail_want",Ma),$("#"+P("like-button-outer"),b).click(l),$("#"+P("like-button-spec"),b).click(t),Bb.fire({type:"likeButtonRender",data:e}))});var l=function(b){b.preventDefault();var b=$("#"+P("like-button-outer")),c=$("#"+P("like-button-content")),
d="";"1"==b.data("wanted")?(b.data("wanted","0"),d=$("#"+P("like-button-content-wanted-tpl")).val(),c.html(d),O.browser.extension.sendRequest({topic:"item_like_delete",url:Ma},function(a){a.success&&($("#"+P("price-alert-settings-tip")).hide(),$("#"+P("like-button-num")).html(a.users),Bb.fire({type:"unlike"}))})):(b.data("wanted","1"),d=$("#"+P("like-button-content-tpl")).val(),c.html(d),O.browser.extension.sendRequest({topic:"item_like_add",url:Ma},function(b){if("undefined"!=typeof b.users){p(!0,
b.users);$(document.body).append($("#"+P("like-button-plusone")).val());var c=$("."+P("like-button-plusone")),d=$("#"+P("like-button-outer")).offset();c.css({left:d.left+50,top:d.top});setTimeout(function(){c.addClass(P("like-button-animation")).css({top:d.top-70,opacity:0})},0);a.showPriceAlertSettingsTip&&$("#"+P("price-alert-settings-tip")).show();Bb.fire({type:"like"});O.SearchBox.Util.sendLog("click_detail_want",Ma)}}));a.showPriceAlertSettingsTip&&$("#"+P("price-alert-settings-link")).click(function(){O.browser.extension.sendRequest({topic:"set_price_alert_settings_tip"});
$("#"+P("price-alert-settings-tip")).hide()})},p=function(a,b){$("#"+P("like-button-outer"))[a?"addClass":"removeClass"](P("like-button-disabled"));$("#"+P("like-button-num")).html(b);a&&$("#"+P("price-alert-settings-tip")).css({display:"block"})},t=function(){O.browser.extension.sendRequest({topic:"item_like_open_homepage",item_id:h,nid:j});return!1},s=O.browser.runtime?O.browser.runtime.onMessage:O.browser.extension.onRequest;s&&s.addListener(function(a){switch(a.topic){case "update_wants_status":a.status&&
a.status.item_id==h&&p(a.status.wanted,a.status.users)}})}}}),O.browser.extension.sendRequest({topic:"get_price_alert_settings_tip"},function(b){a.showPriceAlertSettingsTip=b}))};var Ya=B,mc=Ya.transform_selector,Cb=Ya.PageEvent,Db=Ya._;Ya.likeSuccess={init:function(){this._initEvent()},_initEvent:function(){Cb.on("like",Db.bind(this._like,this));Cb.on("unlike",Db.bind(this._unlike,this));Cb.on("listRenderSuccess",Db.bind(this._initDom,this))},_initDom:function(){this._tips=$("#"+mc("like-success"));
this._counter=$("#"+mc("wantedcount"))},_like:function(){this._show();this._inc()},_unlike:function(){this._dec()},_show:function(){var a=this;this._tips.css({display:"block"});setTimeout(function(){a._tips.css({opacity:"1"});a._tips.css({bottom:"83px"})},0);setTimeout(function(){a._tips.css({bottom:"53px"});a._tips.css({opacity:"0"})},1E3);setTimeout(function(){a._tips.css({display:"none"})},1E3)},_inc:function(){var a=+this._counter.html();this._counter.html(a+1)},_dec:function(){var a=+this._counter.html();
this._counter.html(0<a?a-1:0)}};Ya.likeSuccess.init();var sa=B,nc=window,oc=document,ta=sa.SearchBox.Util,A=sa.transform_selector,ca=sa.Share={currentSiteId:"",popupShowed:!1,shortUrl:"",imageUrl:"",supportCaptureShare:!1,supportSimpleShare:!1,contentTemplates:{ca:"\u5546\u5bb6\u4fc3\u9500\u8ff7\u4eba\u773c\uff0c\u5f3a\u70c8\u63a8\u8350\u5927\u5bb6\u4f7f\u7528@\u5982\u610f\u6dd8\uff0c\u770b\u5b8c\u5386\u53f2\u4ef7\u683c\u66f2\u7ebf\uff0c\u8fd8\u80fd\u8fdb\u884c\u591a\u7ad9\u6bd4\u4ef7\uff0c\u4ece\u6b64\u4e0d\u518d\u88ab\u5ffd\u60a0\u3002\u6211\u521a\u7528@\u5982\u610f\u6dd8 \u67e5\u4e86${productTitle} #\u5982\u610f\u6dd8OK\u8d2d#\uff08\u4e0b\u8f7d\u5730\u5740\uff1ahttp://t.cn/aeDbuE\uff09 {{{url}}}",
pk_expensive:"\u5751\u7239\u554a\uff0c\u521a\u7528\u6bd4\u4ef7\u795e\u5668@\u5982\u610f\u6dd8 \u53d1\u73b0${currentMerchantName}\u7684${productTitle}\u5356${currentPrice}\u5143\uff0c\u6bd4${relativeMerchantName}\u8d35\u4e86${priceDiff}\u5143\u554a\uff01{{{url}}} \u62d2\u82b1\u51a4\u6789\u94b1\uff0c\u6bd4\u51fa\u771f\u5b9e\u60e0 #\u5982\u610f\u6dd8OK\u8d2d#\uff08\u4e0b\u8f7d\u5730\u5740\uff1ahttp://t.cn/aeDbuE\uff09",pk_cheap:"\u6211\u561e\u4e2a\u53bb\uff01\u521a\u7528\u6bd4\u4ef7\u795e\u5668@\u5982\u610f\u6dd8 \u53d1\u73b0${currentMerchantName}\u7684${productTitle}\u6700\u4fbf\u5b9c\uff0c\u5356${currentPrice}\u5143\uff0c\u6bd4\u7b2c\u4e8c\u540d${relativeMerchantName}\u4fbf\u5b9c\u4e86${priceDiff}\u5143\uff01{{{url}}} \u62d2\u82b1\u51a4\u6789\u94b1\uff0c\u6bd4\u51fa\u771f\u5b9e\u60e0 #\u5982\u610f\u6dd8OK\u8d2d#\uff08\u4e0b\u8f7d\u5730\u5740\uff1ahttp://t.cn/aeDbuE\uff09 {{{url}}}"},
init:function(){var a=this,b=ta.getLocationHref(window);"http://ruyi.taobao.com/service/access-token-callback.html"!==b&&0==b.indexOf("http://ruyi.taobao.com/service/access-token-callback.html")&&sa.browser.extension.sendRequest({topic:"callback_share_authorization",url:b});this.checkCustomShareSupport(function(b){a.supportSimpleShare=b.simple;a.supportCaptureShare=b.capture});sa.browser.extension.onRequest.addListener(function(b){switch(b.topic){case "short_url":a.shortUrl=b.shortUrl;a.handleResponse();
break;case "capture_image_data":a.imageUrl=b.imageData,a.handleResponse()}})},destory:function(){$("."+A("share-protection")).remove()},insertTemplate:function(a){$("#"+A("share-wrapper")).length?a&&a():ta.getTemplate("views/share.html",function(b){$(oc.body).append(b);sa.Share.View.bindEvents();a&&a()})},getContentTemplate:function(a,b){var c=this.contentTemplates[a];if(c)for(var d in b)c=c.replace("${"+d+"}",b[d]);else c="";return c},checkCustomShareSupport:function(a){sa.browser.extension.sendRequest({topic:"support_custom_share"},
a)},handleRequest:function(a){if(a.custom){if(!this.popupShowed){var b=this;this.insertTemplate(function(){b.currentSiteId=a.siteId;b.text=a.text;"simple"==a.imageType&&(b.imageUrl=a.imageUrl,b.handleResponse());if("capture"==a.imageType||a.url)a.topic="handle_share_request",sa.browser.extension.sendRequest(a)})}}else this.nativeShare(a)},handleResponse:function(){if(this.shortUrl&&this.imageUrl){var a=this.text.replace("{{{url}}}",this.shortUrl);ca.View.setContent(a);ca.View.setImage(this.imageUrl);
ca.View.show();ca.View.showForm();ca.View.enableShareBtn();ca.View.setPosition();this.imageUrl=this.shortUrl=""}},countLetterNumber:function(a){for(var a=$.trim(a),b=0,c=0,d=a.length;c<d;c++)b=127>=a.charCodeAt(c)?b+0.5:b+1;return Math.ceil(b)},getZoomLevel:function(){return document.width?document.width/$(oc).width():1},calcCaptureDataForFastCompare:function(a,b){var c=$("#"+A("huoyan-wrapper")),d=this.getZoomLevel(),e=ta.getViewPortWidth()*d,f=ta.getViewPortHeight()*d,h=ta.getScrollPosition(),j=
h.top,h=h.left,l=a.outerWidth()*d,p=a.outerHeight()*d,t=c.outerWidth()*d,s=c.outerHeight()*d,g=a.offset(),c=c.offset(),u=Math.max(p,s)+60,y=l+t+6+20,B=Math.min(g.top*d,c.top*d)-j*d-15,v;v=c.left<g.left?c.left*d-h*d-10:g.left*d-h*d-10;0>v&&(h+=v,v=0);0>B&&(j+=B,B=0);v+y>e&&(h+=v+y-e,v=e-y);B+u>f&&(j+=B+u-f,B=f-u);nc.scrollTo(h,j);setTimeout(function(){b({width:y,height:u,top:B,left:v})},50)},validate:function(){var a=$("#"+A("share-text")).val(),a=this.countLetterNumber(a);return 0>=a||140<a?!1:!0},
getImageData:function(){var a=$("#"+A("share-image")).attr("src"),b=a.indexOf("base64,");return atob(a.substr(b+7))},getTextContent:function(){return $.trim($("#"+A("share-text")).val())},share:function(){if(this.validate()){var a={topic:"share",siteId:this.currentSiteId,followRuyitao:$("#"+A("follow-us")).get(0).checked},b=$("#"+A("share-image")).attr("src");0==b.indexOf("data:")?a.imageData=this.getImageData():a.imageUrl=b;a.textContent=this.getTextContent();sa.browser.extension.sendRequest(a,function(a){ca.View.hideForm();
ca.View.enableShareBtn();a.success?ca.View.showSuccessResult(a.shareLink):ca.View.showFailureResult(a.reason.text)})}else ca.View.warn(),ca.View.enableShareBtn()},nativeShare:function(a){if("sina_weibo"==a.siteId){var b={};b.title=a.text;b.pic=a.imageUrl;b.url=a.url;var a=encodeURIComponent,c=window.screen,d=[],e="http://v.t.sina.com.cn/share/share.php?";for(name in b)b.hasOwnProperty(name)&&d.push(name+"="+a(b[name]));d.push("appkey=1965387856");e+=d.join("&");window.open(e,"mb",["toolbar=0,status=0,resizable=1,width=620,height=450,left=",
(c.width-620)/2,",top=",(c.height-450)/2].join(""))}}};sa.Share.View={bindEvents:function(){function a(){var a=$(this).val(),a=ca.countLetterNumber(a);b.setRemainLetterNumber(a)}var b=this;$("#"+A("share-btn")).click(function(){ca.View.shareBtnEnabled&&(ca.View.disableShareBtn(),ca.share())});$("."+A("share-close-btn")).click(function(){ca.popupShowed=!1;b.hide();b.hideSuccessResult();b.hideFailureResult()});$("#"+A("share-return-btn")).click(function(){b.showForm();b.hideFailureResult()});var c=
$("#"+A("share-text"));if(c.get(0).oninput)c.on("input",a);else c.keyup(a);var d=null;$(nc).resize(function(){clearTimeout(d);d=setTimeout(function(){b.setPosition();b.setOverlaySize()},200)})},warn:function(){$("#"+A("share-text")).addClass(""+A("warning")).focus();setTimeout(function(){$("#"+A("share-text")).removeClass(""+A("warning"))},800)},setRemainLetterNumber:function(a){var b="",a=140-a,b=0>a?'\u5df2\u7ecf\u8d85\u8fc7<span id="'+A("remain-letter-number")+'"class="'+A("letter-overflow")+'">'+
-a+"</span>\u5b57":'\u8fd8\u53ef\u8f93\u5165<span id="'+A("remain-letter-number")+'">'+a+"</span>\u5b57";$("#"+A("remain-letter")).html(b)},setImage:function(a){$("#"+A("share-image")).attr("src",a)},setContent:function(a){$("#"+A("share-text")).val(a);a=ca.countLetterNumber(a);this.setRemainLetterNumber(a)},show:function(){ca.popupShowed=!0;var a=$("#"+A("share-wrapper"));a.show();setTimeout(function(){a.removeClass(""+A("share-wrapper-hidden")).addClass(""+A("share-wrapper-visible"))},0);this.showOverlay()},
hide:function(){var a=$("#"+A("share-wrapper"));a.removeClass(""+A("share-wrapper-visible")).addClass(""+A("share-wrapper-hidden"));setTimeout(function(){a.hide()},200);this.hideOverlay()},setPosition:function(){var a=$("#"+A("share-wrapper")),b=ta.getViewPortWidth(),c=ta.getViewPortHeight(),d=a.outerWidth(),e=a.outerHeight(),f=ta.getScrollPosition(),h=f.top,f=f.left;"fixed"==a.css("position")&&(f=h=0);b=Math.max((b-d)/2+f,0);c=Math.max((c-e)/2+h,0);a.css({top:c+"px",left:b+"px"})},showOverlay:function(){var a=
$("#"+A("share-overlay"));a.show();setTimeout(function(){a.removeClass(""+A("overlay-hidden")).addClass(""+A("overlay-visible"))},0);this.setOverlaySize()},hideOverlay:function(){$("#"+A("share-overlay")).removeClass(""+A("overlay-visible")).addClass(""+A("overlay-hidden"));setTimeout(function(){$("#"+A("share-overlay")).hide()},200)},setOverlaySize:function(){var a=ta.getViewPortWidth(),b=ta.getViewPortHeight();$("#"+A("share-overlay")).width(a).height(b)},showForm:function(){$("#"+A("share-form")).show()},
hideForm:function(){$("#"+A("share-form")).hide()},showSuccessResult:function(a){$("#"+A("check-out-share")).attr("href",a);$("#"+A("share-success")).show()},hideSuccessResult:function(){$("#"+A("share-success")).hide()},showFailureResult:function(a){$("#"+A("share-failure-reason")).text(a);$("#"+A("share-failure")).show()},hideFailureResult:function(){$("#"+A("share-failure")).hide()},shareBtnEnabled:!0,enableShareBtn:function(){this.shareBtnEnabled=!0;$("#"+A("share-btn")).removeClass(""+A("share-btn-disabled")).addClass(""+
A("share-btn-enabled"))},disableShareBtn:function(){this.shareBtnEnabled=!1;$("#"+A("share-btn")).removeClass(""+A("share-btn-enabled")).addClass(""+A("share-btn-disabled"))}};var Na=B,Eb=Na.SearchBox.Util,pc=[],bd=function(a){if(a){var b=Eb.getLocationHref(window),c;for(c in a)if(a.hasOwnProperty(c))for(var d=a[c],e=0,f=d.length;e<f;e++){var h=d[e];RegExp(h.url,"i").test(b)&&(Eb.loadJQuery(),h.wait?ad(h,b,c,h.wait):h.repeat?qc(h,b,c,h.repeat):Fb(h,b,c))}}},ad=function(a,b,c,d){setTimeout(function(){Fb(a,
b,c)},d)},qc=function(a,b,c,d){setTimeout(function(){Fb(a,b,c);qc(a,b,c,d)},d)},Fb=function(a,b,c){if(0!=$(a.selector).size()){var d=[];$.each($(a.selector),function(a,b){-1==$.inArray(b,pc)&&(pc.push(b),d.push(b.innerHTML))});0<d.length&&Na.browser.extension.sendRequest({topic:"ivy_send_user_collection",type:c,source_url:b,collections:d})}};Na.SyncOrder={init:function(){Na.browser.extension.sendRequest({topic:"oauth_is_authorized"},function(a){a&&Na.browser.extension.sendRequest({topic:"options_get",
options:["sync_order"]},function(a){a.sync_order_result_setting&&Na.browser.extension.sendRequest({topic:"get_ivy_config",domain:Eb.getLocationProperty(window,"hostname")},bd)})})}};var va=B,ob=window,Gb=va.SearchBox.Util;va.Notification={TEMPLATE_URL:"http://ruyi.taobao.com/extension/ruyitao-notification",init:function(){if(!(ob.navigator.userAgent.match(/msie/i)&&"BackCompat"==document.compatMode)){var a=this;va.browser.extension.sendRequest({topic:"get_notification",url:Gb.getLocationHref(ob)},
function(b){b&&(va.SearchBox.Util.loadJQuery(),a.showNotification(b))})}},renderNotification:function(a){$("#ruyitao-notify-title").text(a.title);$("#ruyitao-notify-body").html(a.content);$("#ruyitao-notify").show();if("undefined"!=typeof a.width){var b=parseInt(a.width)||160,a=parseInt(a.height)||75;$("#ruyitao-notify-body").css({width:b,height:a});$("#ruyitao-notify").css({bottom:-1*(a+41),width:$("#ruyitao-notify-body").outerWidth()})}},bindEvents:function(a){$("#ruyitao-notify-cb").click(function(){va.browser.extension.sendRequest({topic:"set_notification",
id:a.id,status:$(this).is(":checked")?"close":""})});$("#ruyitao-notify-hide").click(function(){$("#ruyitao-notify").slideUp(500);va.browser.extension.sendRequest({topic:"set_notification",id:a.id,status:"hide"})})},slideUp:function(){var a=parseInt($("#ruyitao-notify").css("bottom")),b=null,c=Math.abs(a)/30,d,e=function(){0>a?(a+=c,$("#ruyitao-notify").css({bottom:a}),b=setTimeout(e,50)):b&&clearTimeout(b)},b=setTimeout(e,50),f=function(){d&&clearTimeout(d);d=setTimeout(function(){$("#ruyitao-notify").slideUp(500)},
6E4)};$("#ruyitao-notify").mouseenter(function(){d&&(clearTimeout(d),d=void 0)}).mouseleave(f);f()},trackEvents:function(a){va.SearchBox.Util.sendLog("showad_"+a.campaign+"_"+a.id,Gb.getLocationHref(ob));$("#ruyitao-notify .ruyitao-track-ad").click(function(){va.SearchBox.Util.sendLog("clickad_"+a.campaign+"_"+a.id,this.href+"|"+Gb.getLocationHref(ob))})},showNotification:function(a){var b=this;va.SearchBox.Util.getTemplate(a.template||b.TEMPLATE_URL,function(c){$(document.body).append(c);b.renderNotification(a);
b.bindEvents(a);b.slideUp();b.trackEvents(a)})}};var Hb=da.SearchBox.Util.getLocationHref();if(-1!=Hb.indexOf("ruyi.taobao.com"))for(var Ib=[{app:"ruyitao",redirect_uri:"http://ruyi.taobao.com/service/access-token-callback.html?app=ruyitao"},{app:"ivy",redirect_uri:"http://ruyi.taobao.com/service/access-token-callback.html?app=ivy"}],pb=0,cd=Ib.length;pb<cd;pb++)if(0==Hb.indexOf(Ib[pb].redirect_uri)){da.browser.extension.sendRequest({topic:"oauth_callback",redirect_url:Hb,application:Ib[pb].app});
break}var dd=window,Za=B,rc=Za.SearchBox.Util,ed=Za.transform_selector;Za.PriceAlertSettings={sites:{"jd.com":[{url:"t.jd.com/home/follow",parentSelector:".main .right .o-mt"},{url:"t.jd.com/product/followProductList.action",parentSelector:".main .right .o-mt"}],"taobao.com":[{url:"favorite.taobao.com/item_collect.htm",parentSelector:"#fav-class .mercury-map-wrap"},{url:"favorite.taobao.com/collectList.htm",parentSelector:"#tab"},{url:"cart.taobao.com/cart.htm",parentSelector:"#J_FloatBar .float-bar-wrapper .operations",
condition:function(){return""!=$.trim($("#J_OrderList").html())},delay:!0}]},init:function(){var a=Za.site.get_site(Za.site.get_domain(document));if(this.sites.hasOwnProperty(a))for(var b=dd.location.href,a=this.sites[a],c,d,e=0,f=a.length;e<f;e++)if(c=a[e],d=RegExp(c.url),d.test(b)){this.insertTemplate(c.parentSelector,c.delay);break}},insertTemplate:function(a,b,c){function d(){rc.getTemplate("views/price-aler-settings.html",function(b){$(a).append(b);e.bindEvents()})}var e=this;1==$(a).length?
d():b&&setTimeout(function(){1==$(a).length&&("function"==typeof c&&c()||!c)?d():setTimeout(function(){1==$(a).length&&("function"==typeof c&&c()||!c)&&d()},2E3)},2E3)},bindEvents:function(){$("#"+ed("price-alert-settings-link-wrapper")).click(function(){rc.openTab("http://ruyi.taobao.com/my/settings?utm_medium=ext&utm_source=ruyi",!0)})}};var Da=B,ka=Da.transform_selector,sc=Da.browser.runtime?Da.browser.runtime.onMessage:Da.browser.extension.onRequest;sc&&sc.addListener(function(a){switch(a.topic){case "show_price_mind_messages":var b=
a.messages,c=function(){for(var a="",c=0,h=b.length,h=3>h?h:3;c<h;c++)var j=b[c],l=parseFloat(j.original_price)-parseFloat(j.reduction_price),p='<li class="'+ka("pamb-message")+'" data-id='+j.id+">",p=p+('<div class="'+ka("pamb-product-img")+'"><img src="'+j.small_image+'" /></div>'),p=p+('<div class="'+ka("pamb-product-info")+'">'),p=p+('<div class="'+ka("pamb-product-title")+'">'+j.title+"</div>"),p=p+('<div class="'+ka("pamb-current-price-wrap")+'"><span>\u5df2\u7ecf\u964d\u5230\u4e86</span>'),
p=p+('<span class="'+ka("pamb-current-price")+'">\uffe5'+l.toFixed(2)+"</span></div>"),p=p+('<div class="'+ka("pamb-price-reduction-wrap")+'">\u964d\u4e86\uffe5'+j.reduction_price+"</div></div></li>"),a=a+p;$("#"+ka("pamb-messages")).html(a);d||($("#"+ka("pamb-messages")).delegate("."+ka("pamb-message"),"click",function(){var a=$(this).attr("data-id"),a="http://ruyi.taobao.com/item/"+encodeURIComponent(a)+"?utm_medium=ext&utm_source=ruyi";Da.SearchBox.Util.openTab(a,!0)}),$("#"+ka("pamb-close")).click(function(){var a=
$("#"+ka("pamb-wrapper")),b=a.outerHeight();a.css("bottom",-b+"px")}));$("#"+ka("pamb-wrapper")).css("bottom",0);Da.browser.extension.sendRequest({topic:"clear_unread_price_mind_messages"})};if(b&&0<b.length){var d=1==$(document.body).attr("data-ruyitao-price-mind-inserted");d?c():Da.SearchBox.Util.getTemplate("views/price-alert-messages-body.html",function(a){$(document.body).append(a).attr("data-ruyitao-price-mind-inserted",1);c&&c()})}}});var $a=B,fd=$a.transform_selector,gd=$a.PageEvent,hd=$a._;
$a.wantedCount={init:function(){this._initEvent()},_initEvent:function(){gd.on("listRenderSuccess",hd.bind(this._getData,this))},_initDom:function(){var a=fd("wantedcount");this._ele=$("#"+a)},_showData:function(a){this._ele.html(a.total_results)},_getData:function(){this._initDom();if(this._ele.length){var a=this;$a.browser.extension.sendRequest({topic:"get_wanted_count"},function(b){a._showData(b)})}}};var ab=B,bb=ab.transform_selector,tc=ab.PageEvent,qb=ab._;ab.listRespond={init:function(){tc.on("listRenderSuccess",
qb.bind(this._init,this));tc.on("listExt",qb.bind(this._setSize,this))},_initEvent:function(){var a=qb.bind(this._resize,this);$(window).on("resize",qb.debounce(a,300))},_init:function(a){this._inited||(this._inited=!0,this._eleBox=$("."+bb("price-list-box")),this._listWrapper=$("."+bb("market-list-wrapper")),this._list=$("."+bb("list")),this._contentWrapper=$("."+bb("main-wrapper")),this._content=$("."+bb("main-content")),this._setSize(),this._initEvent(),this._viewMode=a.viewMode,this._params=a)},
_setSize:function(){this._maxBoxWidth=this._eleBox.width();this._maxListWidth=this._list.width()},_resize:function(){"compare"==this._viewMode&&(this._resize=function(){if("1"!=this._contentWrapper.data("hide")){var a=document.documentElement.clientWidth,b=0,c=this,d=this._params.hasAuthor?60:0;"1"!==this._contentWrapper.data("hide")&&a<=this._maxBoxWidth?(b=a-(291+d),b-=b%120,b=120>b?120:b):b=this._maxListWidth;this._contentWrapper.css({"transition-property":"none"});this._listWrapper.css({width:b+
"px"});this._content.css({width:b+52+112+d+"px"});this._contentWrapper.css({width:b+52+112+d+"px"});setTimeout(function(){c._contentWrapper.css({"transition-property":"width"})},0)}});"compare"!==this._viewMode&&"search"!==this._viewMode&&(this._resize=function(){if("1"!=this._contentWrapper.data("hide")){var a=document.documentElement.clientWidth,b=0,c=this;a<=this._maxBoxWidth+20?(b=a-239,b-=b%90,b=90>b?90:b):b=this._maxListWidth;this._contentWrapper.css({"transition-property":"none"});this._listWrapper.css({width:b+
"px"});this._content.css({width:b+112+"px"});this._contentWrapper.css({width:b+112+"px"});setTimeout(function(){c._contentWrapper.css({"transition-property":"width"})},0)}});"search"==this._viewMode&&(this._resize=function(){if("1"!=this._contentWrapper.data("hide")){var a=document.documentElement.clientWidth,b=0,c=this;a<=this._maxBoxWidth+20?(b=a-299,b-=b%90,b=90>b?90:b):b=this._maxListWidth;this._contentWrapper.css({"transition-property":"none"});this._listWrapper.css({width:b+"px"});this._content.css({width:b+
112+60+"px"});this._contentWrapper.css({width:b+112+60+"px"});setTimeout(function(){c._contentWrapper.css({"transition-property":"width"})},0)}});this._resize()}};ab.listRespond.init();var wa=B,Oa=wa.transform_selector,uc=wa.PageEvent,vc=wa._;wa.toggleList={init:function(){uc.on("listRenderSuccess",vc.bind(this._init,this));uc.on("listExt",vc.bind(this._toggle,this))},_init:function(a){this._inited||(this._inited=!0,this._viewMode=a.viewMode,this._params=a,this._initDom(),this._initEvent(),this._type=
document.getElementById(Oa("products-wrapper"))?"search":"compare")},_initDom:function(){this._miniWrapper=$("#"+Oa("price-comparation-hide-wrapper"));this._miniBtn=$("#"+Oa("mini-close-btn"));this._wrapper=$(document.getElementById(Oa("products-wrapper"))||document.getElementById(Oa("price-comparation-wrapper")))},_initEvent:function(){var a=this;this._miniBtn.on("click",function(){a._wrapper.css({display:"block"});a._miniWrapper.css({display:"none"});"search"==a._type?($("#"+Oa("controller-bar")).css({display:"block"}),
wa.browser.extension.sendRequest({topic:"set_site_status",domain:wa.site.get_site(wa.site.get_domain(document)),type:"search",status:!0})):wa.SearchBox.App.setSiteStatus("price_compare",!0)})},_toggle:function(){this._wrapper.css({display:"none"});this._miniWrapper.css({display:"block"})}};wa.toggleList.init();var Pa=B,id=Pa.transform_selector,wc=Pa.PageEvent,xc=Pa._,Qa=Pa.SearchBox.Util,cb=Qa.getLocationHref();Pa.listLog={init:function(){wc.on("listRenderSuccess",xc.bind(this._init,this));wc.on("listExt",
xc.bind(this._toggle,this))},_init:function(a){this._inited||(this._inited=!0,this._initDom(),this._initEvent(),this._viewMode=a.viewMode,a.hide?Qa.sendLog("show_fold",cb):"search"==a.viewMode&&Qa.sendLog("show_search",cb))},_initDom:function(){this._miniBtn=$("#"+id("mini-close-btn"))},_initEvent:function(){var a=this;this._miniBtn.on("click",function(){Qa.sendLog({compare:"show_product",recommend:"show_like",search:"show_search",same:"show_same"}[a._viewMode]||"show_product",cb);Qa.sendLog("click_unfold",
cb)})},_toggle:function(){Qa.sendLog("click_fold",cb)}};Pa.listLog.init();da.checkAndRun(function(){(new da.filterChain(da.SearchBox.App,da.sameBookAssist,da.productSearch)).run();da.SrpCompare.init();da.CnaCookie.init();da.TracknickCookie.init();da.Notification.init();da.Share.init();da.SyncOrder.init();da.PriceAlertSettings.init();da.wantedCount.init()});var yc=B,jd={"x-webkit-speech":"",lang:"zh-CN","x-webkit-grammar":"builtin:translate"},zc={"taobao.com":["#title","#title2"],"tmall.com":["#mq",
"#btm-mq"],"360buy.com":["#key","#key-re-search","#keyword"],"suning.com":["#searchKeywords"],"amazon.cn":["#twotabsearchtextbox"],"coo8.com":["#searchKeywords","#searchKeywords2"],"51buy.com":["#q_show"]},kd=yc.site.get_domain(document),Ac=yc.site.get_site(kd),Bc;Ac in zc&&(Bc=zc[Ac],$.each(Bc,function(a,b){$(b).attr(jd)}))})(window,exports);
